/*
 *
 * Wijmo Library 0.8.0
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the Wijmo Commercial or GNU GPL Version 3 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/license
 *
 *
 **/
(function(a){a.widget("ui.wijpager",{options:{firstPageClass:"ui-icon-seek-first",firstPageText:"First",lastPageClass:"ui-icon-seek-end",lastPageText:"Last",mode:"numeric",nextPageClass:"ui-icon-seek-next",nextPageText:"Next",pageButtonCount:10,previousPageClass:"ui-icon-seek-prev",previousPageText:"Previous",pageCount:1,pageIndex:0,pageindexchanging:null,pageindexchanged:null},_create:function(){this.element.addClass("ui-widget ui-wijpager ui-helper-clearfix");this.options.disabled&&this.disable();this._refresh()},_init:function(){__wijReadOptionEvents(["pageindexchanging","pageindexchanged"],this)},destroy:function(){this.element.removeClass("ui-widget ui-wijpager ui-helper-clearfix");this.$ul.remove();a.Widget.prototype.destroy.apply(this,arguments)},_setOption:function(){a.Widget.prototype._setOption.apply(this,arguments);this._refresh()},_refresh:function(){this._validate();this.$ul&&this.$ul.remove();this.element.append(this.$ul=a('<ul class="ui-list ui-corner-all ui-widget-content ui-helper-clearfix"></ul>'));switch(this.options.mode){case"nextPrevious":this._createNextPrev(false);break;case"nextPreviousFirstLast":this._createNextPrev(true);break;case"numeric":this._createNumeric(false);break;case"numericFirstLast":this._createNumeric(true)}},_validate:function(){if(isNaN(this.options.pageCount)||this.options.pageCount<1)this.options.pageCount=1;if(isNaN(this.options.pageIndex)||this.options.pageIndex<0)this.options.pageIndex=0;else if(this.options.pageIndex>=this.options.pageCount)this.options.pageIndex=this.options.pageCount-1;if(isNaN(this.options.pageButtonCount)||this.options.pageButtonCount<1)this.options.pageButtonCount=1},_createNextPrev:function(a){a&&this.options.pageIndex&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(1,this.options.firstPageText,this.options.firstPageClass)));this.options.pageIndex&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageIndex,this.options.previousPageText,this.options.previousPageClass)));this.options.pageIndex+1<this.options.pageCount&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageIndex+2,this.options.nextPageText,this.options.nextPageClass)));a&&this.options.pageIndex+1<this.options.pageCount&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageCount,this.options.lastPageText,this.options.lastPageClass)))},_createNumeric:function(d){var e=this.options.pageIndex+1,b=1,a=Math.min(this.options.pageCount,this.options.pageButtonCount);if(e>a){b=Math.floor(this.options.pageIndex/this.options.pageButtonCount)*this.options.pageButtonCount+1;a=b+this.options.pageButtonCount-1;a=Math.min(a,this.options.pageCount);if(a-b+1<this.options.pageButtonCount)b=Math.max(1,a-this.options.pageButtonCount+1)}if(b!=1){d&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(1,this.options.firstPageText,this.options.firstPageClass)));this.$ul.append(this._createPagerItem().append(this._createPagerControl(b-1,"...","")))}for(var c=b;c<=a;c++){var f=c===e;this.$ul.append(this._createPagerItem(f).append(this._createPagerControl(c,c.toString(),"",f)))}if(this.options.pageCount>a){this.$ul.append(this._createPagerItem().append(this._createPagerControl(a+1,"...","")));d&&this.$ul.append(this._createPagerItem().append(this._createPagerControl(this.options.pageCount,this.options.lastPageText,this.options.lastPageClass)))}},_createPagerItem:function(c){var b=a("<li />").addClass("ui-page ui-corner-all");if(c)b.addClass("ui-state-active");else b.addClass("ui-state-default").hover(function(){a(this).removeClass("ui-state-default").addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover").addClass("ui-state-default")});return b},_createPagerControl:function(f,e,c,d){var b=null;if(d)b=a("<span />");else if(c)b=a("<span />").addClass("ui-icon "+c);else b=a("<a/>").attr("href","#");b.attr("title",e).text(e);!d&&b.bind("click."+this.widgetName,{newPageIndex:f-1},a.proxy(this._onClick,this));return b},_onClick:function(b){if(this.options.disabled)return false;var a={newPageIndex:b.data.newPageIndex,handled:false};if(this._trigger("pageindexchanging",null,a))if(this.options.pageIndex!==a.newPageIndex){this.options.pageIndex=a.newPageIndex;!a.handled&&this._refresh();this._trigger("pageindexchanged",null,{newPageIndex:a.newPageIndex})}return false}})})($);
(function(a){a.fn.extend({wijtextselection:function(){var c,e,g=this[0],d=this.val();if(arguments.length===0){var b,i,f,h;if(a.browser.msie){var k=document.selection;if(g.tagName.toLowerCase()!="textarea"){b=k.createRange().duplicate();b.moveEnd("character",d.length);f=b.text==""?d.length:d.lastIndexOf(b.text);b=k.createRange().duplicate();b.moveStart("character",-d.length);h=b.text.length}else{b=k.createRange();i=b.duplicate();i.moveToElementText(g);i.setEndPoint("EndToEnd",b);f=i.text.length-b.text.length,h=f+b.text.length}}else{f=g.selectionStart;h=g.selectionEnd}var m=d.substring(f,h);return{start:f,end:h,text:m,replace:function(a){return d.substring(0,f)+a+d.substring(h,d.length)}}}else if(arguments.length===1){if(typeof arguments[0]==="object"&&typeof arguments[0].start==="number"&&typeof arguments[0].end==="number"){c=arguments[0].start;e=arguments[0].end}else if(typeof arguments[0]==="string"){if((c=d.indexOf(arguments[0]))>-1)e=c+arguments[0].length}else if(Object.prototype.toString.call(arguments[0])==="[object RegExp]"){var l=arguments[0].exec(d);if(l!=null){c=l.index;e=c+l[0].length}}}else if(arguments.length===2)if(typeof arguments[0]==="number"&&typeof arguments[1]==="number"){c=arguments[0];e=arguments[1]}if(typeof c==="undefined"){c=0;e=d.length}if(a.browser.msie){var j=g.createTextRange();j.collapse(true);j.moveStart("character",c);j.moveEnd("character",e-c);j.select()}else{g.selectionStart=c;g.selectionEnd=e}}})})(jQuery);
(function(a){var c=function(b){var a=this;a.data={},a.reader=null,a.proxy=null,a.items=[],a.loading=null,a.loaded=null;a._constructor(b)};window.wijdatasource=c;a.extend(c.prototype,{_constructor:function(b){a.extend(this,b)},load:function(c,e){var b=this,d=b.proxy;a.isFunction(b.loading)&&b.loading(b,c);if(d!=null)d.request(b,b.loaded,c);else{(b.items.length==0||e)&&this.read();a.isFunction(b.loaded)&&b.loaded(b,c)}},read:function(){var a=this,b=a.data;if(b!=null&&a.reader!=null)a.reader.read(a);else{a.items=a.data;return a.data}}});var b=function(b){if(a.isArray(b))this.fields=b};window.wijarrayreader=b;a.extend(b.prototype,{read:function(b){if(a.isArray(b.data))b.items=this._map(b.data);else b.items=[]},_map:function(d){var c=this,b=[];if(c.fields==undefined||c.fields.length==0){a.extend(true,b,d);return b}else a.each(d,function(f,d){var e={};a.each(c.fields,function(g,b){if(a.isFunction(b.mapping)){e[b.name]=b.mapping(d);return true}var f=b.mapping!=undefined?b.mapping:b.name,c=d[f];if(c==undefined)if(b.defaultValue!=undefined)c=b.defaultValue;else c=d;e[b.name]=c});b.push(e)});return b}});var d=function(a){this.options=a};window.wijhttpproxy=d;a.extend(d.prototype,{request:function(e,f,g){var d=this,b=d.options,c=b.success;b.success=function(h){a.isFunction(c)&&c(h);d._complete(h,e,f,b,g)};a.ajax(b)},_complete:function(e,b,c,d,f){b.data=d.key!=undefined?e[d.key]:e;b.read();a.isFunction(c)&&c(b,f)}})})(jQuery);
(function(a){var g="ui-wijcombobox-input",c="ui-state-hover",d="ui-state-active",b="ui-state-focus",f="ui-corner-left",e="ui-corner-right",h="<div class='ui-wijcombobox-trigger ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-s'></span></div>",i="<label class='ui-wijcombobox-label ui-widget-content'></label>";a.widget("ui.wijcombobox",{options:{data:null,labelText:null,minLength:4,delay:300,showingAnimation:null,hidingAnimation:null,showTrigger:true,triggerPosition:"right",dropdownHeight:300,dropdownWidth:"auto",selectOnItemFocus:false,autoFilter:true,autoComplete:true,highlightMatching:true,dropDownListPosition:{},columns:[],selectionMode:"single",multipleSelectionSeparator:",",forceSelectionText:false,select:null,isEditable:true,selectedIndex:-1,open:null,close:null,selectElementWidthFix:6,search:null,changed:null},_create:function(){var a=this;a.selectedItem=null;a.selectedItems=[];a._createDOMElements();a._bindInputEvents();a._initDropDownList();a.repaint();a._checkSelectIndex()},_checkSelectIndex:function(){var b=this,d=b.options,c=d.selectedIndex;!b._usingRemoteData()&&(c>=0||a.isArray(c))&&b.search(null,"checkindex")},repaint:function(){var a=this;if(a.element.is(":visible")||a._select!=undefined&&a._input.is(":visible")){a._showTrigger();a.options.disabled&&a.disable();return true}return false},_bindInputEvents:function(){var c=this,d=c._input,e=c.options;d.bind("keydown.wijcombobox",function(f){if(e.disabled==true)return;var g=f.keyCode,b=a.ui.keyCode;switch(g){case b.UP:c._move("previous",f);f.preventDefault();break;case b.DOWN:c._move("next",f);f.preventDefault();break;case b.ENTER:c.menu.active&&f.preventDefault();case b.TAB:d.trigger("wijcomboblur");if(!c.menu.active||e.selectionMode=="multiple"&&b.TAB===g)return;c.menu.select(f);var h=d.val().length;c._selectText(h,h,d);break;case b.ESCAPE:c.close(f);break;case b.LEFT:case b.RIGHT:case b.SHIFT:case b.CONTROL:case b.HOME:case b.END:case b.DELETE:case b.PAGE_UP:case b.PAGE_DOWN:break;case 18:d.trigger("wijcomboblur");default:clearTimeout(c.searching);if(e.isEditable==false){if(c._cacheKey==undefined)c._cacheKey="";c._cacheKey+=String.fromCharCode(g)}c.searching=setTimeout(function(){var a;if(e.isEditable==false){a=c._cacheKey;c._cacheKey=undefined}else a=d.val();c.search(a,f)},e.delay)}}).bind("wijcomboblur.wijcombobox",function(a){clearTimeout(c.searching);c._addInputFocus(false,b);c.closing=setTimeout(function(){c.close(a,true)},150)}).bind("focus.wijcombobox",function(){c._addInputFocus(true,b)}).bind("blur.wiicombobox",function(){!c.menu.element.is(":visible")&&d.trigger("wijcomboblur");c._change()})},_addInputFocus:function(f,c){var b=this,e=b._input.parent(),d=f?"addClass":"removeClass",a=b._triggerArrow;e[d](c);a!=undefined&&a[d](c)},_renderColumnsHeader:function(c){var b=a("<ul class='ui-wijcombobox-rowheader'></ul>");a.each(this.options.columns,function(e,c){var d=a("<li class='ui-wijcombobox-cell ui-widget-header'></li>");d.html(c.name);c.width!=undefined&&d.width(c.width);d.appendTo(b)});c.append(b)},_hasSameValueText:function(a,b){return a.label===b.label&&a.value===b.value},_initDropDownList:function(){var b=this,f=b.element[0].ownerDocument,d=a("<div class='ui-wijcombobox-list'></div>"),c=b.options;if(c.columns.length>0){d.addClass("ui-wijcombobox-multicolumn");var e=a("<div class='ui-wijsuperpanel-header ui-state-default'></div>");b._renderColumnsHeader(e);d.append(e)}b.menu=d.appendTo("body",f).wijlist({keepHightlightOnMouseLeave:true,selectionMode:c.selectionMode,addHoverItemClass:!(c.columns.length>0),focus:function(e,d){var a=d;c.selectOnItemFocus&&b.menu.select(null,{notCloseAfterSelected:true});if(c.columns.length>0){a.element.prev().addClass("ui-wijcombobox-active-prev");a.element.find(".ui-wijcombobox-row>.ui-wijcombobox-cell").addClass("ui-state-hover")}},selected:function(g,e){clearTimeout(b.closing);var h=c.selectionMode,d=e.item;if(b._trigger("select",g,d))if(h=="single"){if(!b._usingRemoteData()){var f=a.inArray(d,b.items);if(f!=c.selectedIndex){b._input.val(d.label);var j=b.selectedItem;b.selectedItem=d;var i=c.selectedIndex;c.selectedIndex=f;if(b._select!=undefined){b._select[0].selectedIndex=c.selectedIndex;b._select.trigger("change")}b._trigger("changed",null,{oldItem:j,selectedItem:b.selectedItem,newIndex:c.selectedIndex,oldIndex:i})}}else if(b.selectedItem===null||!b._hasSameValueText(d,b.selectedItem)){b._input.val(d.label);b.selectedItem=d;b._trigger("changed",null,{selectedItem:d})}}else if(!b._usingRemoteData()){b.selectedItems=e.selectedItems;b._selectedItemsToInputVal(b.selectedItems);b._trigger("changed",null,{selectedItem:d,selectedItems:b.selectedItems})}(e.data==undefined||!e.data.notCloseAfterSelected)&&h=="single"&&b.close(g)},blur:function(b,a){if(c.columns.length>0){a.find(".ui-wijcombobox-row>.ui-wijcombobox-cell").removeClass("ui-state-hover");a.prev().removeClass("ui-wijcombobox-active-prev")}},itemrendering:function(g,f){var d=f,e="";if(d.isSeparator)e+=" ui-wijcombobox-separator";if(d.selected)e+=" ui-wijcombobox-selecteditem";e.length>0&&d.element.addClass(e);if(b._keypress&&c.isEditable&&c.columns.length==0&&c.highlightMatching&&a.trim(b._input.val()).length>0)d.text=d.label.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b._escapeRegex(b._input.val())+")(?![^<>]*>)(?![^&;]+;)","gi"),"<span class='ui-priority-primary'>$1</span>");else d.text=undefined},itemrendered:function(f,e){var b=e;if(b.cells==undefined)return;var c=b.element;c.empty();var d=a("<ul class='ui-wijcombobox-row'></ul>");a.each(b.cells,function(e,c){var b=a("<li class='ui-wijcombobox-cell ui-state-default'></li>");b.append(c);b.attr("title",c);d.append(b)});c.append(d)},resized:function(c,a){b.options.dropdownWidth=a.element.outerWidth();b.options.dropdownHeight=a.element.outerHeight();b._positionList()}}).zIndex(b._input.zIndex()+1).css({top:0,left:0}).hide().data("wijlist");b._menuUL=b.menu.ul;a.fn.bgiframe&&b.menu.element.bgiframe()},_selectedItemsToInputVal:function(d){var b="",c=this,e=c.options.multipleSelectionSeparator;c.selectedItems=d;a.each(d,function(c,a){b+=a.label+e});if(b.length>0)b=b.substr(0,b.lastIndexOf(e));c._input.val(b)},_createDOMElements:function(){var b=this,f=a("<div class='ui-wijcombobox ui-widget ui-helper-clearfix'><div class='ui-wijcombobox-wrapper ui-state-default ui-corner-all'></div></div>"),e=b.element,d;b._comboElement=f;if(e[0].tagName.toLowerCase()=="select"){b._select=e;e.addClass("ui-widget");d=b._input=a("<input />").insertAfter(e);b.options.data=b._convertSelectOptions()}else d=b._input=e;f.insertBefore(d);f.children(".ui-wijcombobox-wrapper").append(d);d.attr({autocomplete:"off",role:"textbox","aria-wijcombobox":"list","aria-haspopup":"true"}).addClass(g);b._oldWidth=e.css("width");b.options.isEditable==false&&d.attr("readonly","readonly");f.bind("mouseenter",function(){b._addInputFocus(true,c)}).bind("mouseleave",function(){b._addInputFocus(false,c)})},_convertSelectOptions:function(){var c=[],b=this;a.each(b._select.attr("options"),function(b,a){c.push({label:a.text,value:a.value})});b.options.selectedIndex=b._select[0].selectedIndex;return c},getComboElement:function(){return this._comboElement},_showTrigger:function(){var g=this,l=g.options,k=g._input,q=k.parent(),p=g._comboElement,b=g._triggerArrow,j=g._label;if(g._select!=undefined){k.width(g._select.width()+(l.data.length>20?l.selectElementWidthFix:0));g._select.hide()}p.width(q[0].offsetWidth);if(l.labelText!=null){j=g._label=a(i);q.append(j.html(l.labelText))}else if(j!=undefined){j.remove();g._label=undefined}if(l.showTrigger){k.removeClass("ui-corner-all");if(b==undefined){b=g._triggerArrow=a(h);p.append(b);b.bind("mouseover.triggerevent",g,function(d){if(l.disabled==true)return;var b=a(d.currentTarget);b.addClass(c)}).bind("mousedown.triggerevent",g,function(c){if(l.disabled==true)return;var b=a(c.currentTarget);b.addClass(d)}).bind("mouseup.triggerevent",g,function(c){var b=a(c.currentTarget);b.removeClass(d)}).bind("click.triggerevent",g,function(){if(l.disabled==true)return;g._triggerClick()})}if(l.triggerPosition==="right"){b.css({left:"",right:"0px"});b.removeClass(f);b.addClass(e)}else{b.css({right:"",left:"0px"});b.removeClass(e);b.addClass(f)}b.setOutHeight(p.innerHeight());var o=b.find("span");o.css("margin-left",(b.innerWidth()-o[0].offsetWidth)/2);o.css("margin-top",(b.innerHeight()-o[0].offsetHeight)/2)}else{if(b!=undefined){b.unbind(".triggerevent");b.remove();g._triggerArrow=undefined}k.removeClass("ui-corner-left");k.removeClass("ui-corner-right");k.addClass("ui-corner-all")}var m=0,r=0,n=0;if(j!=undefined)r+=j[0].offsetWidth;if(b!=undefined)n=b[0].offsetWidth;m=r+n;k.setOutWidth(q.innerWidth()-m);m=m==0?"":m;if(l.triggerPosition==="right"){k.css("margin-left","");k.css("margin-right",m);if(j!=undefined){j.css("left","");j.css("right",n)}}else{k.css("margin-right","");k.css("margin-left",m);if(j!=undefined){j.css("right","");j.css("left",n)}}},_triggerClick:function(c){var a=this;clearTimeout(a.closing);if(a.menu.element.is(":visible"))a.close();else{var b="";if(a._usingRemoteData())b=a._input.val();a.search(b,c)}},destroy:function(){var b=this,c=b.element;b.options.isEditable==false&&c.removeAttr("readonly");if(b._select!=undefined){b._select.removeClass("ui-widget");b._select.show();b._input.remove()}else{c.css("width",b._oldWidth);c.removeClass(g);c.removeAttr("autocomplete").removeAttr("role").removeAttr("aria-wijcombobox").removeAttr("aria-haspopup");c.insertBefore(b._comboElement);c.css("padding","")}b._comboElement.remove();b.menu.destroy();b.menu.element.remove();a.Widget.prototype.destroy.call(b)},_setOption:function(f,d){var c=this,e=c._comboElement,b=c.element;a.Widget.prototype._setOption.apply(c,arguments);if(f=="disabled")if(d){e.addClass("ui-wijcombobox-disabled ui-state-disabled");b.attr("disabled","disabled");c.close()}else{e.removeClass("ui-wijcombobox-disabled ui-state-disabled");b.removeAttr("disabled")}else if(f=="isEditable")if(d)b.attr("readonly","readonly");else b.removeAttr("readonly")},search:function(f,d){var b=this,g=b.options,c=g.data;clearTimeout(b.closing);var e={value:f,e:d,self:b};if(c!=null){if(!(d==="checkindex"))if(b._trigger("search",d,{datasrc:c,term:e})===false)return;if(a.isArray(c)){b._hideShowArrow(false);b._onListLoaded(c,e)}else{if(b._usingRemoteData()&&d!=undefined&&f.length<g.minLength)return;b._hideShowArrow(false);c.loaded=b._onListLoaded;c.load(e)}}},_usingRemoteData:function(){var b=this.options.data,c=false;if(!a.isArray(b)&&b!==null&&b.proxy!==null)c=true;return c},_hideShowArrow:function(c){var b=this,d=b.element,a=b._triggerArrow;a!=undefined&&a[c?"show":"hide"]();d[c?"removeClass":"addClass"]("ui-wijcombobox-loading")},_onListLoaded:function(h,e){var c=e.self,j=c._input,i=c.options,k=e.value,d=a.isArray(h)?h:h.items;c.items=d;if(e.e==="checkindex"){var f=i.selectedIndex;if(i.selectionMode==="multiple"&&a.isArray(f)){a.each(f,function(e,b){var a=d[b];a.selected=true;c.selectedItems.push(a)});j.val(c._selectedItemsToInputVal(c.selectedItems))}else{d[f].selected=true;c.selectedItem=d[f];j.val(c.selectedItem.label)}c._hideShowArrow(true);return}if(!c._usingRemoteData()){c._filter(d,k);g=a.grep(d,function(a){return!i.autoFilter||a.match})}else{c._topHit=null;var g=d}if(g.length>0){c._openlist(g,e);c._trigger("open");c._addInputFocus(true,b)}else c.close(null,true);c._hideShowArrow(true)},close:function(e,d){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this._trigger("close",e);this.menu.deactivate();var c=this.options.hidingAnimation;if(d!=true&&c!=null)this.menu.element.hide(c.effect,c.options,c.speed,c.callback);else this.menu.element.hide();this._addInputFocus(false,b);a(document).unbind("click",self.closeOnClick)}},_change:function(){var a=this,e=a.options,f=e.forceSelectionText,d=e.selectionMode,b=a._input,g=b.val(),c=a.selectedItem;if(f)if(d=="single")if(c!=null)c.label!==g&&b.val(c.label);else b.val("");d=="multiple"&&a._selectedItemsToInputVal(a.selectedItems)},_openlist:function(m,j){var b=j.self,d=j.e,i=b._keypress=d!=undefined||d!=null,g,f=b.options,c=b.menu.element;c.zIndex(b.element.zIndex()+1);b.menu.setItems(m);b.menu.renderList();b.menu.element.show();if(f.dropdownWidth=="auto")g=b._comboElement.outerWidth();else g=f.dropdownWidth;var l=c.css("padding");c.css("padding","0px");c.setOutWidth(g);c.css("padding",l);var k=2,h=f.dropdownHeight;if(b._select!=undefined)h=20*b._menuUL.children(".ui-wijlist-item:first").outerHeight();var n=Math.min(b._menuUL.outerHeight()+k,h);c.setOutHeight(n);b.menu.refreshSuperPanel();b._positionList();!i&&b.selectedItem!=undefined&&b.menu.activate(null,b.selectedItem,true);if(i&&d.keyCode!=jQuery.ui.keyCode.BACKSPACE)if(f.isEditable)b._runAutoComplete();else b.menu.activate(null,b._topHit,true);else{var e=b.options.showingAnimation;if(b.options.showingAnimation!=null&&!(d!==undefined&&d.keyCode===jQuery.ui.keyCode.BACKSPACE)){b.menu.element.hide();b.menu.element.show(e.effect,e.options,e.speed,e.callback)}}a(document).bind("click",b,b.closeOnClick)},closeOnClick:function(c){var b=c.data,d=c.target;!a.contains(b._comboElement[0],d)&&!a.contains(b.menu.element[0],d)&&b.close()},_positionList:function(){var c=this,d=c.options.dropDownListPosition,b={my:"left top",at:"left bottom",of:c._comboElement,collision:"none"};b=a.extend(b,d);c.menu.element.position(b)},_runAutoComplete:function(){var a=this,c=a._input,b=a._topHit;if(!a.options.autoComplete||b==null)return;a.menu.activate(null,b,true);var e=c.val(),d=b.label;c.val(d);var f=e.length,g=d.length;a._selectText(f,g,c)},_selectText:function(d,e,c){var f=c.val(),a=c.get(0);if(f.length>0)if(a.setSelectionRange!=undefined)a.setSelectionRange(d,e);else if(a.createTextRange!=undefined){var b=a.createTextRange();b.moveStart("character",d);b.moveEnd("character",e-f.length);b.select()}},_onresize:function(a){var b=a.menu.element;a.options.dropdownWidth=b.get(0).offsetWidth;a.options.dropdownHeight=b.get(0).offsetHeight},_move:function(a,b){if(!this.menu.element.is(":visible")){this.search("",b);return}if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a)){this._input.val(this.term);this.menu.deactivate();return}this.menu[a](b)},_escapeRegex:function(a){return a===undefined?a:a.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},_filter:function(d,e){var c=this._escapeRegex(e),f=new RegExp(c,"i"),b=null;a.each(d,function(e,a){if(c===undefined||c.length==0){a.match=true;return}var d=f.exec(a.label);if(d==null)a.match=false;else{if(b==null&&d.index==0)b=a;a.match=d.index>=0}});this._topHit=b;return d}})})(jQuery);
(function(a){window.wijinputcore={options:{activeField:0,keyDelay:800,autoNextField:true,culture:"",invalidClass:"ui-state-error",promptChar:"_",resetOnPrompt:true,resetOnSpace:true,allowPromptAsInput:false,hidePromptOnLeave:false,skipLiterals:true,passwordChar:"",nullText:"Enter here",showNullText:false,smartInputMode:true,hideEnter:false,disableUserInput:false,increment:1,buttonAlign:"right",showTrigger:false,showSpinner:false,comboItems:undefined,comboWidth:undefined,comboHeight:undefined},_create:function(){if(this.element.attr("tagName").toLowerCase()!=="input")throw"Target element is not a INPUT";a.effects.save(this.element,["width","height"]);var b=this.element.width();this.element.wrap("<div class='ui-wijinput ui-widget ui-helper-clearfix ui-state-default ui-corner-all'><span class='ui-wijinput-wrapper'></span></div>");this.element.addClass("ui-wijinput-input ui-corner-all");this.wrapper=this.element.parent();this.outerDiv=this.wrapper.parent();this.outerDiv.width(b);if(this.options.showTrigger){this.triggerBtn=a("<div class='ui-wijinput-trigger ui-state-default'><span class='ui-icon ui-icon-triangle-1-s'></span></div>");this.triggerBtn.addClass(this.options.buttonAlign==="left"?"ui-corner-left":"ui-corner-right");this.triggerBtn.appendTo(this.outerDiv)}if(this.options.showSpinner){this.spinner=a("<div class='ui-wijinput-spinner ui-wijinput-button'></div>");this.spinUp=a("<div class='ui-state-default ui-wijinput-spinup'><span class='ui-icon ui-icon-triangle-1-n'></span></div>");this.spinDown=a("<div class='ui-state-default ui-wijinput-spindown'><span class='ui-icon ui-icon-triangle-1-s'></span></div>");if(!this.options.showTrigger){this.spinUp.addClass(this.options.buttonAlign==="left"?"ui-corner-tl":"ui-corner-tr");this.spinDown.addClass(this.options.buttonAlign==="left"?"ui-corner-bl":"ui-corner-br")}this.spinner.append(this.spinUp).append(this.spinDown);this.spinner.appendTo(this.outerDiv)}if(this.options.showTrigger&&this.options.showSpinner)this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-spinner-trigger-left":"ui-input-spinner-trigger-right");else{this.options.showTrigger&&this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-trigger-left":"ui-input-trigger-right");this.options.showSpinner&&this.outerDiv.addClass(this.options.buttonAlign==="left"?"ui-input-spinner-left":"ui-input-spinner-right")}this.element.setOutWidth(this.outerDiv.width());this._initialize()},_createTextProvider:function(){return undefined},_beginUpdate:function(){},_endUpdate:function(){},_onTriggerClicked:function(){},_initialize:function(){this.element.data("initializing",true);this._trigger("initializing");this._createTextProvider();this._beginUpdate();this.element.data("errorstate",false);this.element.data("breakSpinner",true);this.element.data("prevCursorPos",-1);this.element.data("doubleBytes",false);this.element.data("isPassword",this.options.passwordChar.length>0&&this.element.attr("type")!=="password");this.options.showNullText&&this.option("hidePromptOnLeave",true);var c=function(a){return(!a.which?a.button:a.which)===1},b=this;this.triggerBtn&&this.triggerBtn.bind({mouseover:function(){b._addState("hover",a(this))},mouseout:function(){b._removeState("hover",a(this))},mousedown:function(d){if(!c(d))return;b._addState("active",a(this));b._trigger("tiggermousedown")},mouseup:function(d){if(!c(d))return;b._stopEvent(d);b._stopSpin();b._removeState("active",a(this));b._trigger("triggermouseup");b._onTriggerClicked();b._trySetFocus()}});var d=function(d){if(!c(d))return;b._trySetFocus();b.element.data("breakSpinner",false);b._addState("active",a(this));b._doSpin(a(d.currentTarget).hasClass("ui-wijinput-spinup"),true)},e=function(d){if(!c(d))return;b._stopSpin();b._removeState("active",a(this))};this.spinUp&&this.spinUp.bind({mouseover:function(){b._addState("hover",a(this))},mouseout:function(){b._removeState("hover",a(this))},mousedown:d,mouseup:e});this.spinDown&&this.spinDown.bind({mouseover:function(){b._addState("hover",a(this))},mouseout:function(){b._removeState("hover",a(this))},mousedown:d,mouseup:e});this.element.bind({"focus.wijinput":a.proxy(this._onFocus,this),"blur.wijinput":a.proxy(this._onBlur,this),"mouseup.wijinput":a.proxy(this._onMouseUp,this),"keypress.wijinput":a.proxy(this._onKeyPress,this),"keydown.wijinput":a.proxy(this._onKeyDown,this),"keyup.wijinput":a.proxy(this._onKeyUp,this),"change.wijinput":a.proxy(this._onChange,this),"paste.wijinput":a.proxy(this._onPast,this),"drop.wijinput":a.proxy(this._onDrop,this)});this.element.bind("propertychange.wijinput input.wijinput",a.proxy(this._onInput,this));this.element.data("preText",this.element.val());this.element.data("initializing",false);this._resetData();this._endUpdate();this._updateText(false);this._trigger("initialized")},_init:function(){},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);switch(c){case"buttonAlign":case"showTrigger":case"showSpinner":this._destroy();this._create();break;case"resetOnPrompt":case"hidePromptOnLeave":this._updateText(false);break;case"passwordChar":this.element.data("isPassword",(b+"").length>0);this._updateText(false);break;case"showNullText":b&&this.option("hidePromptOnLeave",true);this._updateText(false);break;case"disabled":this.element.attr("disabled",b);this.element[b?addClass:removeClass](this.namespace+"-state-disabled");this.triggerBtn!==undefined&&this.triggerBtn[b?addClass:removeClass](this.namespace+"-state-disabled");this.spinup!==undefined&&this.spinup[b?addClass:removeClass](this.namespace+"-state-disabled");this.spindown!==undefined&&this.spindown[b?addClass:removeClass](this.namespace+"-state-disabled")}},destroy:function(){a.Widget.prototype.destroy.apply(this,arguments);this._destroy()},_destroy:function(){this.wrapper=undefined;this.outerDiv=undefined;this.element.unbind(".wijinput");this.element.removeData("errorstate");this.element.removeData("breakSpinner");this.element.removeData("prevCursorPos");this.element.removeData("doubleBytes");this.element.removeData("isPassword");this.element.removeClass("ui-wijinput-input");this.element.parent().replaceWith(this.element);this.element.parent().replaceWith(this.element);a.effects.restore(this.element,["width","height"])},widget:function(){return this.outerDiv},_getCulture:function(b){return a.findClosestCulture(b||this.options.culture)},_isPassword:function(){return!!this.element.data("isPassword")},_addState:function(b,a){a.is(":not(.ui-state-disabled)")&&a.addClass("ui-state-"+b)},_removeState:function(a,b){b.removeClass("ui-state-"+a)},_isInitialized:function(){return!this.element.data("initializing")},_setData:function(a){this.setText(a)},_resetData:function(){},_validateData:function(){},getText:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,false,false)},setText:function(a){if(!this._isInitialized())this.element.val(a);else{this._textProvider.set(a);this._updateText(false)}},selectText:function(a,b){if(this.element.is(":disabled"))return;this.element.wijtextselection(a,b)},focus:function(){if(this.element.is(":disabled"))return;this.element.get(0).focus()},_raiseTextChanged:function(){var a=this.element.val();if(this.element.data("preText")!==a){this._trigger("textchanged");this.element.data("preText",a)}},_raiseDataChanged:function(){},_allowEdit:function(){return!(this.element.attr("readOnly")&&this.element.is(":disabled"))},_updateText:function(a){if(!this._isInitialized())return;a=!!a;if(!a)this.element.val(this._textProvider.toString(!this._isPassword(),!!this.options.hidePromptOnLeave?this._isFocused():true,true));else{var b=this.element.wijtextselection();this.element.val(this._textProvider.toString(!this._isPassword(),!!this.options.hidePromptOnLeave?this._isFocused():true,true));if(this.element.is(":disabled"))return;this.selectText(b.start,b.end);this.element.data("prevCursorPos",b.start)}this._raiseTextChanged();this._raiseDataChanged()},_trySetFocus:function(){if(!this._isFocused())try{!this.options.disableUserInput&&this.element.focus()}catch(a){}},_deleteSelText:function(b){if(!this._allowEdit())return;var a=this.element.wijtextselection();b=!!b;if(b)if(a.end===a.start)if(a.end>=1){a.end=a.end-1;a.start=a.start-1}else return;else a.end=a.end-1;else a.end=a.end-1;if(a.end<a.start)a.end=a.start;var c=new wijInputResult;this._textProvider.removeAt(a.start,a.end,c);this._updateText(false);this.selectText(c.testPosition,c.testPosition)},_getTextWithPrompts:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,true,false)},_getTextWithLiterals:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,false,true)},_getTextWithPromptAndLiterals:function(){return!this._isInitialized()?this.element.val():this._textProvider.toString(true,true,true)},_fireIvalidInputEvent:function(){this._trigger("invalidinput");if(!this.element.data("errorstate")){var b=this.options.invalidClass||"ui-state-error";this.element.data("errorstate",true);var a=this;window.setTimeout(function(){a.outerDiv.removeClass(b);a.element.data("errorstate",false)},100);this.outerDiv.addClass(b)}},_onInput:function(b){if(!this.element.data("doubleBytes")||!this.element.data("lastSelection"))return;var f=this.element.wijtextselection(),c=this.element.data("lastSelection").start,d=f.end;this.element.data("doubleBytes",false);if(d>=c){var g=this.element.val(),e=g.substring(c,d),a=this;window.setTimeout(function(){if(!a.element.data("lastValue"))return;a.element.val(a.element.data("lastValue"));var d=a.element.data("lastSelection");a.element.wijtextselection(d);a.element.removeData("lastSelection");a.element.data("batchKeyPress",true);for(var c=0;c<e.length;c++){b.which=b.charCode=b.keyCode=e.charCodeAt(c);this._onKeyPress(b)}a.element.data("batchKeyPress",false)},1)}},_keyDownPreview:function(){return false},_onKeyDown:function(b){this.element.data("prevCursorPos",-1);if(!this._isInitialized())return;var c=this._getKeyCode(b);if(c===229){if(!this.element.data("lastSelection")){this.element.data("lastSelection",this.element.wijtextselection());this.element.data("lastValue",this.element.val())}this.element.data("doubleBytes",true);return}this.element.data("doubleBytes",false);if(this.options.disableUserInput){this._stopEvent(b);return}if(this._keyDownPreview(b)){this._stopEvent(b);return}switch(c){case a.ui.keyCode.UP:this._doSpin(true,false);this._stopEvent(b);return;case a.ui.keyCode.DOWN:this._doSpin(false,false);this._stopEvent(b);return}if(b.ctrlKey)switch(c){case a.ui.keyCode.INSERT:case 67:return}if(b.ctrlKey||b.altKey)return;switch(c){case 112:case 113:case 114:case 115:case 116:case 117:return;case a.ui.keyCode.BACKSPACE:this._deleteSelText(true);this._stopEvent(b);return;case a.ui.keyCode.DELETE:this._deleteSelText(false);this._stopEvent(b);return;case a.ui.keyCode.ENTER:if(!this.options.hideEnter)return;break;case a.ui.keyCode.ESCAPE:this._stopEvent(b);window.setTimeout(a.proxy(this,this._resetData),1);return;case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.ALT:this._stopEvent(b);return;case a.ui.keyCode.SHIFT:return}},_onKeyUp:function(b){if(this.element.data("doubleBytes"))return;var c=this._getKeyCode(b);if(!this._isInitialized())return;if(c===a.ui.keyCode.ENTER)return;if(c===a.ui.keyCode.ESCAPE)return;if(this.options.disableUserInput){this._raiseTextChanged();this._raiseDataChanged();return}this._stopEvent(b)},_getKeyCode:function(b){var a=window.navigator.userAgent;if(a.indexOf("iPod")!==-1||a.indexOf("iPhone")!==-1)switch(b.which){case 127:return 8}return b.which},_keyPressPreview:function(){return false},_onKeyPress:function(b){if(this.element.data("doubleBytes"))return;this.element.data("prevCursorPos",-1);if(this.options.disableUserInput)return;if(!this._allowEdit())return;if(b.ctrlKey&&b.keyCode==119){this._onPast(b);return}if(b.ctrlKey||b.altKey)if(b.which!==a.ui.keyCode.SPACE)return;if(b.which==0)return;if(this._keyPressPreview(b)){this._stopEvent(b);return}var c=this.element.wijtextselection(),f=String.fromCharCode(b.which);c.start<c.end&&this._textProvider.removeAt(c.start,c.end-1,new wijInputResult);var d=new wijInputResult,e=this._textProvider.insertAt(f,c.start,d);if(e){this._updateText(false);this.selectText(d.testPosition+1,d.testPosition+1)}else this._fireIvalidInputEvent();!this.element.data("batchKeyPress")&&this._stopEvent(b)},_afterFocused:function(){if(!!this.options.hidePromptOnLeave){var c=this.element.wijtextselection(),b=c.start;this._updateText(false);var d=this.element.val();if(d.length===b)b=0;!a.browser.safari&&this.selectText(b,b)}},_onFocus:function(){if(this.options.disableUserInput)return;this._addState("focus",this.outerDiv);if(!this.element.data("breakSpinner"))return;if(!this._isInitialized())return;if(!this._allowEdit())return;!this.element.data("focusNotCalledFirstTime")&&this.element.data("focusNotCalledFirstTime",(new Date).getTime());this._afterFocused()},_onBlur:function(){if(this.options.disableUserInput)return;if(this._isComboListVisible())return;this._removeState("focus",this.outerDiv);if(!this.element.data("breakSpinner")){this.element.get(0).focus();var a=this.element.data("prevCursorPos");a!==undefined&&a!==-1&&this.selectText(a,a);return}if(!this._isInitialized())return;if(!this._isFocused())return;this.element.data("value",this.element.val());var b=this;window.setTimeout(function(){b._onChange();b._updateText(false);b._validateData()},100)},_isFocused:function(){return this.outerDiv.hasClass("ui-state-focus")},_onMouseUp:function(){if(!this._isInitialized())return;if(this.element.is(":disabled"))return;var a=this.element.wijtextselection();this.element.data("prevCursorPos",a.start)},_onChange:function(){if(!this.element)return;var b=this.element.val(),a=this.getText();if(a!==b){a=this._getTextWithPrompts();if(a!==b){a=this._getTextWithPromptAndLiterals();a!==b&&this.setText(b)}}},_onPast:function(){window.setTimeout(a.proxy(this._onChange,this),1)},_onDrop:function(){window.setTimeout(a.proxy(this._onChange,this),1)},_stopEvent:function(a){a.stopPropagation();a.preventDefault()},_calcSpinInterval:function(){this._repeatingCount++;return this._repeatingCount>10?50:this._repeatingCount>4?100:this._repeatingCount>2?200:400},_doSpin:function(e,c){e=!!e;c=!!c;if(!this._allowEdit())return;if(c&&this.element.data("breakSpinner"))return;var d=this.element.wijtextselection(),b=new wijInputResult;if(this.element.data("focusNotCalledFirstTime")!==-9&&(new Date).getTime()-this.element.data("focusNotCalledFirstTime")<600){this.element.data("focusNotCalledFirstTime",-9);this.element.data("prevCursorPos",0)}if(this.element.data("prevCursorPos")===-1)this.element.data("prevCursorPos",d.start);else d.start=this.element.data("prevCursorPos");b.testPosition=d.start;this._textProvider[e?"incEnumPart":"decEnumPart"](d.start,b,this.options.increment);this._updateText(false);this.element.data("prevCursorPos",b.testPosition);this.selectText(b.testPosition,b.testPosition);c&&!this.element.data("breakSpinner")&&window.setTimeout(a.proxy(function(){this._doSpin(e,true)},this),this._calcSpinInterval())},_stopSpin:function(){this.element.data("breakSpinner",true);this._repeatingCount=0},_hasComboItems:function(){return!!this.options.comboItems&&this.options.comboItems.length},_isComboListVisible:function(){return!this._comboDiv?false:this._comboDiv.wijpopup("isVisible")},_popupComboList:function(){if(!this._hasComboItems())return;if(!this._allowEdit())return;if(this._isComboListVisible()){this._comboDiv.wijpopup("hide");return}if(this._comboDiv===undefined){this._comboDiv=a("<div></div>");this._comboDiv.appendTo(document.body);this._comboDiv.width(this.element.width());this._comboDiv.height(this.options.comboHeight||180);this._comboDiv.css("position","absolute");var c=this._normalize(this.options.comboItems),b=this;this._comboDiv.wijlist({autoSize:true,maxItemsCount:5,selected:function(c,a){b._setData(a.item.value);b._comboDiv.wijpopup("hide");b._trySetFocus()}});this._comboDiv.wijlist("setItems",c);this._comboDiv.wijlist("renderList");this._comboDiv.wijlist("refreshSuperPanel")}this._comboDiv.wijpopup({autoHide:true});this._comboDiv.wijpopup("show",{of:this.outerDiv,offset:"0 4"})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b==="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})}};wijInputResult=function(){this.alphanumericCharacterExpected=-2;this.asciiCharacterExpected=-1;this.digitExpected=-3;this.invalidInput=-51;this.letterExpected=-4;this.nonEditPosition=-54;this.positionOutOfRange=-55;this.promptCharNotAllowed=-52;this.signedDigitExpected=-5;this.unavailableEditPosition=-53;this.testPosition=-1};wijInputResult.prototype={characterEscaped:1,noEffect:2,sideEffect:3,success:4,unknown:0,hint:0,clone:function(){var a=new wijInputResult;a.hint=this.hint;a.testPosition=this.testPosition;return a}}})(jQuery);
(function(b){var A={useDefault:-2,asIs:-1,zero:0,one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8};b.widget("ui.wijinputdate",b.extend(true,{},wijinputcore,{options:{date:null,dateFormat:"d",startYear:1950,calendar:"default",popupPosition:{offset:"0 4"}},_createTextProvider:function(){this._textProvider=new z(this,this.options.dateFormat)},_beginUpdate:function(){if(this.options.date)this.options.date=new Date(this.options.date);else this.options.date=new Date;this.element.data("preDate",new Date(this.options.date.getTime()));this._resetTimeStamp();this.options.showTrigger&&!this._hasComboItems()&&this._initCalendar();this.element.addClass("ui-wijinput-date")},_endUpdate:function(){var a=this;this.element.click(function(){a.highLightCursor()});this.element.mousewheel(function(c,b){a._doSpin(b>0,false)})},_onTriggerClicked:function(){if(this._hasComboItems())this._popupComboList();else this._popupOrHideCalendar()},_setOption:function(c,a){b.Widget.prototype._setOption.apply(this,arguments);wijinputcore._setOption.apply(this,arguments);switch(c){case"date":if(typeof a==="string"||typeof a==="number")this.options.date=new Date(a);this._updateText(false);this.highLightField();break;case"dateFormat":case"culture":this._textProvider._setFormat(this.options.dateFormat);this._updateText(false);break;case"activeField":a=Math.min(a,this._textProvider.getFieldCount()-1);a=Math.max(a,0);this.options.activeField=a;this.highLightField();this._resetTimeStamp()}},_resetTimeStamp:function(){this.element.data("cursorPos",0);this.element.data("timeStamp",new Date("1900/1/1"))},highLightField:function(a){if(a===undefined)a=this.options.activeField;var b=this._textProvider.getFieldRange(a);b&&this.element.wijtextselection(b)},highLightCursor:function(a){if(a===undefined)a=Math.max(0,this.element.wijtextselection().start);var b=this._textProvider.getCursorField(a);if(b<0)return;this._setOption("activeField",b)},toNextField:function(){this._setOption("activeField",this.options.activeField+1)},toPrevField:function(){this._setOption("activeField",this.options.activeField-1)},toFirstField:function(){this._setOption("activeField",0)},toLastField:function(){this._setOption("activeField",this._textProvider.getFieldCount())},clearField:function(a){if(a===undefined)a=this.options.activeField;var b=this._textProvider.getFieldRange(a);if(b){var d=new wijInputResult;this._textProvider.removeAt(b.start,b.end,d);this._updateText(false);var c=this;window.setTimeout(function(){c.highLightField()},1)}},_doSpin:function(c,a){c=!!c;a=!!a;if(!this._allowEdit())return;if(a&&this.element.data("breakSpinner"))return;if(this._textProvider[c?"incEnumPart":"decEnumPart"]()){this._updateText(false);this.highLightField()}a&&!this.element.data("breakSpinner")&&window.setTimeout(b.proxy(function(){this._doSpin(c,true)},this),this._calcSpinInterval())},_afterFocused:function(){if(b.browser.msie){this.highLightCursor();this._resetTimeStamp()}else{var a=this;window.setTimeout(function(){a.highLightCursor();a._resetTimeStamp()},0)}},_keyDownPreview:function(a){switch(a.which){case b.ui.keyCode.LEFT:this.toPrevField();return true;break;case b.ui.keyCode.RIGHT:this.toNextField();return true;break;case b.ui.keyCode.TAB:case b.ui.keyCode.SPACE:case 188:case 190:case 110:case 191:if(a.shiftKey){if(this.options.activeField>0){this.toPrevField();return true}}else if(this.options.activeField<this._textProvider.getFieldCount()-1){this.toNextField();return true}break;case b.ui.keyCode.HOME:if(a.ctrlKey)this._setOption("date",new Date);else this.toFirstField();return true;break;case b.ui.keyCode.END:if(a.ctrlKey)this._setOption("date",new Date("1970/1/1"));else this.toLastField();return true;break;case b.ui.keyCode.DELETE:this.clearField();return}return false},_autoMoveToNextField:function(a){if(!this.options.autoNextField)return;this._textProvider.needToMove(this.options.activeField,a)&&this.toNextField()},_keyPressPreview:function(j){var c=this._textProvider.getFieldRange(this.options.activeField);if(c){var e=String.fromCharCode(j.which),f=this._textProvider.isFieldSep(e,this.options.activeField);if(f){this.toNextField();return true}var a=this.element.data("cursorPos"),d=new Date,g=this.element.data("timeStamp");this.element.data("timeStamp",d);var b=d.getTime()-g.getTime()>this.options.keyDelay;if(b)a=0;var h=c.start+a;this.element.data("cursorPos",++a);var i=this._textProvider.addToField(e,this.options.activeField,h,!b);if(i){this._updateText(false);this._autoMoveToNextField(a);this.highLightField()}else this._fireIvalidInputEvent();return true}return false},_raiseDataChanged:function(){var a=this.options.date,b=this.element.data("preDate");this.element.data("preDate",new Date(a.getTime()));if(b.getTime()!==a.getTime()){this._syncCalendar();this._trigger("datechanged")}},isDateNull:function(){try{return this._textProvider.isDateNull()}catch(a){return true}},_isMinDate:function(a){return a.getFullYear()===1&&a.getMonth()===0&&a.getDate()===1},_initCalendar:function(){var a=this.options.calendar;if(a===undefined||a===null)return;if(typeof a==="boolean"||a==="default"){a=b("<div/>");a.appendTo(document.body)}var c=b(a);if(c.length!=1)return;this.element.data("calendar",c);c.wijcalendar({popupMode:true});this._syncCalendar();var d=this;c.bind("wijcalendarselecteddateschanged",function(){var a=b(this).wijcalendar("getSelectedDate");b(this).wijcalendar("close");!!a&&d.option("date",a);d._trySetFocus()})},_syncCalendar:function(){var a=this.element.data("calendar");if(!a)return;var b=this.options.date;if(this._isMinDate(b))b=new Date;a.wijcalendar("option","displayDate",b);a.wijcalendar("unSelectAll");a.wijcalendar("selectDate",b);a.wijcalendar("refresh")},_popupOrHideCalendar:function(){if(!this._allowEdit())return;var a=this.element.data("calendar");if(!a)return;if(a.wijcalendar("isPopupShowing")){a.wijcalendar("hide");return}this._syncCalendar();a.wijcalendar("popup",b.extend({},this.options.popupPosition,{of:this.outerDiv}))}}));var z=function(b,a){this.inputWidget=b;this.descriptors=new Array(0);this.desPostions=new Array(0);this.fields=new Array(0);this._setFormat(a)};z.prototype={descriptors:undefined,desPostions:undefined,maskPartsCount:0,pattern:"M/d/yyyy",initialize:function(){},getFieldCount:function(){return this.fields.length},getFieldRange:function(b){var a=this.fields[b];return{start:a.startIndex,end:a.startIndex+a.getText().length}},getCursorField:function(a){a=Math.min(a,this.desPostions.length-1);a=Math.max(a,0);var c=this.desPostions[a].desc;if(c.type===-1){var d=b.inArray(c,this.descriptors);if(d>0&&this.descriptors[d-1].type!=-1)c=this.descriptors[d-1];else return-1}return b.inArray(c,this.fields)},needToMove:function(a,c){var b=this.fields[a];return c===b.maxLen},_getCulture:function(){return this.inputWidget._getCulture()},_setFormat:function(h){this.descriptors=[];var a="",d="",e=false,g=false;this.pattern=this._parseFormatToPattern(h);for(var f=0;f<this.pattern.length;f++){var c=this.pattern.charAt(f);if(g){this.descriptors.push(this.createDescriptor(-1,c));a="";g=false;continue}if(c==="\\"){g=true;if(a.length>0){!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));a=""}continue}if(c==="'"){if(e){e=false;a=""}else{e=true;if(a.length>0){!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));a=""}}continue}if(e){this.descriptors.push(this.createDescriptor(-1,c));a="";continue}if(!f)d=c;if(d!==c&&a.length>0){!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));a=""}a+=c;d=c}if(a.length>0)!this.handlePattern(a)&&this.descriptors.push(this.createDescriptor(-1,d));this.fields=b.grep(this.descriptors,function(a){return a.type!==-1})},_parseFormatToPattern:function(c){var a=this.inputWidget._getCulture().calendars.standard,b=a.patterns.d;if(c.length<=1)switch(c){case"":case"d":b=a.patterns.d;break;case"D":b=a.patterns.D;break;case"f":b=a.patterns.D+" "+a.patterns.t;break;case"F":b=dtFormat.fullDateTimePattern;break;case"g":b=a.patterns.d+" "+a.patterns.t;break;case"G":b=a.patterns.d+" "+a.patterns.T;break;case"m":b=a.patterns.M;break;case"M":b=a.patterns.M;break;case"s":b=a.patterns.S;break;case"t":b=a.patterns.t;break;case"T":b=a.patterns.T;break;case"u":b=a.patterns.S;break;case"U":b=a.patterns.D+" "+a.patterns.T;break;case"y":b=a.patterns.Y;break;case"Y":b=a.patterns.Y}return b},getDate:function(){return!!this.inputWidget?this.inputWidget.options.date:undefined},setDate:function(a){this.inputWidget&&this.inputWidget.option("date",a)},_internalSetDate:function(a){if(this.inputWidget)this.inputWidget.options.date=a},daysInMonth:function(a,c){a=a-1;var b=(new Date(c,++a,1,-1)).getDate();return b},setYear:function(b,f,d){try{if(d&&d.isfullreset){d.offset=1;b="1970"}if(b instanceof String)if(!this.isDigitString(b))return false;b=b*1;if(b<0)if(d&&d.isreset)b=1;else return false;var c=this.getDate(),a=new Date(c.getTime());a.setFullYear(b);if(this._isValidDate(a)){var e=this.daysInMonth(this.getMonth(),this.getYear());if(e===c.getDate()){a=new Date(c.getTime());a.setDate(1);a.setFullYear(b);e=this.daysInMonth(a.getMonth()+1,a.getFullYear());a.setDate(e);if(this._isValidDate(a)){this._internalSetDate(a);return true}else return false}c.setFullYear(b);this._internalSetDate(c);return true}else{if(d&&d.isreset){c.setFullYear(1);this._internalSetDate(c);return true}return false}}catch(g){return false}},getYear:function(){try{var a=this.getDate().getFullYear();a=""+a+"";while(a.length<4)a="0"+a;return""+a+""}catch(b){alert("getYear() failed")}return""},setMonth:function(b,e,c){try{if(c&&c.isfullreset)b="1";b=b*1;var f=this.getDate();if(typeof e!=="undefined"&&!e)if(b>12||b<1)if(c&&c.isreset)b=1;else return false;var d=this.daysInMonth(this.getMonth(),this.getYear()),a;if(d===this.getDate().getDate()){a=new Date(f.getTime());a.setDate(1);a.setMonth(b-1);d=this.daysInMonth(a.getMonth()+1,a.getFullYear());a.setDate(d);if(this._isValidDate(a)){this._internalSetDate(a);return true}else return false}else{a=new Date(f.getTime());a.setMonth(b-1);if(this._isValidDate(a)){this._internalSetDate(a);return true}else return false}}catch(g){return false}},getMonth:function(){return this.getDate().getMonth()+1},setDayOfMonth:function(b,c,a){try{if(a&&a.isfullreset)return this.setDayOfMonth(1,c);var e=this.getDate();b=b*1;if(typeof c!=="undefined"&&!c){var f=this.daysInMonth(this.getMonth(),this.getYear());if(b>f||b<1)return a&&a.isreset?this.setDayOfMonth(1,c,a):false}var d=new Date(e.getTime());d.setDate(b);if(this._isValidDate(d)){this._internalSetDate(d);return true}else return false}catch(g){return false}},getDayOfMonth:function(){return this.getDate().getDate()},setHours:function(a,c){try{a=a*1;if(typeof c!=="undefined"&&!c)if(a>24)return false;var b=new Date(this.getDate().getTime());b.setHours(a);if(this._isValidDate(b)){this._internalSetDate(b);return true}else return false}catch(d){return false}},getHours:function(){return this.getDate().getHours()},setMinutes:function(a,c){try{a=a*1;if(typeof c!=="undefined"&&!c)if(a>60)return false;var b=new Date(this.getDate().getTime());b.setMinutes(a);if(this._isValidDate(b)){this._internalSetDate(b);return true}else return false}catch(d){return false}},getMinutes:function(){return this.getDate().getMinutes()},setSeconds:function(a,c){try{a=a*1;if(typeof c!=="undefined"&&!c)if(a>60)return false;var b=new Date(this.getDate().getTime());b.setSeconds(a);if(this._isValidDate(b)){this._internalSetDate(b);return true}else return false}catch(d){return false}},getSeconds:function(){return this.getDate().getSeconds()},setDayOfWeek:function(a){try{a=a*1;var b=a-this.getDayOfWeek()*1;return this.setDayOfMonth(this.getDayOfMonth()*1+b*1,true)}catch(c){return false}},getDayOfWeek:function(){return this.getDate().getDay()+1},handlePattern:function(c){var a=new RegExp("y{3,4}"),b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(10));return true}a=new RegExp("y{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(2));return true}a=new RegExp("y{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(1));return true}a=new RegExp("d{4,4}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(101));return true}a=new RegExp("d{3,3}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(100));return true}a=new RegExp("d{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(30));return true}a=new RegExp("d{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(31));return true}a=new RegExp("M{4,4}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(27));return true}a=new RegExp("M{3,3}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(26));return true}a=new RegExp("M{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(20));return true}a=new RegExp("M{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(25));return true}a=new RegExp("h{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(46));return true}a=new RegExp("h{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(45));return true}a=new RegExp("H{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(48));return true}a=new RegExp("H{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(47));return true}a=new RegExp("m{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(50));return true}a=new RegExp("m{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(51));return true}a=new RegExp("s{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(60));return true}a=new RegExp("s{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(61));return true}a=new RegExp("t{2,2}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(251));return true}a=new RegExp("t{1,1}");b=a.test(c);if(b){this.descriptors.push(this.createDescriptor(250));return true}return false},createDescriptor:function(z,c){var a=null,b=this.maskPartsCount++;switch(z){case-1:a=new y(this,b);a.liternal=c;break;case 20:a=new i(this,b);break;case 25:a=new j(this,b);break;case 26:a=new k(this,b);break;case 27:a=new l(this,b);break;case 30:a=new m(this,b);break;case 31:a=new n(this,b);break;case 100:a=new d(this,b);break;case 101:a=new e(this,b);break;case 10:a=new h(this,b);break;case 1:a=new w(this,b);break;case 2:a=new x(this,b);break;case 45:a=new o(this,b);break;case 46:a=new p(this,b);break;case 47:a=new q(this,b);break;case 48:a=new r(this,b);break;case 250:a=new f(this,b);break;case 251:a=new g(this,b);break;case 50:a=new s(this,b);break;case 51:a=new t(this,b);break;case 60:a=new u(this,b);break;case 61:a=new v(this,b)}return a},isDateNull:function(){var a=this.getDate();return!a||!a.getSeconds()&&!a.getMinutes()&&!a.getHours()&&a.getDate()===1&&!a.getMonth()&&a.getFullYear()<=1?true:false},toString:function(h,g){if(!g&&this.inputWidget.options.showNullText)if(this.isDateNull())return this.inputWidget.options.nullText;var e="",f=0;this.desPostions=new Array(0);for(var b=0;b<this.descriptors.length;b++){this.descriptors[b].startIndex=e.length;var c=""||this.descriptors[b].getText();e+=c;for(var d=0;d<c.length;d++){var a={};a.desc=this.descriptors[b];a.pos=d;a.text=c;a.length=c.length;this.desPostions.push(a);f++;if(this.desPostions.length!==f)throw"Fatal Error !!!!!!!!!!!!!!!";}}return e},"set":function(a){if(this.pattern==="dddd"||this.pattern==="ddd")return false;if(typeof a=="object"){this._internalSetDate(new Date(a));return true}var b=this.getDateFromFormat(a,this.pattern);if(!b)b=this._parseDate(a,this.pattern);if(!!b){this._internalSetDate(new Date(b));return true}return false},haveEnumParts:function(){return false},removeLiterals:function(a){a=""+a+"";a=a.replace(new RegExp("\\s","g"),"");a=a.replace(new RegExp("[+]","g"),"");a=a.replace(new RegExp("[.]","g"),"");a=a.replace(new RegExp("[:]","g"),"");a=a.replace(new RegExp("[-]","g"),"");a=a.replace(new RegExp("[()=]","g"),"");return a},getFirstDelimiterPos:function(b,d){var c=0,a=0;while(c<d.length&&a<b.length){var e=d.charAt(c),f=b.charAt(a);if(e===f)a++;else return a-1;c++}return b.length-1},findAlikeArrayItemIndex:function(d,f){for(var c=-1,e=99999,a=0;a<d.length;a++){var b=d[a].toLowerCase().indexOf(f.toLowerCase());if(b!==-1&&b<e){e=b;c=a}}return c},_isValidDate:function(a){return a===undefined?false:isNaN(a)?false:a.getFullYear()<1||a.getFullYear()>9999?false:true},isFieldSep:function(d,c){var a=c++;if(a<this.descriptors.length){var b=this.descriptors[a];return b.type!=-1?false:d===b.text}return false},getPositionType:function(b){var a=this.desPostions[b];return a.desc.type},addToField:function(a,c,f,e){var b=this.fields[c];if(b.type==10)return this.insertAt(a,f);var g=e?b.getText()+a:a,d={val:a,pos:0,offset:0,isreset:false};return b.setText(g,a.length===1?false:true,d)},insertAt:function(c,i,b){if(!b)b=new wijInputResult;b.testPosition=-1;var a;if(c.length===1){a=this.desPostions[i];if(a&&a.desc.type===-1)if(a.text===c){b.testPosition=i;b.hint=b.characterEscaped;return true}}var r=c,d=i;c=this.removeLiterals(c);var f=c,m=false,p=false;if(d>0&&f.length===1){d--;i=d;a=this.desPostions[d];m=true;if(a&&(a.desc.type===-1||a.desc.getText().length!==1)){i++;d++;m=false}}var j=false,e,g;while(f.length>0&&d<this.desPostions.length){a=this.desPostions[d];if(a.desc.type===-1){d=d+a.length;continue}if(a.desc.needAdjustInsertPos()){e=f.substr(0,a.length-a.pos);e=a.text.slice(0,a.pos)+e+a.text.slice(a.pos+e.length,a.length);if(m)e=a.text+e;if(p)e=e+a.text;var o=a.desc.getText().length,k="";try{if(c.length===1)if(!a.pos)k=c;else if(a.pos>0)k=e.substring(0,a.pos+1)}catch(t){}if(o===1&&e.length>1&&c.length===1)if(a.desc.type===31||a.desc.type===25)this._disableSmartInputMode=true;g={val:c,pos:a.pos,offset:0,isreset:false};j=a.desc.setText(e,c.length===1?false:true,g);this._disableSmartInputMode=false;if(!j&&typeof k!=="undefined"&&k.length>0&&(a.desc.type===26||a.desc.type===27||a.desc.type===100||a.desc.type===101||a.desc.type===250||a.desc.type===251))j=a.desc.setText(k,c.length===1?false:true,g);if(j){b.hint=b.success;b.testPosition=d+g.offset;if(c.length===1){var l=a.desc.getText().length,n=a.pos;if(a.pos>l-1)n=l;var s=l-o;if(s>0&&a.pos===o-1)n=l-1;var u=this.toString();b.testPosition=a.desc.startIndex+n+g.offset}f=f.slice(a.length-a.pos,f.length)}else{b.hint=b.invalidInput;if(b.testPosition!==-1)b.testPosition=i;if(a.desc.type!==-1&&c.length===1)return false}d=d+a.length}else{var h=this.getFirstDelimiterPos(f,r);if(h<0)h=0;e=f.substring(0,h+1);g={val:c,pos:a.pos,offset:0,isreset:false};j=a.desc.setText(e,c.length===1?false:true,g);if(j){b.hint=b.success;b.testPosition=d+g.offset;f=f.slice(h+1,f.length)}else{b.hint=b.invalidInput;if(b.testPosition!==-1)b.testPosition=i}if(h<0)h=0;var q=h+1;d=d+q}}return j},removeAt:function(b,e,c){try{var a=this.desPostions[b];if(a.desc.needAdjustInsertPos()){var d="0",g=b;a.text=a.desc.getText();d=a.text.slice(0,a.pos)+d+a.text.slice(a.pos+d.length,a.length);var f={val:d,pos:a.pos,offset:0,isreset:true,isfullreset:false};if(e-b+1>=a.length){f.isfullreset=true;b=b+a.length;g=b}var h=a.desc.setText(d,false,f);if(h){c.hint=c.success;c.testPosition=g}else{c.hint=c.invalidInput;if(c.testPosition===-1)c.testPosition=b}}b<e&&this.removeAt(b+1,e,c);return true}catch(i){return false}},incEnumPart:function(){var a=this.fields[this.inputWidget.options.activeField];a&&a.inc();return true},decEnumPart:function(){var a=this.fields[this.inputWidget.options.activeField];a&&a.dec();return true},setValue:function(a){this.setDate(new Date(a instanceof Date?a.getTime():a));return true},getValue:function(){return this.getDate()},_disableSmartInputMode:false,_isSmartInputMode:function(){return this._disableSmartInputMode?false:this.inputWidget?this.inputWidget.options.smartInputMode:true},_getInt:function(g,e,d,f){for(var c=f;c>=d;c--){var a=g.substring(e,e+c);if(a.length<d)return null;if(b.wij.charValidator.isDigit(a))return a}return null},getDateFromFormat:function(e,l){var h=this._getCulture().calendars.standard,v=b.merge(b.merge([],h.months.names),h.months.namesAbbr),w=b.merge(b.merge([],h.days.names),h.days.namesShort);e=e+"";l=l+"";var c=0,o=0,z="",a="",q=0,r=0,y=new Date,g=y.getFullYear(),f=y.getMonth()+1,i=1,d=0,m=0,n=0,j="",u=false,p=false;while(o<l.length){z=l.charAt(o);a="";while(l.charAt(o)===z&&o<l.length){a+=l.charAt(o++);if(p)break}if(p){c+=a.length;p=false}else if(a==="\\")p=true;else if(a==="'")u=!u;else if(u)c+=a.length;else if(a==="yyyy"||a==="yy"||a==="y"){if(a==="yyyy"){q=4;r=4}if(a==="yy"){q=2;r=2}if(a==="y"){q=2;r=4}g=this._getInt(e,c,q,r);if(!g)return 0;c+=g.length;if(g.length===2)if(g>70)g=1900+(g-0);else g=2e3+(g-0)}else if(a==="MMMM"||a==="MMM"||a==="NNN"){f=0;for(var k=0;k<v.length;k++){var s=v[k];if(e.substring(c,c+s.length).toLowerCase()===s.toLowerCase())if(a==="MMM"||a==="MMMM"||a==="NNN"&&k>11){f=k+1;if(f>12)f=f-12;c+=s.length;break}}if(f<1||f>12)return 0}else if(a==="dddd"||a==="ddd"||a==="EE"||a==="E")for(var k=0;k<w.length;k++){var t=w[k];if(e.substring(c,c+t.length).toLowerCase()===t.toLowerCase()){c+=t.length;break}}else if(a==="MM"||a==="M"){f=this._getInt(e,c,a.length,2);if(!f||f<1||f>12)return 0;c+=f.length}else if(a==="dd"||a==="d"){i=this._getInt(e,c,a.length,2);if(!i||i<1||i>31)return 0;c+=i.length}else if(a==="hh"||a==="h"){d=this._getInt(e,c,a.length,2);if(!d||d<1||d>12)return 0;c+=d.length}else if(a==="HH"||a==="H"){d=this._getInt(e,c,a.length,2);if(!d||d<0||d>23)return 0;c+=d.length}else if(a==="KK"||a==="K"){d=this._getInt(e,c,a.length,2);if(!d||d<0||d>11)return 0;c+=d.length}else if(a==="kk"||a==="k"){d=this._getInt(e,c,a.length,2);if(!d||d<1||d>24)return 0;c+=d.length;d=d-1}else if(a==="mm"||a==="m"){m=this._getInt(e,c,a.length,2);if(!m||m<0||m>59)return 0;c+=m.length}else if(a==="ss"||a==="s"){n=this._getInt(e,c,a.length,2);if(!n||n<0||n>59)return 0;c+=n.length}else if(a==="tt"||a==="t"||a==="a"){if(e.substring(c,c+2).toLowerCase()==="am"){j="AM";c+=2}else if(e.substring(c,c+2).toLowerCase()==="pm"){j="PM";c+=2}else if(e.substring(c,c+1).toLowerCase()==="a"){j="AM";c+=1}else if(e.substring(c,c+1).toLowerCase()==="p"){j="PM";c+=1}else if(e.substring(c,c+h.AM[0].length).toLowerCase()===h.AM[0].toLowerCase()){j="AM";c+=h.AM[0].length}else if(e.substring(c,c+h.PM[0].length).toLowerCase()===h.PM[0].toLowerCase()){j="PM";c+=h.AM[0].length}else if(e.substring(c,c+1).toLowerCase()===" ")c+=1}else{var A=e.substring(c,c+a.length);if(A!==a)return 0;else c+=a.length}}if(c!==e.length)return 0;if(f===2)if(!g%4&&g%100||!g%400){if(i>29)return 0}else if(i>28)return 0;if(f===4||f===6||f===9||f===11)if(i>30)return 0;if(d<12&&j==="PM")d=d-0+12;else if(d>11&&j==="AM")d=d-12;var x=new Date(g,f-1,i,d,m,n);x.setFullYear(g);return x.getTime()},_parseDate:function(h,a){if(a){if(a.indexOf("MMM")===-1&&a.indexOf("MMMM")===-1)a=a.replace("MM","M");a=a.replace("dd","d");a=a.replace("tt","a")}var e=false;window.generalFormats=[!a?"y/M/d":a,"y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"];window.monthFirst=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"];window.dateFirst=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"];for(var f=["generalFormats",e?"dateFirst":"monthFirst",e?"monthFirst":"dateFirst"],b,c=0;c<f.length;c++)for(var g=window[f[c]],d=0;d<g.length;d++){b=this.getDateFromFormat(h,g[d]);if(b)return b}return 0},paddingZero:function(c,b){var a=""+c+"";while(a.length<b)a="0"+a;return a},_formatDate:function(a,e,c){if(!a.valueOf())return"&nbsp;";var b=this,d=e.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(e){var d;switch(e){case"yyyy":return a.getFullYear();case"MMMM":return c.dateTimeFormat.monthNames[a.getMonth()];case"MMM":return c.dateTimeFormat.abbreviatedMonthNames[a.getMonth()];case"MM":return b.paddingZero(a.getMonth()+1,2);case"M":return b.paddingZero(a.getMonth()+1,1);case"mm":return b.paddingZero(a.getMinutes(),2);case"m":return b.paddingZero(a.getMinutes(),1);case"dddd":return c.dateTimeFormat.dayNames[a.getDay()];case"ddd":return c.dateTimeFormat.abbreviatedDayNames[a.getDay()];case"dd":return b.paddingZero(a.getDate(),2);case"d":return b.paddingZero(a.getDate(),1);case"hh":d=a.getHours()%12;return b.paddingZero(d?d:12,2);case"h":d=a.getHours()%12;return b.paddingZero(d?d:12,1);case"HH":return b.paddingZero(a.getHours(),2);case"H":return b.paddingZero(a.getHours(),1);case"ss":return b.paddingZero(a.getSeconds(),2);case"s":return b.paddingZero(a.getSeconds(),1);case"tt":return a.getHours()<12?cf.AM[0]:cf.PM[0];case"t":return a.getHours()<12?cf.AM[0].length>0?cf.AM[0].charAt(0):"":cf.PM[0].length>0?cf.PM[0].charAt(0):"";case"a/p":return a.getHours()<12?"a":"p"}return"N"});return d}};var a=function(d,c,a,b){this._txtProvider=d;this.id=c;this.type=a;this.startIndex=0;this.maxLen=b||2};a.prototype={_txtProvider:null,id:0,type:0,name:null,startIndex:0,maxLen:2,getText:function(){return null},setText:function(){return false},inc:function(){},dec:function(){},needAdjustInsertPos:function(){return true},reachMaxLen:function(){var a=this.getText();do if(a.charAt(0)==="0")a=a.slice(1);else break;while(a.length>0);return a.length>=this.maxLen}};var c=function(c,b){for(var a in b.prototype){var d=b.prototype[a];if(!c.prototype[a])c.prototype[a]=d}},y=function(b,d){c(y,a);a.apply(this,[b,d,-1,100])};y.prototype={liternal:"",getText:function(){return this.liternal}};var i=function(b,d){c(i,a);a.apply(this,[b,d,20]);this.name="Two-digit month"};i.prototype={getText:function(){var a=""+this._txtProvider.getMonth()+"";return a.length===1?"0"+a:a},setText:function(c,a,b){return this._txtProvider.setMonth(c,a,b)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var j=function(b,d){c(j,a);a.apply(this,[b,d,25]);this.name="month"};j.prototype={getText:function(){return""+this._txtProvider.getMonth()+""},setText:function(c,a,b){return this._txtProvider.setMonth(c,a,b)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var k=function(b,d){c(k,a);a.apply(this,[b,d,26,100]);this.name="AbbreviatedMonthNames"};k.prototype={getText:function(){var b=this._txtProvider.getMonth(),a=this._txtProvider._getCulture();return a.calendars.standard.months.namesAbbr[b-1]},setText:function(d,b,c){var a=-1;a=this._txtProvider.findAlikeArrayItemIndex(cf.months.namesAbbr,d);return a===-1?false:this._txtProvider.setMonth(a+1,b,c)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var l=function(b,d){c(l,a);a.apply(this,[b,d,27,100]);this.name="MonthNames"};l.prototype={getText:function(){var b=this._txtProvider.getMonth(),a=this._txtProvider._getCulture();return a.calendars.standard.months.names[b-1]},setText:function(e,c,b){var a=-1;if(b&&b.isfullreset)a=1;else{var d=this._txtProvider._getCulture();a=this._txtProvider.findAlikeArrayItemIndex(d.calendars.standard.months.names,e);if(a===-1)return false}return this._txtProvider.setMonth(a+1,c,b)},inc:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1+1,true)},dec:function(){this._txtProvider.setMonth(this._txtProvider.getMonth()*1-1,true)}};var m=function(b,d){c(m,a);a.apply(this,[b,d,30]);this.name="Two-digit day of month"};m.prototype={getText:function(){var a=this._txtProvider.getDayOfMonth();if(a<10)a="0"+a;return""+a+""},setText:function(c,a,b){return this._txtProvider.setDayOfMonth(c,a,b)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)}};var n=function(b,d){c(n,a);a.apply(this,[b,d,31]);this.name="Day of month"};n.prototype={getText:function(){var a=this._txtProvider.getDayOfMonth();return""+a+""},setText:function(c,a,b){return this._txtProvider.setDayOfMonth(c,a,b)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)}};var d=function(b,e){c(d,a);a.apply(this,[b,e,100,100]);this.name="AbbreviatedDayNames"};d.prototype={getText:function(){var b=this._txtProvider.getDayOfWeek(),a=this._txtProvider._getCulture();return a.calendars.standard.days.namesShort[b-1]},setText:function(c){var a=-1,b=this._txtProvider._getCulture();a=this._txtProvider.findAlikeArrayItemIndex(b.calendars.standard.days.namesShort,c);return a===-1?false:this._txtProvider.setDayOfWeek(a+1)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)},needAdjustInsertPos:function(){return false}};var e=function(b,d){c(e,a);a.apply(this,[b,d,101,100]);this.name="DayNames"};e.prototype={getText:function(){var b=this._txtProvider.getDayOfWeek(),a=this._txtProvider._getCulture();return a.calendars.standard.days.names[b-1]},setText:function(c){var a=-1,b=this._txtProvider._getCulture();a=this._txtProvider.findAlikeArrayItemIndex(b.calendars.standard.days.names,c);return a===-1?false:this._txtProvider.setDayOfWeek(a+1)},inc:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1+1,true)},dec:function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()*1-1,true)},needAdjustInsertPos:function(){return false}};var h=function(b,d){c(h,a);a.apply(this,[b,d,10,4]);this.name="Four-digit year"};h.prototype={getText:function(){return this._txtProvider.getYear()},setText:function(i,f,a){if(this._txtProvider._isSmartInputMode()&&a){var b=1900+100;if(this._txtProvider.inputWidget.options.startYear)b=this._txtProvider.inputWidget.options.startYear;var e=b+100-1;b=this._txtProvider.paddingZero(b,4);e=this._txtProvider.paddingZero(e,4);if(a.pos===0||a.pos===1){var k=new Date,c=this._txtProvider.paddingZero(this._txtProvider.getYear(),4);if(c.charAt(0)==="0"&&c.charAt(1)==="0"&&a.pos<=1){var g=a.val*1,d="00";if(g>=5)d=b.slice(0,2);else d=e.slice(0,2);var h=a.val+c.slice(3,4),j=d+h;a.offset=2-a.pos;this._txtProvider.setYear(j,f,a);return true}}}return this._txtProvider.setYear(i,f,a)},inc:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1+1,true)},dec:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1-1,true)}};var w=function(b,d){c(w,a);a.apply(this,[b,d,1]);this.name="One-digit year"};w.prototype={getText:function(){var a=this._txtProvider.getYear();a=""+a+"";if(a.length===4)a=a.charAt(2)+a.charAt(3);if(a.charAt(0)==="0")a=a.charAt(1);return a},setText:function(a,c,e){a=a+"";while(a.length<2)a="0"+a;var b=this._txtProvider.getYear();b=""+b+"";if(a==="00"){var h=this._txtProvider.getMonth(),d=this._txtProvider.getDayOfMonth(),g=this._txtProvider.getHours(),f=this._txtProvider.getMinutes(),i=this._txtProvider.getSeconds();if(h===1&&d===1&&!g&&!f&&!i){b="0001";a="01"}}if(b.length>=2)b=b.charAt(0)+b.charAt(1)+a.charAt(0)+a.charAt(1);return this._txtProvider.setYear(b,c,e)},inc:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1+1,true)},dec:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1-1,true)}};var x=function(b,d){c(x,a);a.apply(this,[b,d,2]);this.name="Two-digit year"};x.prototype={getText:function(){var a=this._txtProvider.getYear();a=""+a+"";if(a.length===4)a=a.charAt(2)+a.charAt(3);return a},setText:function(a,c,e){a=a+"";while(a.length<2)a="0"+a;var b=this._txtProvider.getYear();b=""+b+"";if(a==="00"){var i=this._txtProvider.getMonth(),d=this._txtProvider.getDayOfMonth(),h=this._txtProvider.getHours(),g=this._txtProvider.getMinutes(),j=this._txtProvider.getSeconds();if(i===1&&d===1&&!h&&!g&&!j){b="0001";a="01"}}if(b.length>=2)b=b.charAt(0)+b.charAt(1)+a.charAt(0)+a.charAt(1);var f=this._txtProvider.setYear(b,c,e);return f},inc:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1+1,true)},dec:function(){this._txtProvider.setYear(this._txtProvider.getYear()*1-1,true)}};var o=function(b,d){c(o,a);a.apply(this,[b,d,45]);this.name="h"};o.prototype={getText:function(){var a=this._txtProvider.getHours();if(a>12)a=a-12;if(!a)a=12;return""+a+""},setText:function(a,b){var c=this._txtProvider.getHours();if(c>12)a=a*1+12;return this._txtProvider.setHours(a,b)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var p=function(b,d){c(p,a);a.apply(this,[b,d,46]);this.name="hh"};p.prototype={getText:function(){var a=this._txtProvider.getHours();if(a>12)a=a-12;if(!a)a=12;if(a<10)a="0"+a;return""+a+""},setText:function(a,b){var c=this._txtProvider.getHours();if(c>12)a=a*1+12;return this._txtProvider.setHours(a,b)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var q=function(b,d){c(q,a);a.apply(this,[b,d,47]);this.name="H"};q.prototype={getText:function(){var a=this._txtProvider.getHours();return""+a+""},setText:function(b,a){return this._txtProvider.setHours(b,a)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var r=function(b,d){c(r,a);a.apply(this,[b,d,48]);this.name="HH"};r.prototype={getText:function(){var a=this._txtProvider.getHours();if(a<10)a="0"+a;return""+a+""},setText:function(b,a){return this._txtProvider.setHours(b,a)},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+1,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-1,true)}};var f=function(b,d){c(f,a);a.apply(this,[b,d,250]);this.name="t"};f.prototype={getText:function(){var c=this._txtProvider.getHours(),a="",b=this._txtProvider._getCulture();if(c<12)a=b.calendars.standard.AM[0];else a=b.calendars.standard.PM[0];if(a.length<=0)a=" ";return a.charAt(0)},setText:function(){return true},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+12,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-12,true)}};var g=function(b,d){c(g,a);a.apply(this,[b,d,251]);this.name="tt"};g.prototype={getText:function(){var c=this._txtProvider.getHours(),a="",b=this._txtProvider._getCulture();if(c<12)a=b.calendars.standard.AM[0];else a=b.calendars.standard.PM[0];if(a.length<=0)a=" ";return a},setText:function(){return true},inc:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1+12,true)},dec:function(){this._txtProvider.setHours(this._txtProvider.getHours()*1-12,true)}};var s=function(b,d){c(s,a);a.apply(this,[b,d,50]);this.name="mm"};s.prototype={getText:function(){var a=this._txtProvider.getMinutes();if(a<10)a="0"+a;return""+a+""},setText:function(b,a){return this._txtProvider.setMinutes(b,a)},inc:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1+1,true)},dec:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1-1,true)}};var t=function(b,d){c(t,a);a.apply(this,[b,d,51]);this.name="m"};t.prototype={getText:function(){var a=this._txtProvider.getMinutes();return""+a+""},setText:function(b,a){return this._txtProvider.setMinutes(b,a)},inc:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1+12,true)},dec:function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()*1-12,true)}};var u=function(b,d){c(u,a);a.apply(this,[b,d,60]);this.name="ss"};u.prototype={getText:function(){var a=this._txtProvider.getSeconds();if(a<10)a="0"+a;return""+a+""},setText:function(b,a){return this._txtProvider.setSeconds(b,a)},inc:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1+12,true)},dec:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1-12,true)}};var v=function(b,d){c(v,a);a.apply(this,[b,d,61]);this.name="s"};v.prototype={getText:function(){var a=this._txtProvider.getSeconds();return""+a+""},setText:function(b,a){return this._txtProvider.setSeconds(b,a)},inc:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1+12,true)},dec:function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()*1-12,true)}}})(jQuery);
(function(b){var a={editOptional:1,editRequired:2,separator:4,literal:8};b.widget("ui.wijinputmask",b.extend(true,{},wijinputcore,{options:{mask:"",text:""},_createTextProvider:function(){this._textProvider=new c(this,this.options.mask,false)},_beginUpdate:function(){this.element.addClass("ui-wijinput-mask");this.element.data("defaultText",this.options.text)},_onTriggerClicked:function(){this._popupComboList()},_setOption:function(d,a){b.Widget.prototype._setOption.apply(this,arguments);wijinputcore._setOption.apply(this,arguments);switch(d){case"mask":case"culture":if(typeof a==="undefined"||a.length<=0)return;var c=this.getText();this._textProvider.mask=a;this._textProvider.initialMask=a;this._textProvider.initialize();this._textProvider.set(c);this._updateText(false);break;case"text":this.setText(a);break;case"promptChar":if(!!this._textProvider){this._textProvider.updatePromptChar();this._updateText(false)}}},_resetData:function(){this.setText(this.element.data("defaultText"))},_updateText:function(){if(!this._isInitialized())return;wijinputcore._updateText.apply(this,arguments);this.options.text=this._textProvider.toString(true,false,false)}}));var c=function(c,b,a){this.inputWidget=c;this.mask=b;this.asciiOnly=a;this.descriptors=[];this.noMask=false;this.initialize()};c.prototype={inputWidget:undefined,noMask:false,mask:"",testString:"",assignedCharCount:0,requiredCharCount:0,asciiOnly:false,initialize:function(){this.noMask=!this.mask||this.mask.length<=0;if(this.noMask)return;this.testString="";this.assignedCharCount=0;this.requiredCharCount=0;this.descriptors=new Array(0);for(var i="none",k=false,n=0,c=a.literal,e="",h=this.inputWidget._getCulture(),j=0;j<this.mask.length;j++){var b=false,g=this.mask.charAt(j);if(k){k=false;b=true}if(!b){var f=g;if(f<="C"){switch(f){case"#":case"9":case"?":case"C":g=this.getPromtChar();c=a.editOptional;b=true;break;case"$":e=h.numberFormat.currency.symbol;c=a.separator;b=true;break;case"%":case"-":case";":case"=":case"@":case"B":c=a.literal;b=true;break;case"&":case"0":case"A":g=this.getPromtChar();c=a.editRequired;b=true;break;case",":e=h.numberFormat[","];c=a.separator;b=true;break;case".":e=h.numberFormat["."];c=a.separator;b=true;break;case"/":e=h.calendars.standard["/"];c=a.separator;b=true;break;case":":e=h.calendars.standard[":"];c=a.separator;b=true;break;case"<":i="lower";continue;case">":i="upper";continue}if(!b){c=a.literal;b=true}}if(!b){if(f<="\\"){switch(f){case"L":g=this.getPromtChar();c=a.editRequired;b=true;break;case"\\":k=true;c=a.literal;continue}if(!b){c=a.literal;b=true}}if(!b){if(f==="a"){g=this.getPromtChar();c=a.editOptional;b=true}if(!b){if(f!=="|"){c=a.literal;b=true}if(!b){i="none";continue}}}}}if(b){var l=new d(j,c);if(this.isEditDesc(l))l.caseConversion=i;if(c!==a.separator)e=g;for(var m=0;m<e.length;m++){var o=e.charAt(m);this.testString=this.testString+o;this.descriptors[this.descriptors.length]=l;n++}}}this.testString.Capacity=this.testString.length},getAllowPromptAsInput:function(){return!!this.inputWidget?this.inputWidget.options.allowPromptAsInput:false},getPasswordChar:function(){return!!this.inputWidget?this.inputWidget.options.passwordChar:"*"},isPassword:function(){return!!this.inputWidget?this.inputWidget._isPassword():false},getResetOnPrompt:function(){return!!this.inputWidget?this.inputWidget.options.resetOnPrompt:true},getResetOnSpace:function(){return!!this.inputWidget?this.inputWidget.options.resetOnSpace:true},getSkipLiterals:function(){return!!this.inputWidget?this.inputWidget.options.skipLiterals:true},_trueOR:function(a,b){return(a>>>1|b>>>1)*2+(a&1|b&1)},setValue:function(){return false},getValue:function(){return null},getPromtChar:function(){return!!this.inputWidget?this.inputWidget.options.promptChar:"_"},updatePromptChar:function(){if(this.noMask)return;for(var c=0;c<this.descriptors.length;c++){var d=this.descriptors[c];if(d.charType===a.editOptional||d.charType===a.editRequired)if(!d.isAssigned)this.testString=b.wij.charValidator.setChar(this.testString,this.getPromtChar(),c)}},resetChar:function(c){var d=this.descriptors[c];if(this.isEditPos(c)&&d.isAssigned){d.isAssigned=false;this.testString=b.wij.charValidator.setChar(this.testString,this.getPromtChar(),c);this.assignedCharCount--;if(d.charType===a.editRequired)this.requiredCharCount--}},getAdjustedPos:function(a){if(this.noMask){if(a>=this.testString.length)a=this.testString.length-1}else if(a>=this.descriptors.length)a=a-1;return Math.max(0,a)},incEnumPart:function(){return!this.noMask},decEnumPart:function(){return!this.noMask},findNonEditPositionInRange:function(c,d,b){return this.findPositionInRange(c,d,b,this._trueOR(a.literal,a.separator))},findPositionInRange:function(a,b,e,f){a=Math.max(0,a);b=Math.min(b,this.testString.length-1);if(a<=b)while(a<=b){var c=e?a++:b--,d=this.descriptors[c];if((d.charType&4294967295&(f&4294967295))===d.charType)return c}return-1},findAssignedEditPositionInRange:function(c,d,b){return this.assignedCharCount==0?-1:this.findEditPositionInRange(c,d,b,a.editRequired)},findEditPositionInRange:function(c,d,e,g){do{var b=this.findPositionInRange(c,d,e,this._trueOR(a.editRequired,a.editOptional));if(b===-1)break;var f=this.descriptors[b];switch(g){case a.editOptional:if(!f.isAssigned)return b;break;case a.editRequired:if(f.isAssigned)return b;break;default:return b}if(e)c++;else d--}while(c<=d);return-1},findAssignedEditPositionFrom:function(d,c){if(!this.assignedCharCount)return-1;var a,b;if(c){a=d;b=this.testString.length-1}else{a=0;b=d}return this.findAssignedEditPositionInRange(a,b,c)},findEditPositionFrom:function(d,c){var a,b;if(c){a=d;b=this.testString.length-1}else{a=0;b=d}return this.findEditPositionInRange(a,b,c,0)},setChar:function(c,e,d){e=e<0?0:e;if(!d)d=this.descriptors[e];if(this.testEscapeChar(c,e,d))this.resetChar(e);else{if(b.wij.charValidator.isLetter(c))if(b.wij.charValidator.isUpper(c)){if(d.caseConversion==="lower")c=c.toLowerCase()}else if(d.caseConversion==="upper")c=c.toUpperCase();this.testString=b.wij.charValidator.setChar(this.testString,c,e);if(!d.isAssigned){d.isAssigned=true;this.assignedCharCount++;if(d.charType===a.editRequired)this.requiredCharCount++}}},internalInsertAt:function(h,e,a,j){if(h.length===0){a.testPosition=e;a.hint=a.noEffect;return true}if(!this._testString(h,e,a))return false;var b=this.findEditPositionFrom(e,true),g=this.findAssignedEditPositionInRange(b,a.testPosition,true)!==-1,k=this.findAssignedEditPositionFrom(this.testString.length-1,false);if(g&&a.testPosition===this.testString.length-1){a.hint=a.unavailableEditPosition;a.testPosition=this.testString.length;return false}var c=this.findEditPositionFrom(a.testPosition+1,true);if(g){var d=new wijInputResult;d.hint=d.unknown;var f=true;while(f){f=false;if(c===-1){a.hint=a.unavailableEditPosition;a.testPosition=this.testString.length;return false}var l=this.descriptors[b];if(l.isAssigned&&!this.testChar(this.testString.charAt(b),c,d)){a.hint=d.hint;a.testPosition=c;return false}if(b!==k){b=this.findEditPositionFrom(b+1,true);c=this.findEditPositionFrom(c+1,true);f=true;continue}}if(d.hint>a.hint)a.hint=d.hint}if(!j){if(g)while(b>=e){var i=this.descriptors[b];if(i.isAssigned)this.setChar(this.testString.charAt(b),c);else this.resetChar(c);c=this.findEditPositionFrom(c-1,false);b=this.findEditPositionFrom(b-1,false)}this.setString(h,e)}return true},insertAt:function(c,a,b){if(b===undefined)b=new wijInputResult;if(c===undefined)throw"InsertAt: input";if(this.noMask){this.testString=this.testString.substring(0,a)+c+this.testString.substring(a,this.testString.length);b.testPosition=a+c.length-1;return true}if(a>=0&&a<this.testString.length)return this.internalInsertAt(c,a,b,false);b.testPosition=a;b.hint=b.positionOutOfRange;return false},clear:function(a){if(this.noMask){this.testString="";a.hint=a.success;return}if(!this.assignedCharCount)a.hint=a.noEffect;else{a.hint=a.success;for(var b=0;b<this.testString.length;b++)this.resetChar(b)}},isLiteral:function(b){return!b?false:b.charType!==a.literal?b.charType===a.separator:true},testEscapeChar:function(b,a,c){a=a<0?0:a;if(!c)c=this.descriptors[a];return this.isLiteral(c)?this.getSkipLiterals()?b===this.testString.charAt(a):false:(!this.getResetOnPrompt()||b!==this.getPromtChar())&&(!this.getResetOnSpace()||b!==" ")?false:true},isDigitString:function(a){a=a.trim();if(a.length===0)return true;var b=a.charAt(0);if(b==="+"||b==="-"){a=a.substr(1);a=a.trim()}if(a.length===0)return true;try{var c=parseFloat(a),d=c.toString();return d===a}catch(e){return false}},testChar:function(c,e,a){if(!b.wij.charValidator.isPrintableChar(c)){a.hint=a.invalidInput;return false}var d=this.descriptors[e];if(!d)return false;if(this.isLiteral(d)){if(this.getSkipLiterals()&&c===this.testString.charAt(e)){a.hint=a.characterEscaped;return true}a.hint=a.nonEditPosition;return false}if(c===this.getPromtChar()){if(this.getResetOnPrompt()){if(this.isEditDesc(d)&&d.isAssigned)a.hint=a.sideEffect;else a.hint=a.characterEscaped;return true}if(!this.getAllowPromptAsInput()){a.hint=a.promptCharNotAllowed;return false}}if(c===" "&&this.getResetOnSpace()){if(this.isEditDesc(d)&&d.isAssigned)a.hint=a.sideEffect;else a.hint=a.characterEscaped;return true}switch(this.mask.charAt(d.maskPosition)){case"L":if(!b.wij.charValidator.isLetter(c)){a.hint=a.letterExpected;return false}if(!b.wij.charValidator.isAsciiLetter(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"a":if(!b.wij.charValidator.isAlphanumeric(c)&&c!==" "){a.hint=a.alphanumericCharacterExpected;return false}if(!b.wij.charValidator.isAciiAlphanumeric(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"?":if(!b.wij.charValidator.isLetter(c)&&c!==" "){a.hint=a.letterExpected;return false}if(b.wij.charValidator.isAsciiLetter(c)||!this.asciiOnly)break;a.hint=a.asciiCharacterExpected;return false;case"A":if(!b.wij.charValidator.isAlphanumeric(c)){a.hint=a.alphanumericCharacterExpected;return false}if(b.wij.charValidator.isAciiAlphanumeric(c)||!this.asciiOnly)break;a.hint=a.asciiCharacterExpected;return false;case"C":if(!b.wij.charValidator.isAscii(c)&&this.asciiOnly&&c!==" "){a.hint=a.asciiCharacterExpected;return false}break;case"9":if(!b.wij.charValidator.isDigit(c)&&c!==" "){a.hint=a.digitExpected;return false}break;case"#":if(!b.wij.charValidator.isDigit(c)&&c!=="-"&&(c!=="+"&&c!==" ")){a.hint=a.digitExpected;return false}break;case"&":if(!b.wij.charValidator.isAscii(c)&&this.asciiOnly){a.hint=a.asciiCharacterExpected;return false}break;case"0":if(!b.wij.charValidator.isDigit(c)){a.hint=a.digitExpected;return false}}if(c===this.testString.charAt(e)&&d.isAssigned)a.hint=a.noEffect;else a.hint=a.success;return true},_testString:function(c,f,a){a.hint=a.unknown;a.testPosition=f;if(c.length){var b=new wijInputResult;b.testPosition=a.testPosition;b.hint=a.hint;for(var d=0;d<c.length;d++){var e=c.charAt(d);if(a.testPosition>this.testString.length){a.hint=a.unavailableEditPosition;return false}if(!this.testEscapeChar(e,a.testPosition)){a.testPosition=this.findEditPositionFrom(a.testPosition,true);if(a.testPosition===-1){a.testPosition=this.testString.length;a.hint=a.unavailableEditPosition;return false}}if(!this.testChar(e,a.testPosition,b)){a.hint=b.hint;return false}if(b.hint>a.hint)a.hint=b.hint;a.testPosition+=1;if(a.testPosition==this.testString.length)break}a.testPosition-=1}return true},"set":function(b,a){if(a===undefined)a=new wijInputResult;if(b===undefined)throw"SetFromPos: input parameter is null or undefined.";a.hint=a.unknown;a.testPosition=0;if(!b.length){this.clear(a);return true}if(this.noMask){this.testString=b;return true}if(!this.testSetString(b,a.testPosition,a))return false;var c=this.findAssignedEditPositionFrom(a.testPosition+1,true);c!==-1&&this.resetString(c,this.testString.length-1);return true},resetString:function(a,b){if(this.noMask){this.testString="";return}a=this.findAssignedEditPositionFrom(a,true);if(a!==-1){b=this.findAssignedEditPositionFrom(b,false);while(a<=b){a=this.findAssignedEditPositionFrom(a,true);this.resetChar(a);a++}}},setString:function(c,a){for(var b=0;b<c.length;b++){var d=c.charAt(b);if(!this.testEscapeChar(d,a))a=this.findEditPositionFrom(a,true);if(a<0||a>=this.testString.length)return;this.setChar(d,a);a++}},testSetString:function(a,b,c){if(a.length>this.testString.length)a=a.substring(0,this.testString.length);if(this._testString(a,b,c)){this.setString(a,b);return true}return false},toString:function(e,g,f,c,d){if(this.noMask){if(!e){for(var m="",l=0;l<this.testString.length;l++)m+=this.getPasswordChar();return m}return this.testString}e=e===undefined?true:e;g=g===undefined?true:g;f=f===undefined?true:f;c=c===undefined?0:c;d=d===undefined?this.testString.length:d;if(d<=0)return"";if(c<0)c=0;if(c>=this.testString.length)return"";var j=this.testString.length-c;if(d>j)d=j;if((!this.isPassword()||e)&&(g&&f))return this.testString.substring(c,d-c);for(var b="",o=c+d-1,i=c;i<=o;i++){var h=this.testString.charAt(i),k=this.descriptors[i];switch(k.charType){case a.editOptional:case a.editRequired:if(!k.isAssigned)break;if(!this.isPassword()||e){b=b+h;continue}b=b+this.getPasswordChar();continue;case a.editRequired|a.editOptional:b=b+h;continue;case a.separator:case a.literal:if(!f)continue;b=b+h;continue;default:b=b+h;continue}if(g){b=b+h;continue}b=b+" ";continue}return b},isEditDesc:function(b){return this.noMask?true:b.charType!==a.editRequired?b.charType===a.editOptional:true},isEditPos:function(a){if(this.noMask)return true;if(a<0||a>=this.testString.length)return false;var b=this.descriptors[a];return this.isEditDesc(b)},isSmartInputMode:function(){return!!this.inputWidget?this.inputWidget.options.smartInputMode:false},internalRemoveAt:function(d,e,b,m){if(this.noMask){try{this.testString=this.testString.substring(0,d)+this.testString.substring(e+1,this.testString.length);b.testPosition=d}catch(q){}return true}var k=new wijInputResult,j,i,f=this.findAssignedEditPositionFrom(this.testString.length-1,false),c=this.findEditPositionInRange(d,e,true,0);b.hint=b.noEffect;if(c===-1||c>f){b.testPosition=d;return true}b.testPosition=d;var n=e<f;if(this.findAssignedEditPositionInRange(d,e,true)!==-1)b.hint=b.success;if(n){var a=this.findEditPositionFrom(e+1,true),o=a;d=c;var h=true;while(h){h=false;j=this.testString.charAt(a);var p=this.descriptors[a];if((j!==this.getPromtChar()||p.isAssigned)&&!this.testChar(j,c,k)){b.hint=k.hint;b.testPosition=c;return false}if(a!==f){a=this.findEditPositionFrom(a+1,true);c=this.findEditPositionFrom(c+1,true);h=true;continue}}if(b.sideEffect>b.hint)b.hint=b.sideEffect;if(m)return true;a=o;c=d;var g=true;while(g){g=false;i=this.testString.charAt(a);var l=this.descriptors[a];if(i===this.getPromtChar()&&!l.isAssigned)this.resetChar(c);else{this.setChar(i,c);this.resetChar(a)}if(a!==f){a=this.findEditPositionFrom(a+1,true);c=this.findEditPositionFrom(c+1,true);g=true;continue}}d=c+1}d<=e&&this.resetString(d,e);return true},removeAt:function(c,b,a){if(typeof b==="undefined")b=c;if(!a)a=new wijInputResult;if(b>=this.testString.length){a.testPosition=b;a.hint=a.positionOutOfRange;return false}if(c>=0&&c<=b)return this.internalRemoveAt(c,b,a,false);a.testPosition=c;a.hint=a.positionOutOfRange;return false}};var d=function(b,a){this.caseConversion="none";this.maskPosition=b;this.charType=a};d.prototype={isAssigned:false,maskPosition:0}})(jQuery);
(function(a){a.widget("ui.wijinputnumber",a.extend(true,{},wijinputcore,{options:{type:"numeric",value:0,minValue:0,maxValue:1e9,showGroup:false,decimalPlaces:2},_createTextProvider:function(){this._textProvider=new c(this,this.options.type)},_beginUpdate:function(){this.element.addClass("ui-wijinput-numeric");this.element.data("defaultValue",this.options.value);this.element.data("preValue",this.options.value)},_onTriggerClicked:function(){this._popupComboList()},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);wijinputcore._setOption.apply(this,arguments);switch(c){case"minValue":case"maxValue":this._updateText(false);break;case"value":this.setValue(b);this._updateText(false);break;case"showGroup":case"decimalPlaces":case"culture":this._textProvider.updateStringFormat();this._updateText(false)}},_setData:function(a){this.setValue(a)},_resetData:function(){this.setValue(this.element.data("defaultValue"),true)},_validateData:function(){this._textProvider.checkAndRepairBounds(true,false)&&this._updateText(false)},_raiseDataChanged:function(){var a=this.options.value,b=this.element.data("preValue");this.element.data("preValue",a);b!==a&&this._trigger("valuechanged")},getValue:function(){var a=this._textProvider.getValue();if(a===undefined||a===null)a=this.getText();return a},setValue:function(a,c){try{c=!!c;if(typeof a==="boolean")a=a?"1":"0";if(this._textProvider.setValue(a))this._updateText(false);else if(c){var d="";d=this.getText();this.setText(a);a=a.trim();var b=this.getText().trim();if(b!==a){b=this._getTextWithPrompts().trim();if(b!==a){b=this._getTextWithPromptAndLiterals().trim();b!==a&&this.setText(d)}}}else this.setText(a);return true}catch(e){return false}},isValueNull:function(){try{return this._textProvider.isValueNull()}catch(a){return true}},_updateText:function(){if(!this._isInitialized())return;wijinputcore._updateText.apply(this,arguments);!this._textProvider.checkAndRepairBounds(false,false)&&this._trigger("valueboundsexceeded");this.options.value=this._textProvider.getValue()}}));var c=function(a,c){this.inputWidget=a;this._type=c;this._stringFormat=new b(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture());this._stringFormat._setValueFromJSFloat(this.getValue())};c.prototype={_type:"numeric",_stringFormat:null,_getCulture:function(){return this.inputWidget._getCulture()},getDecimalSeparator:function(){return this._getCulture().numberFormat["."]},toString:function(b,a){if(!a&&this.inputWidget.options.showNullText)if(this.isValueNull())return this.inputWidget.options.nullText;return this._stringFormat.getFormattedValue()},isValueNull:function(){return!this.checkAndRepairBounds(false,true)},"set":function(a,b){this.clear();this.insertAt(a,0,b);return true},clear:function(){this._stringFormat.clear()},checkAndRepairBounds:function(a,c){var b=true;if(typeof a==="undefined")a=false;var d=this.inputWidget.options.minValue,e=this.inputWidget.options.maxValue;if(typeof c!=="undefined"&&c)return this._stringFormat.checkMinValue(d,false,true);if(!this._stringFormat.checkMinValue(d,a,false))b=false;if(!this._stringFormat.checkMaxValue(e,a))b=false;this.inputWidget.options.decimalPlaces>=0&&this._stringFormat.checkDigitsLimits(this.inputWidget.options.decimalPlaces);return b},countSubstring:function(c,b){var d=0,a=c.indexOf(b);while(a!==-1){d++;a=c.indexOf(b,a+1)}return d},getAdjustedPositionFromLeft:function(b){for(var e=this._stringFormat._currentText,c=0;c<e.length;c++){var d=e.charAt(c);if(!a.wij.charValidator.isDigit(d)&&(d!==","&&d!==".")||d==="0"){if(this._stringFormat.isZero()){if(b<c)b++}else if(b<=c)b++}else break}return b},getDecimalSeparatorPos:function(){var a=this._stringFormat._currentText;return a.indexOf(this.getDecimalSeparator())},insertAt:function(b,g,c){var h=this._getCulture().numberFormat;if(b===h["."])b=h["."];if(!c)c=new wijInputResult;if(b.length===1){if(b==="+"){this._stringFormat.setPositiveSign();this.checkAndRepairBounds(true,false);return true}if(b==="-"||b===")"||b==="("){this._stringFormat.invertSign();this.checkAndRepairBounds(true,false);return true}if(!a.wij.charValidator.isDigit(b)){if(b==="."){var j=this.getDecimalSeparatorPos();if(j>=0){c.testPosition=j;return true}}if(b!==","&&b!=="."&&b!==")"&&b!=="+"&&b!=="-"&&b!=="("&&b!==this.getDecimalSeparator())if(this._type==="percent"&&b===h.percent.symbol){c.testPosition=g;return true}else if(this._type==="currency"&&b===h.currency.symbol){c.testPosition=g;return true}else return false}}g=this.getAdjustedPositionFromLeft(g);var f=g,e=this._stringFormat._currentText;if(f>e.length)f=e.length-1;if(b.length===1)if(e.charAt(f)===b){c.testPosition=f;return true}var d=e.substring(0,f),i=e.substring(f,e.length);if(this._stringFormat.isZero())i=i.replace(new RegExp("[0]"),"");c.testPosition=d.length+b.length-1;this._stringFormat.deFormatValue(d+b+i);this.checkAndRepairBounds(true,false);try{if(b.length===1)if(this.inputWidget.options.showGroup){d=this._stringFormat._currentText.substring(0,d.length);if(this.countSubstring(d,this._stringFormat._groupSeparator)!==this.countSubstring(d,this._stringFormat._groupSeparator))c.testPosition=c.testPosition+1}else{var k=d.charAt(d.length-1),l=this._stringFormat._currentText.charAt(c.testPosition-1);if(l!==k)c.testPosition=c.testPosition-1}}catch(m){}return true},removeAt:function(b,e,a){var f=this._getCulture().numberFormat;if(!a)a=new wijInputResult;a.testPosition=b;try{var c=this._stringFormat._currentText;if(!(e-b)&&c.substring(b,e+1)===this.getDecimalSeparator())return false;var d=c.slice(0,b)+c.slice(e+1);if(d==="")d="0";this._stringFormat.deFormatValue(d);if(b===e&&this.inputWidget.options.showGroup)try{var g=this._stringFormat._currentText.substring(0,b);if(this.countSubstring(g,this._stringFormat._groupSeparator)!==this.countSubstring(d,this._stringFormat._groupSeparator)){a.testPosition=a.testPosition-1;if(c.indexOf(f.currency.symbol)===a.testPosition||c.indexOf(f.percent.symbol)===a.testPosition)a.testPosition=a.testPosition+1}}catch(h){}this.checkAndRepairBounds(true,false);return true}catch(h){}this.checkAndRepairBounds(true,false);return true},incEnumPart:function(c,a,b){if(!a)a=new wijInputResult;this._stringFormat.increment(b);return this.checkAndRepairBounds(true,false)},decEnumPart:function(c,a,b){if(!a)a=new wijInputResult;this._stringFormat.decrement(b);return this.checkAndRepairBounds(true,false)},getValue:function(){return this._stringFormat.getJSFloatValue()},setValue:function(a){try{this._stringFormat._setValueFromJSFloat(a);this.checkAndRepairBounds(true,false);return true}catch(b){return false}},updateStringFormat:function(){var a="0";if(typeof this._stringFormat!=="undefined")a=this._stringFormat._currentValueInString;this._stringFormat=new b(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture());this._stringFormat._currentValueInString=a}};var b=function(d,a,c,b){this.type=d;this.digitsPlaces=a;this.showGroup=c;this.culture=b};b.prototype={_currentValueInString:"0",_currentText:"0",_groupSeparator:" ",type:"numeric",digitsPlaces:0,showGroup:false,culture:null,deFormatValue:function(a){var b=this.culture.numberFormat,g=this.isNegtive(a);a=a.replace("(","");a=a.replace(")","");a=a.replace("-","");a=a.replace(b.percent.symbol,"");a=a.replace(b.currency.symbol,"");var d=b[","],e=b["."];switch(this.type){case"percent":d=b.percent[","];e=b.percent["."];break;case"currency":d=b.currency[","];e=b.currency["."]}this._groupSeparator=d;var c=new RegExp("["+d+"]","g");a=a.replace(c,"");c=new RegExp("["+e+"]","g");a=a.replace(c,".");c=new RegExp("[ ]","g");a=a.replace(c,"");try{var h=new RegExp("([\\d\\.])+"),f=h.exec(a);if(f)a=f[0];if(g)a="-"+a;this._currentValueInString=a;this._currentText=this.formatValue(a)}catch(i){}},isNegtive:function(a){return a.indexOf("-")!==-1||a.indexOf("(")!==-1},formatValue:function(c){var a=this.culture.numberFormat;c=""+c+"";var j=this.digitsPlaces,g=" ",e=".",f=2,i=this.isNegtive(c),d=new Array(3);d.push(3);var h="n";switch(this.type){case"numeric":h=i?a.pattern[0]:"n";g=a[","];e=a["."];f=a.decimals;d=a.groupSizes;break;case"percent":h=a.percent.pattern[i?0:1];g=a.percent[","];e=a.percent["."];f=a.percent.decimals;d=a.percent.groupSizes;break;case"currency":h=a.currency.pattern[i?0:1];g=a.currency[","];e=a.currency["."];f=a.currency.decimals;d=a.currency.groupSizes}if(j!==-2)f=j;if(!this.showGroup)d=[0];c=c.replace(new RegExp("^[0]+"),"");var b=this.formatDigit(c,g,e,f,d);b=b.replace(new RegExp("^[0]+"),"");if(b.indexOf(e)===0)b="0"+b;if(b==="")b="0";this._currentValueInString=c;this._currentText=this.applyFormatPattern(h,b,a.percent.symbol,a.currency.symbol);return this._currentText},getFormattedValue:function(){return this.formatValue(this._currentValueInString)},getJSFloatValue:function(){try{return this._currentValueInString===""?0:parseFloat(this._currentValueInString)}catch(a){return Number.NaN}},clear:function(){this._currentValueInString="0";this._currentText="0"},_setValueFromJSFloat:function(a){try{this._currentValueInString=""+a+"";this.formatValue(a);return true}catch(b){return false}},isZero:function(){try{var a=this._currentValueInString.replace("-","");a=a.replace("(","");a=a.replace(")","");if(!a.length)a="0";var b=parseFloat(a);if(b!==Number.NaN&&!b)return true}catch(c){}return false},setPositiveSign:function(){this._currentValueInString=this._currentValueInString.replace("-","");this._currentValueInString=this._currentValueInString.replace("(","");this._currentValueInString=this._currentValueInString.replace(")","")},invertSign:function(){var a=false;if(this._currentValueInString.indexOf("-")!==-1||this._currentValueInString.indexOf("(")!==-1)a=true;if(a)this.setPositiveSign();else this._currentValueInString=!this._currentValueInString.length?"0":"-"+this._currentValueInString;if(this.isZero())this._currentValueInString="0";this.formatValue(this._currentValueInString)},increment:function(b){if(b===undefined)b=1;try{var a=this._currentValueInString.split(".");this._currentValueInString=a[0]*1+b+""+(a.length>1?"."+a[1]:"")}catch(c){}},decrement:function(b){if(b===undefined)b=1;try{var a=this._currentValueInString.split(".");this._currentValueInString=a[0]*1-b+""+(a.length>1?"."+a[1]:"")}catch(c){}},checkDigitsLimits:function(f){try{var a=this._currentValueInString.split(".");if(!a.length||a.length===1&&a[0]==="")return;var d="";if(a.length>1)d=a[1];for(var b="",c=0;c<f;c++){var e="0";if(d.length>c)e=d.charAt(c);b=b+e}if(b.length>0)this._currentValueInString=a[0]+"."+b;else this._currentValueInString=a[0]}catch(g){}},checkMinValue:function(g,i,h){if(typeof h==="undefined")h=false;var d=true;try{var a=this._currentValueInString.split("."),b=parseFloat(a[0]===""||a[0]==="-"?"0":a[0]),c=0;if(a.length>1&&parseFloat(a[1])>0)c=parseFloat("1."+a[1]);if(b<0||a[0]==="-")c=c*-1;g=""+g+"";a=g.split(".");var e=parseFloat(a[0]),f=0;if(a.length>1&&parseFloat(a[1])>0)f=parseFloat("1."+a[1]);if(b>e)return true;if(b<e||h&&b===e&&c<=f)d=false;else if(b===e&&b<0&&c>f)d=false;else if(b===e&&b>=0&&c<f)d=false;if(!d&&i)this._currentValueInString=""+g+""}catch(j){}return d},checkMaxValue:function(f,h){var c=true;try{var a=this._currentValueInString.split("."),b=parseFloat(a[0]===""||a[0]==="-"?"0":a[0]),d=0;if(a.length>1&&parseFloat(a[1])>0)d=parseFloat("1."+a[1]);if(b<0||a[0]==="-")d=d*-1;f=""+f+"";a=f.split(".");var e=parseFloat(a[0]),g=0;if(a.length>1&&parseFloat(a[1])>0)g=parseFloat("1."+a[1]);if(b<e)return true;if(b>e)c=false;if(b===e&&b>=0&&d>g)c=false;if(b===e&&b<0&&d<g)c=false;if(!c&&h)this._currentValueInString=""+f+""}catch(i){}return c},applyFormatPattern:function(f,e,d,c){var a=f,b=new RegExp("[n]","g");a=a.replace(b,e);b=new RegExp("[%]","g");a=a.replace(b,d);b=new RegExp("[$]","g");a=a.replace(b,c);return a},formatDigit:function(l,k,g,j,i){var a=""+l+"";a=a.replace("-","");a=a.replace("(","");a=a.replace(")","");var c=a.indexOf(g);if(c===-1)c=a.indexOf(".");if(c===-1)c=a.indexOf(",");if(c===-1)c=a.length;for(var b="",f=0,h=0,e,d=a.length-1;d>=0;d--){e=a.charAt(d);if(d<c){b=e+b;h++;if(h===i[f]*1&&i[f]*1&&d){b=k+b;h=0;if(i.length-1>f)f++}}}if(j>0){b=b+g;for(var d=0;d<j;d++){e="0";if(d+c+1<a.length)e=a.charAt(d+c+1);b=b+e}}if(j===-1)if(c<a.length-1){b=b+g;b=b+a.substr(c+1)}return b}}})(jQuery);
(function(a){a.widget("ui.wijgrid",{options:{allowColSizing:false,allowKeyboardNavigation:false,allowPaging:false,allowSorting:false,allowEditing:false,columns:[],culture:"",customFilterOperators:[],data:null,filterOperatorsSortMode:"alphabeticalCustomFirst",groupIndent:10,nullString:undefined,pageIndex:0,pageSize:10,pagerSettings:{mode:"numeric",pageButtonCount:10,position:"bottom"},scrollMode:"none",selectionMode:"singleRow",showFilter:false,showRowHeader:false,staticRowIndex:-1,key_reverse:false,key_pageSize:10,aftercelledit:null,aftercellupdate:null,beforecelledit:null,beforecellupdate:null,currencychanging:null,currencychanged:null,filteroperatorslistshowing:null,groupaggregate:null,grouptext:null,invalidcellvalue:null,pageindexchanging:null,pageindexchanged:null,selectionchanged:null,sorting:null,sorted:null},_staticColumnIndex:-1,_dataLoading:function(){this.element.addClass("ui-wijgrid-loading")},_dataLoaded:function(a){this.element.removeClass("ui-wijgrid-loading");this._requiresDataBinding=false;this._doRefresh(a)},_ensureControl:function(a){if(this._initialized){this._ownerise(false);this._widgetsToOptions()}this._ownerise(true);if(this._requiresDataBinding){if(typeof a==="number")a|=2;else if(a.updateMode)a.updateMode|=2;this._dataStore.load(a)}else this._doRefresh(a)},_doRefresh:function(f){var k=255;if(typeof f==="number")k=f;else if(typeof f.updateMode==="number")k=f.updateMode;if(!this._initialized)try{this.element.empty();a.ui.wijgrid.traverse(this.options.columns,function(a){a.isBand=a.columns||a.clientType==="c1band"});var C=(new a.ui.wijgrid.bandProcessor)._getVisibleHeight(this.options.columns,true),d=a.ui.wijgrid.getAllLeaves(this.options.columns),i=this._dataStore.getFieldsCount(),p=this._dataStore.dataMode()===a.ui.wijgrid.dataMode.dom,g=null;if(p){if(this._field("thead")&&this._field("thead").length)g=this._field("thead")[0];i=Math.max(g?g.length:0,i)}var s=i-d.length;if(s>0)for(var c=0;c<s;c++){var x=a.extend(true,{},a.ui.c1basefield.prototype.options,a.ui.c1field.prototype.options),v=a.extend({dynamic:true,isLeaf:true},x);this.options.columns.push(v)}this._extendColumnOptions();a.ui.wijgrid.setTraverseIndex(this.options.columns);d=[];a.ui.wijgrid.traverse(this.options.columns,a.proxy(function(a){a.isLeaf&&!a.isBand&&d.push(a)},this));for(var h=this._dataStore.getFieldsNames(),o=[],c=0,m=d.length;c<m;c++){var b=d[c],e=b.dataKey;if(a.ui.wijgrid.validDataKey(e)){if(typeof e==="string")e=e.toLowerCase();if(h[e])delete h[e]}else o.push(b)}var c=0;for(var B in h){var e=h[B];if(!isNaN(e))e=parseInt(e);var b=o[c++];if(b)b.dataKey=e}for(var c=0,m=d.length;c<m;c++){var b=d[c];if(b.headerText===undefined){var u=false;if(p){var r=typeof b.dataKey==="number"?b.dataKey:c;if(r<g.length){b.headerText=g[r];u=true}}if(!u)if(a.ui.wijgrid.validDataKey(b.dataKey))b.headerText=""+b.dataKey}}}finally{this._initialized=true}var j=[];this.options.showRowHeader&&j.push(a.extend({dynamic:true,clientType:"c1basefield",dynamic:true,dataIndex:-1,travIdx:-1,parentVis:true,visible:true,isLeaf:true,isBand:false,owner:this},a.ui.c1basefield.prototype.options,{allowSizing:false}));a.each(this.options.columns,function(b,a){j.push(a)});var d=[];this._field("spanTable",(new a.ui.wijgrid.bandProcessor).generateSpanTable(j,d));this._field("leaves",d);var w=0,y=0;this._field("visibleLeaves",a.grep(d,function(b,c){b.leavesIdx=c;if(a.ui.wijgrid.validDataKey(b.dataKey))b.dataIndex=y++;else b.dataIndex=-1;if(b.parentVis){b.visLeavesIdx=w++;return true}return false}));var t=this._dataStore.getDataSlice();this.dataTable=[];for(var n=0,A=t.length;n<A;n++){for(var z=t[n],l=[],c=0,m=d.length;c<m;c++){var b=d[c];if(a.ui.wijgrid.validDataKey(b.dataKey)){var q=z[b.dataKey];l.push({value:q.value,originalRowIndex:q.originalRowIndex})}}l.rowType="data";this.dataTable.push(l)}this._refresh(k);f&&f.callback&&f.callback()},_create:function(){this.rendered=false;this._requiresDataBinding=true;this._dataStore=new a.ui.wijgrid.dataStore(this);if(!this.element.is("div"))throw"invalid markup";this.element.addClass("ui-widget ui-wijgrid ui-widget-content ui-corner-all");this.filterOperatorsCache=new a.ui.wijgrid.filterOperatorsCache;this._registerFilterOperator(a.ui.wijgrid.embeddedFilters);this.options.disabled&&this.disable()},_init:function(){__wijReadOptionEvents(["currencychanging","currencychanged","filteroperatorslistshowing","groupaggregate","grouptext","pageindexchanging","pageindexchanged","selectionchanged","sorting","sorted","beforecelledit","beforecellupdate","aftercellupdate","aftercelledit","invalidcellvalue"],this);this.$topPagerDiv=null;this.$bottomPagerDiv=null;this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(b,a){a.custom=true});this._registerFilterOperator(this.options.customFilterOperators);this._field("closestCulture",a.findClosestCulture(this.options.culture));this.options.data===null&&!this._field("thead")&&this._field("thead",(new a.ui.wijgrid.htmlTableDataReader(this)).readTHead());this._initialized=false;this._ensureControl({updateMode:255})},_setOption:function(d,b){var f=this["_preset_"+d],c=this.options[d];if(f!==undefined)b=f.apply(this,[b,c]);var g=b!==c;a.Widget.prototype._setOption.apply(this,arguments);if(g){var e=this["_postset_"+d];e!==undefined&&e.apply(this,[b,c])}},destroy:function(){var b;(b=this._field("selectionui"))&&b.dispose();(b=this._field("resizer"))&&b.dispose();a.ui.wijgrid.iterateChildrenWidgets(this.element,function(b,a){a.destroy()});this.element.empty();this.element.removeClass("ui-widget ui-wijgrid ui-widget-content ui-corner-all");a.Widget.prototype.destroy.apply(this,arguments)},columns:function(){return this._field("columns")||[]},currency:function(c,d){if(arguments.length===0){var b=this._field("currency");!b&&this._field("currency",b=a.ui.wijgrid.cellInfo.prototype.outsideValue);return b}else{var b=arguments.length===1?c._clone():new a.ui.wijgrid.cellInfo(c,d);if(!b.isEqual(a.ui.wijgrid.cellInfo.prototype.outsideValue)){if(!b._isValid())throw"invalid arguments";b._clip(this._getDataCellsRange())}b._setGridView(this);this._changeCurrency(b);return this._field("currency")}},data:function(){return this._dataStore.dataSource().items},selection:function(){var b=this._field("selection");!b&&this._field("selection",b=new a.ui.wijgrid.selection(this));return b},beginEdit:function(){return this._beginEditInternal(null)},endEdit:function(){return this._endEditInternal(null)},pageCount:function(){return this._field("pageCount")||1},_headerRows:function(){var b=this._field("headerRowsAccessor");if(!b){var c=this.options.showFilter?1:0;this._field("headerRowsAccessor",b=new a.ui.wijgrid.rowAccessor(this._field("view"),1,0,c))}return b},_filterRow:function(){if(this.options.showFilter){var b=new a.ui.wijgrid.rowAccessor(this._field("view"),1,0,0);return b.item(b.length()-1)}return null},_rows:function(){var b=this._field("rowsAccessor");!b&&this._field("rowsAccessor",b=new a.ui.wijgrid.rowAccessor(this._field("view"),2,0,0));return b},_selectionui:function(){var b=this._field("selectionui");!b&&this._field("selectionui",b=new a.ui.wijgrid.selectionui(this));return b},_registerFilterOperator:function(c){if(c&&a.isArray(c))for(var b=0,d=c.length;b<d;b++)this.filterOperatorsCache.add(c[b]);else for(var b=0,d=arguments.length;b<d;b++)this.filterOperatorsCache.add(arguments[b])},_postset_allowSorting:function(){this._ensureControl(1|2)},_postset_columns:function(){throw"read-only";},_postset_allowPaging:function(){this._requiresDataBinding=true;this._ensureControl(255)},_postset_culture:function(){throw"read-only";},_postset_customFilterOperators:function(b){this.filterOperatorsCache.removeCustom();a.each(this.options.customFilterOperators,function(b,a){a.custom=true});this._registerFilterOperator(b)},_postset_data:function(){throw"read-only";},_postset_disabled:function(b){a.ui.wijgrid.iterateChildrenWidgets(this.element,function(c,a){a.option("disabled",b)})},_postset_groupIndent:function(){this._ensureControl(2)},_preset_pageIndex:function(a,c){if(isNaN(a))throw"out of range";var b=this.pageCount();if(a>b-1)a=b-1;if(a<0)a=0;if(this.options.allowPaging&&a!==c)if(!this._trigger("pageindexchanging",null,{newPageIndex:a}))a=c;return a},_postset_pageIndex:function(){if(this.options.allowPaging){this._requiresDataBinding=true;this._ensureControl({updateMode:2|4,callback:a.proxy(function(){this._trigger("pageindexchanged",null)},this)})}},_preset_pageSize:function(a){if(isNaN(a))throw"out of range";if(a<=0)a=1;return a},_postset_pageSize:function(){this.options.pageIndex=0;if(this.options.allowPaging){this._requiresDataBinding=true;this._ensureControl(2|4)}},_postset_pagerSettings:function(){this._ensureControl(4)},_postset_scrollMode:function(b,a){if(b==="none"||a==="none")this._ensureControl(0);else this._field("view").refreshPanel()},_postset_selectionMode:function(){var b=this.selection(),c=this.currency();b.beginUpdate();b.clear();c&&c._isValid()&&b._selectRange(new a.ui.wijgrid.cellInfoRange(c,c),false,false,0,null);b.endUpdate()},_postset_showFilter:function(){this._ensureControl(8)},_postset_showRowHeader:function(){this._ensureControl(1|2)},_postset_staticRowIndex:function(){this.options.scrollMode!=="none"&&this._ensureControl(0)},_columnWidgetsFactory:function(d,b){var c,e=b.clientType;if(!e&&b.isBand)e="c1band";b=a.extend({owner:this},b,{disabled:this.options.disabled});switch(e){case"c1basefield":c=d.c1basefield(b);break;case"c1boundfield":c=d.c1boundfield(b);break;case"c1band":c=d.c1band(b);break;default:c=d.c1field(b)}return c},_field:function(a,b){return arguments.length===1?this.element.data(a):this.element.data(a,b)},_extendColumnOptions:function(){a.ui.wijgrid.traverse(this.options.columns,a.proxy(function(b){b.isBand=b.columns||b.clientType==="c1band";a.ui.wijgrid.shallowMerge(b,a.ui.c1basefield.prototype.options);if(!b.isBand){a.ui.wijgrid.shallowMerge(b,a.ui.c1field.prototype.options);if(!b.clientType)b.clientType="c1field";switch(b.dataType){case undefined:case"string":if(!b.dataParser)b.dataParser=wijgridStringParser;break;case"boolean":if(!b.dataParser)b.dataParser=wijgridBoolParser;break;case"number":if(!b.dataParser)b.dataParser=wijgridNumberParser;break;case"currency":if(!b.dataParser)b.dataParser=wijgridCurrencyParser;break;case"datetime":if(!b.dataParser)b.dataParser=wijgridDateTimeParser;break;default:throw a.ui.wijgrid.stringFormat('Unsupported dataType value: "{0}"',b.dataType);}if(a.isFunction(b.dataParser))b.dataParser=new b.dataParser}else b.clientType="c1band"},this))},_buildFilterInfo:function(){var b=this._field("leaves"),c=a.map(b,a.proxy(function(b){if(!b.isBand&&b.dataIndex>=0&&b.filterOperator){var d=b.filterOperator.toLowerCase(),c;if(d!=="nofilter"&&(c=this.filterOperatorsCache.getByName(d)))if(a.inArray(b.dataType||"string",c.applicableTo)>=0)if(c.arity===1||c.arity>1&&b.filterValue!==undefined)return[{column:b,operator:c}]}return null},this));return c},_buildSortInfo:function(){var b=this._field("leaves"),c=a.map(b,function(a){if((a.visible||a.visible===undefined)&&!a.isBand&&a.dataIndex>=0)var b=a.sortDirection==="ascending"||a.sortDirection==="descending"||a.sortFlag?[{dataKey:a.dataKey,dataIndex:a.dataIndex,sortDirection:a.sortDirection}]:null;delete a.sortFlag;return b});return c},_widgetsToOptions:function(){var b=a.ui.wijgrid.flatten(this.options.columns);a.ui.wijgrid.traverse(this.columns(),function(c){var d=b[c.options.travIdx];a.extend(true,d,c.options)})},_recreateColumnWidgets:function(){a.each(this.columns(),function(b,a){a.destroy()});var g=[],c=this._headerRows();if(c&&c.length()){var b=[];a.ui.wijgrid.traverse(this.options.columns,function(a){a.parentVis&&b.push(a)});for(var e=0,i=b.length;e<i;e++){var d=b[e],h=c.item(d.thY),j=(new a.ui.wijgrid.rowAccessor).getCell(h,d.thX),f=this._columnWidgetsFactory(a(j),d);g.push(f.data(f.data("widgetName")))}}this._field("columns",g)},_ownerise:function(b){if(b){var c=this;a.ui.wijgrid.traverse(this.options.columns,function(b){b.owner=c;var a;if(a=b.groupInfo){a.owner=b;if(a.expandInfo)for(var d=0,e=a.expandInfo.length;d<e;d++)a.expandInfo[d].owner=a}})}else a.ui.wijgrid.traverse(this.options.columns,function(c){delete c.owner;var a;if(a=c.groupInfo){delete a.owner;if(a.expandInfo)for(var b=0,d=a.expandInfo.length;b<d;b++)delete a.expandInfo[b].owner}})},_updateSplits:function(){this._field("view").updateSplits!=null&&this._field("view").updateSplits()},_refresh:function(d){this.updateMode=d===undefined?0:d;if(this._field("selectionui")){this._field("selectionui").dispose();this._field("selectionui",null)}this._field("headerRowsAccessor")&&this._field("headerRowsAccessor",null);this._field("rowsAccessor")&&this._field("rowsAccessor",null);this._field("resizer")&&this._field("resizer").dispose();if(this.updateMode&2){(new a.ui.wijgrid.grouper).group(this,this.dataTable,this._field("leaves"));(new a.ui.wijgrid.merger).merge(this.dataTable,this._field("visibleLeaves"))}var c;if(this.options.scrollMode!=="none"&&(this._staticColumnIndex>=0||this.options.staticRowIndex>=0))this._field("view",c=new a.ui.wijgrid.fixedView(this));else this._field("view",c=new a.ui.wijgrid.flatView(this));c.initialize();this._render();this._ownerise(false);this._recreateColumnWidgets();this._ownerise(true);if(this.updateMode&(2|4)&&this.options.allowPaging){this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings());this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings())}this._attachEvents();a(c.focusableElement()).attr("tabIndex",0);if(this.currency()._isValid())this.currency(this.currency());else this.currency(new a.ui.wijgrid.cellInfo(0,0));this._field("selection",null);var b=this.currency();if(b._isValid()){this.selection()._startNewTransaction(b);this.selection()._selectRange(new a.ui.wijgrid.cellInfoRange(b,b),false,false,0,null)}this._selectionui();var e=new a.ui.wijgrid.resizer(this);a.ui.wijgrid.traverse(this.columns(),function(b){var a=b.options;a.visible&&a.parentVis&&a.isLeaf&&e.addElement(b)});this._field("resizer",e);this.rendered=true;this.updateMode=0;this.options.scrollMode!=="none"&&this._updateSplits()},_render:function(){var c=this._field("view");c.render(255);var b=this.options.scrollMode!=="none"?c.element.find(".ui-wijgrid-content-area"):this.element;if(this.updateMode&(2|4)){if(this.$topPagerDiv){this.$topPagerDiv.data("wijpager")&&this.$topPagerDiv.wijpager("destroy");this.$topPagerDiv.empty()}this.$topPagerDiv&&this.$topPagerDiv.remove();this.$topPagerDiv=null;if(this.options.allowPaging&&(this.options.pagerSettings.position==="top"||this.options.pagerSettings.position==="topAndBottom"))!this.$topPagerDiv&&b.prepend(this.$topPagerDiv=a('<div class="ui-wijgrid-header ui-wijsuperpanel-header ui-widget-header ui-corner-top"></div>'))}if(this.updateMode&(2|4)){if(this.$bottomPagerDiv){this.$bottomPagerDiv.data("wijpager")&&this.$bottomPagerDiv.wijpager("destroy");this.$bottomPagerDiv.empty()}this.$bottomPagerDiv&&this.$bottomPagerDiv.remove();this.$bottomPagerDiv=null;if(this.options.allowPaging&&(this.options.pagerSettings.position==="bottom"||this.options.pagerSettings.position==="topAndBottom"))!this.$bottomPagerDiv&&b.append(this.$bottomPagerDiv=a('<div class="ui-wijgrid-footer ui-wijsuperpanel-footer ui-state-default ui-corner-bottom"></div>'))}},_attachEvents:function(){var b=this._field("view"),c=a(b.focusableElement());c.bind("keydown."+this.widgetName,a.proxy(this._onKeyDown,this));c.bind("keypress."+this.widgetName,a.proxy(this._onKeyPress,this));a.each(b.subTables(),a.proxy(function(d,c){var b=c.element();if(b){b.tHead&&a(b.tHead).bind("click."+this.widgetName,a.proxy(this._onClick,this));b.tBodies.length&&a(b.tBodies[0]).bind("click."+this.widgetName,a.proxy(this._onClick,this)).bind("dblclick."+this.widgetName,a.proxy(this._onDblClick,this)).bind("mousemove."+this.widgetName,a.proxy(this._onMouseMove,this))}},this));a.each(b.getJoinedTables(true,0),a.proxy(function(d,b){if(b&&typeof b!=="number"){var c=b.element();a(c).find("> tbody").find("> tr.ui-wijgrid-groupheaderrow > td .ui-wijgrid-grouptogglebtn").bind("click."+this.widgetName,a.proxy(this._onGroupBtnClick,this))}},this));b.attachEvents()},_sortBy:function(b){if(this.options.allowSorting){b.options.sortFlag=true;var c=this.columns(),d=a.inArray(b,c);if(d>=0){a.each(c,function(c,a){if(a!==b)a.options.sortDirection="none"});this._requiresDataBinding=true;this._ensureControl({updateMode:1|2,callback:a.proxy(function(){b.options.sortFlag=false},this)})}}},_pagerSettings2PagerWidgetSettings:function(){return a.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageindexchanging:a.proxy(this._onPagerWidgetPageIndexChanging,this),pageindexchanged:a.proxy(this._onPagerWidgetPageIndexChanged,this)})},_onPagerWidgetPageIndexChanging:function(b,a){a.handled=true},_onPagerWidgetPageIndexChanged:function(b,a){this._setOption("pageIndex",a.newPageIndex)},_onClick:function(d){if(!this._canInteract()||!d.target)return;var i=this._getParentSubTable(d.target,["td","th"],this._field("view").subTables());if(i){var j=this._field("view"),h=i[0],g=a(h).closest("tr");if(!(g.is(".ui-wijgrid-datarow")||g.is(".ui-wijgrid-headerrow")))return;if(!g.length)return;var b=j.getAbsCellInfo(h)._dataToAbs(this._getDataToAbsOffset()),e=0;if(b.cellIndex()<0||b.rowIndex()<0)if(b.rowIndex()>=0){b=new a.ui.wijgrid.cellInfo(0,b.rowIndex());e=2}else{b=new a.ui.wijgrid.cellInfo(b.cellIndex(),0);e=1}this._changeCurrency(b);var f=this.currency(),c=this.selection();(!d.shiftKey||!c._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&c._startNewTransaction(f);c.beginUpdate();if(d.shiftKey&&d.ctrlKey)c._clearRange(new a.ui.wijgrid.cellInfoRange(f,f),e);else c._selectRange(new a.ui.wijgrid.cellInfoRange(c._anchorCell(),f),d.ctrlKey,d.shiftKey,e,null);c.endUpdate()}},_onDblClick:function(a){this._beginEditInternal(a)},_onGroupBtnClick:function(d){var g=a(d.target).closest("tr"),f=new a.ui.wijgrid.groupHelper,b=f.getGroupInfo(g[0]);if(b){var e=f.getColumnByGroupLevel(this._field("leaves"),b.level);if(e){var c=e.groupInfo.expandInfo[b.index];if(c.isExpanded)c.collapse(d.shiftKey);else c.expand(d.shiftKey);this._field("view").ensureWidth()}}},_onKeyDown:function(b){if(!this._canInteract)return true;var d=b.target.tagName.toLowerCase();if((d==="input"||d==="option"||d==="select"||d==="textarea")&&a(b.target).closest("tr.ui-wijgrid-datarow").length===0)return true;if(this.options.allowEditing)if(b.which===113){this._beginEditInternal(b);return false}else if(b.which===a.ui.keyCode.ESCAPE&&(this.currency()._isValid()&&this.currency()._isEdit())){this._endEditInternal(b);return false}if(!this.options.allowKeyboardNavigation)return true;var f=false,e;switch(b.which){case a.ui.keyCode.LEFT:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.TAB:e=this._getNextCurrencyPos(this._getDataCellsRange(),this.currency(),b.keyCode,b.shiftKey);f=this._canMoveToAnotherCell(b.target,b.which)}if(f){var h=this._changeCurrency(new a.ui.wijgrid.cellInfo(e.cellIndex,e.rowIndex)),g=this.currency(),c=this.selection();(!b.shiftKey||!c._multipleRangesAllowed()&&this.options.selectionMode.toLowerCase()!=="singlerange")&&c._startNewTransaction(g);c.beginUpdate();c._selectRange(new a.ui.wijgrid.cellInfoRange(c._anchorCell(),g),false,b.shiftKey,0,null);c.endUpdate();return false}return true},_onKeyPress:function(b){if(this._canInteract()&&this.options.allowEditing){var d=b.which,e=this.currency();if(d&&e._isValid()&&!e._isEdit()){var c=b.target.tagName.toLowerCase();if(c!=="input"&&c!=="option"&&c!=="select"&&c!=="textarea"){var f=a(b.target).closest(".ui-wijgrid-table");if(f.length){var g=a.map(this._field("view").subTables(),function(a){return a.element()});if(a.inArray(f[0],g)>=0)if(a.wij.charValidator.isPrintableChar(String.fromCharCode(d))){this._beginEditInternal(b);return false}}}}}},_onMouseMove:function(k){if(!this._canInteract())return;var j=this._field("view"),i=this._getParentSubTable(k.target,["td","th"],j.subTables());if(i){var h=i[0],d=a(h).closest("tr");if(!d.length||!(d.is(".ui-wijgrid-datarow")||d.is(".ui-wijgrid-headerrow")))return;var f=j.getAbsCellInfo(h)._dataToAbs(this._getDataToAbsOffset()),g=this._field("hoveredRow");if(f.rowIndex()!==g){var b=this._rows().item(g);if(b){b[0]&&a(b[0]).removeClass("ui-state-hover");b[1]&&a(b[1]).removeClass("ui-state-hover")}}var e=f.rowIndex();this._field("hoveredRow",e);if(e>=0){var c=this._rows().item(e);if(c){c[0]&&a(c[0]).addClass("ui-state-hover");c[1]&&a(c[1]).addClass("ui-state-hover")}}}},_fieldResized:function(b,a){if(a<=0)a=1;b.option("width",a)},_changeCurrency:function(b){var d=null,a=this.currency(),c=this._getDataCellsRange();if(c._isValid()&&c._containsCellInfo(b)||b.isEqual(b.outsideValue))if(a.cellIndex()!==b.cellIndex()||a.rowIndex()!==b.rowIndex()){var f={cellIndex:b.cellIndex(),rowIndex:b.rowIndex(),oldCellIndex:a.cellIndex(),oldRowIndex:a.rowIndex()};if(this._trigger("currencychanging",null,f)){var e=false;if(!this.options.allowEditing||!a._isEdit()||(e=this._endEditInternal(null))){c._containsCellInfo(a)&&this._changeCurrencyUI(a,false);a=b._clone();a._setGridView(this);d=this._changeCurrencyUI(a,true);this._field("currency",a);this._trigger("currencychanged")}}}else d=this._changeCurrencyUI(a,true);return d},_changeCurrencyUI:function(b,i){if(b&&!b.isEqual(b.outsideValue)){var e=this._field("view"),k=this._field("visibleLeaves"),j=this._getDataToAbsOffset(),c=b.cellIndex()+j.x,f=b.rowIndex()+j.y;if(f>=0){var d=e.getJoinedRows(f,0);if(d&&d[0]&&this.options.showRowHeader)if(i)a(d[0].cells[0]).addClass("ui-state-active ui-wijgrid-currency-rowheadercell");else a(d[0].cells[0]).removeClass("ui-state-active ui-wijgrid-currency-rowheadercell");if(c>=0&&c<k.length){var g=e.getHeaderCell(c);if(g)if(i)a(g).addClass("ui-state-active ui-wijgrid-currency-headercell");else a(g).removeClass("ui-state-active ui-wijgrid-currency-headercell");var h=e.getCell(c,f);if(h)if(i)a(h).addClass("ui-state-active ui-wijgrid-currency-cell");else a(h).removeClass("ui-state-active ui-wijgrid-currency-cell")}return e.getCell(c,f)}}return null},_beginEditInternal:function(d){if(this._canInteract()&&this.options.allowEditing){var b=this.currency()._column();if(b&&!b.readOnly){var c=(new a.ui.wijgrid.cellEditorHelper).currencyEditStart(this,d);c&&this._field("view").ensureWidth(0);return c}}return false},_endEditInternal:function(c){if(this._canInteract()&&this.options.allowEditing){var b=(new a.ui.wijgrid.cellEditorHelper).currencyEditEnd(this,c);b&&this._field("view").ensureWidth(0);return b}return false},_parseDOM:function(a,b){return a.dataParser.parseDOM(b,this._field("closestCulture"),a.dataFormatString,this.options.nullString)},_parse:function(a,b){return a.dataParser.parse(b,this._field("closestCulture"),a.dataFormatString,this.options.nullString)},_toStr:function(a,b){return a.dataParser.toStr(b,this._field("closestCulture"),a.dataFormatString,this.options.nullString)},_canInteract:function(){return!this.options.disabled},_canMoveToAnotherCell:function(d,b){var h=d.tagName.toLowerCase();switch(h){case"input":if(a(d).hasClass("wijgridinput")){if(d.type==="text"){var f=d.value.length,e=(new a.ui.wijgrid.domSelection(d)).getSelection(),c=a.ui.keyCode,g=b===c.UP||b==c.DOWN||b===c.PAGE_DOWN||b==c.PAGE_UP||e.length===0&&(e.start===0&&(b===c.LEFT||b===c.HOME)||e.end>=f&&(b===c.RIGHT||b===c.END));return g}return true}return false;case"textarea":case"select":return false}return true},_getDataToAbsOffset:function(){var c=0,a=0;if(this.options.showRowHeader)c++;var b=this._headerRows();if(b)a+=b.length();if(this._filterRow())a++;return{x:c,y:a}},_getDataCellsRange:function(){var d=0,e=0,b=this._field("visibleLeaves").length-1;if(this.options.showRowHeader)b--;var f=this.dataTable,c=f.length-1;if(b<0||c<0)d=e=b=c=-1;return new a.ui.wijgrid.cellInfoRange(new a.ui.wijgrid.cellInfo(d,e),new a.ui.wijgrid.cellInfo(b,c))},_getNextCurrencyPos:function(b,f,h,g){var d=f.cellIndex(),c=f.rowIndex();switch(h){case a.ui.keyCode.PAGE_UP:if(this.options.key_reverse&&c===b.topLeft().rowIndex())c=b.bottomRight().rowIndex();else{c-=this.options.key_pageSize;var e;if(c<(e=b.topLeft().rowIndex()))c=e}break;case a.ui.keyCode.PAGE_DOWN:if(this.options.key_reverse&&c===b.bottomRight().rowIndex())c=b.TopLeft().RowIndex();else{c+=this.options.key_pageSize;var e;if(c>(e=b.bottomRight().rowIndex()))c=e}break;case a.ui.keyCode.END:d=this.options.key_reverse&&d===b.bottomRight().cellIndex()?b.topLeft().cellIndex():b.bottomRight().cellIndex();break;case a.ui.keyCode.HOME:d=this.options.key_reverse&&d==b.topLeft().cellIndex()?b.bottomRight().cellIndex():b.topLeft().cellIndex();break;case a.ui.keyCode.LEFT:if(d>b.topLeft().cellIndex())d--;else if(this.options.key_reverse)d=b.bottomRight().cellIndex();break;case a.ui.keyCode.UP:if(c>b.topLeft().rowIndex())c--;else if(this.options.key_reverse)c=b.bottomRight().rowIndex();break;case a.ui.keyCode.RIGHT:if(d<b.bottomRight().cellIndex())d++;else if(this.options.key_reverse)d=b.topLeft().cellIndex();break;case a.ui.keyCode.ENTER:case a.ui.keyCode.DOWN:if(c<b.bottomRight().rowIndex())c++;else if(this.options.key_reverse)c=b.topLeft().rowIndex();break;case a.ui.keyCode.TAB:if(false)if(g){d--;if(d<b.topLeft().cellIndex()){d=b.bottomRight().cellIndex();c--;if(c<b.topLeft().rowIndex())c=b.bottomRight().rowIndex()}}else{d++;if(d>b.bottomRight().cellIndex()){d=b.topLeft().cellIndex();c++;if(c>b.bottomRight().rowIndex())c=b.topLeft().rowIndex()}}}return{cellIndex:d,rowIndex:c}},_getParentSubTable:function(b,f,g){for(var e=a.map(g,function(a){return a.element()}),c=null,d=null;b!==null&&c===null;b=b.parentNode){var h=b.tagName?b.tagName.toLowerCase():undefined;if(a.inArray(h,f)>=0)d=b;else if(a.inArray(b,e)>=0)c=b}return d&&c?[d,c]:null},_getRealStaticRowIndex:function(){if(this.options.staticRowIndex>=0){var a=this._field("spanTable").length-1;if(this.options.showFilter)a++;return a}else return this.options.staticRowIndex}})})(jQuery);(function(a){a.widget("ui.c1basefield",{options:{allowSizing:true,dataKey:undefined,headerText:undefined,visible:true,width:undefined},_create:function(){this.element.addClass("ui-widget ui-c1basefield ui-state-default");this._field("owner",this.options.owner);delete this.options.owner;this._field("widgetName",this.widgetName);this.options.disabled&&this.disable()},_init:function(){this.element.text(this.options.headerText);this.element.wrapInner('<span class="ui-wijgrid-headertext" />')},_field:function(a,b){return arguments.length===1?this.element.data(a):this.element.data(a,b)},_setOption:function(d,b){var f=this["_preset_"+d],c=this.options[d];if(f!==undefined)b=f.apply(this,[b,c]);var g=b!==c;a.Widget.prototype._setOption.apply(this,arguments);if(g){var e=this["_postset_"+d];e!==undefined&&e.apply(this,[b,c])}},_preset_clientType:function(){throw"read-only";},_postset_headerText:function(a){this._headerTextDOM(a)},_postset_visible:function(){this._field("owner")._ensureControl(255)},_postset_width:function(b){var f=this._field("owner"),c=f._field("view"),d=this.element.width(),e=c.getJoinedCols(this.options.leavesIdx);a.each(e,function(c,a){if(a)a.width=b});c.forEachColumnCell(this.options.leavesIdx,function(c){a(c).setOutWidth(b);return true});c.ensureWidth(b-d)},_canSize:function(){return this.options.allowSizing&&this._field("owner").options.allowColSizing}})})(jQuery);(function(a){a.widget("ui.c1field",a.ui.c1basefield,{options:{aggregate:"none",allowSort:true,dataType:"string",dataParser:undefined,dataFormatString:undefined,filterOperator:"nofilter",filterValue:undefined,groupInfo:{expandInfo:[],groupSingleRow:true,collapsedImageClass:"ui-icon-plus",expandedImageClass:"ui-icon-minus",position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},readOnly:false,rowMerge:"none",showFilter:true,sortDirection:"none",valueRequired:false},_create:function(){a.ui.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget ui-c1field")},destroy:function(){a.ui.c1basefield.prototype.destroy.apply(this,arguments);if(this.$filterEditor){switch(this.options.dataType){case"number":case"currency":this.$filterEditor.wijinputnumber("destroy");break;case"datetime":this.$filterEditor.wijinputdate("destroy");break;default:this.$filterEditor.wijinputmask("destroy")}this.$filterEditor=null}this._removeDropDownFilterList()},_init:function(){a.ui.c1basefield.prototype._init.apply(this,arguments);this.$filterEditor=null;this._refreshHeaderCell();var b=this._field("owner");this.filterRow=b._filterRow();b.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},_setOption:function(){a.ui.c1basefield.prototype._setOption.apply(this,arguments)},_postset_aggregate:function(){this._field("owner")._ensureControl(2)},_postset_allowSort:function(){this.element.find("#contentCell").empty();this._headerTextDOM(this.options.headerText);this._refreshHeaderCell()},_postset_dataType:function(){throw"read-only";},_postset_dataParser:function(){this._field("owner")._ensureControl(2)},_postset_dataFormatString:function(){this._field("owner")._ensureControl(2)},_postset_filterOperator:function(){this._field("owner")._requiresDataBinding=true;this._field("owner")._ensureControl(2|8)},_postset_filterValue:function(){this._field("owner")._requiresDataBinding=true;this._field("owner")._ensureControl(2|8)},_postset_groupInfo:function(){this._field("owner")._ensureControl(2)},_postset_rowMerge:function(){this._field("owner")._ensureControl(2)},_postset_showFilter:function(){this._field("owner")._ensureControl(8)},_preset_sortDirection:function(a,b){var c=this._field("owner");if(!c._trigger("sorting",null,null))a=b;return a},_postset_sortDirection:function(){var a=this._field("owner");a._sortBy(this);a._trigger("sorted",null,null)},_postset_width:function(){a.ui.c1basefield.prototype._postset_width.apply(this,arguments)},_canSort:function(){var a=this._field("owner");return a&&a.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},_refreshHeaderCell:function(){this.element.empty().text(this.options.headerText);if(this._canSort()){this.element.wrapInner('<a class="ui-wijgrid-headertext" href="#" />');var b=this.element.find("> a");b.bind("click."+this.widgetName,this,this._onHrefClick);switch(this.options.sortDirection){case"ascending":b.append(a('<span class="ui-icon ui-icon-triangle-1-n">ascending</span>'));break;case"descending":b.append(a('<span class="ui-icon ui-icon-triangle-1-s">descending</span>'))}}else this.element.wrapInner('<span class="ui-wijgrid-headertext" />')},_prepareFilterCell:function(){var e=this.options.visLeavesIdx;if(e>=0){var c=this._field("owner"),d=null;if(this.filterRow)d=a((new a.ui.wijgrid.rowAccessor).getCell(this.filterRow,e));else throw"exception";d.find(".ui-wijgrid-filtericon").attr("class",this._getFilterOpIconCss(c,this.options.filterOperator));this.$filterEditor=d.find("input");var g=this._getFilterEditorWidth();this.$filterEditor.setOutWidth(g);var b=c._parse(this.options,this.options.filterValue);switch(this.options.dataType){case undefined:if(b===null)b="";case"boolean":if(b===null)b=false;case"string":if(b===null)b="";this.$filterEditor.wijinputmask({disabled:c.options.disabled,text:b});break;case"number":if(b!==null)this.$filterEditor.wijinputnumber({disabled:c.options.disabled,value:b});else this.$filterEditor.wijinputnumber({disabled:c.options.disabled});break;case"datetime":if(b!==null)this.$filterEditor.wijinputdate({disabled:c.options.disabled,date:b});else this.$filterEditor.wijinputdate({disabled:c.options.disabled});break;case"currency":if(b!==null)this.$filterEditor.wijinputnumber({disabled:c.options.disabled,type:"currency",value:b});else this.$filterEditor.wijinputnumber({disabled:c.options.disabled,type:"currency"})}var f=d.find(".ui-wijgrid-filter-trigger");f.bind("mouseenter",function(){var b=a(this);b.addClass("ui-state-hover")}).bind("mouseleave",function(){var b=a(this);b.removeClass("ui-state-hover");b.removeClass("ui-state-active")}).bind("mouseup",this,function(){a(this).removeClass("ui-state-active")}).bind("mousedown",{column:this},this._onFilterBtnClick)}},_onFilterBtnClick:function(h){var b=h.data.column;if(b.$dropDownFilterList)return false;var c=b._field("owner"),i=h.data.column.options.filterOperator.toLowerCase(),g=c.filterOperatorsCache.getByDataType(b.options.dataType);c.filterOperatorsCache.sort(g,c.options.filterOperatorsSortMode);var d=a.extend(true,{},{operators:g});c._trigger("filteroperatorslistshowing",null,d);var f=[];if(d.operators)for(var k in d.operators){var e=d.operators[k];f.push({label:e.name,value:e.name,selected:e.name.toLowerCase()===i})}b.$dropDownFilterList=a('<div class="ui-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:true,maxItemsCount:8,selected:function(g,f){var d=c.filterOperatorsCache.getByName(f.item.value);b._removeDropDownFilterList();var a=false;if(d)if(d.arity>1){var e=c._parse(b.options,b.$filterEditor.val());if(e!==null&&(b.options.dataType==="string"||!isNaN(e))){b.options.filterValue=e;a=true}}else a=true;if(a){b.options.filterOperator=d.name;c._requiresDataBinding=true;c._ensureControl(2|4)}}});b.$dropDownFilterList.wijlist("setItems",f).wijlist("renderList");f.length>8&&b.$dropDownFilterList.width(b.$dropDownFilterList.width()+20);b.$dropDownFilterList.$button=a(this);b.$dropDownFilterList.wijlist("refreshSuperPanel").position({of:a(this),my:"left top",at:"left bottom"});var j=b.$dropDownFilterList.eventGuid=(new Date).getTime();a(document).bind("mousedown."+b.widgetName+"."+j,{column:b},b._onDocMouseDown)},_getFilterOpIconCss:function(d,c){var b="filter-nofilter",a=d.filterOperatorsCache.getByName(c.toLowerCase());if(a)if(a.css)b=a.css;else b="filter-"+a.name.toLowerCase();return"ui-wijgrid-filtericon "+b},_onDocMouseDown:function(c){var b=a(c.target),d=b.is(".ui-wijgrid-filter-trigger")?b:b.parents(".ui-wijgrid-filter-trigger:first"),e=b.parents(".ui-wijgrid-filterlist:first");!(d.length&&d[0]===c.data.column.$dropDownFilterList.$button[0]||e.length&&e[0]===c.data.column.$dropDownFilterList[0])&&c.data.column._removeDropDownFilterList()},_onHrefClick:function(b){if(b.data.options.disabled)return false;if(b.data.options.allowSort){var a=b.data.options.sortDirection;a=a=="none"?"ascending":a=="ascending"?"descending":"ascending";b.data.option("sortDirection",a)}return false},_removeDropDownFilterList:function(){if(this.$dropDownFilterList){var b=this.$dropDownFilterList.eventGuid;this.$dropDownFilterList.remove();this.$dropDownFilterList=null;a(document).unbind("mousedown."+this.widgetName+"."+b,this._onDocMouseDown)}},_getFilterEditorWidth:function(){if(this.$filterEditor){var b=this.$filterEditor.closest(".ui-wijgrid-filter"),a=b.width()-b.find(".ui-wijgrid-filtericon").outerWidth();if(!a||a<0)a=0;return a}else throw"exception";},_somemethod:function(){}})})(jQuery);(function(a){a.widget("ui.c1band",a.ui.c1basefield,{options:{columns:[]},_create:function(){a.ui.c1basefield.prototype._create.apply(this,arguments);this.element.addClass("ui-widget ui-c1band")}})})(jQuery);$.extend($.ui.wijgrid,{bandProcessor:function(){var b,g,a,f,d,e,c;this.generateSpanTable=function(j,i){b=g=e=d=0;a=[];f=[];c=[];var h=this._generateSpanTable(j,i,true);return h},this._generateSpanTable=function(e,c,i){b=this._getVisibleHeight(e,i);c=c||[];$.ui.wijgrid.traverse(e,function(a){a.isLeaf&&c.push(a);f.push(a)});g=c.length;for(var d=0;d<b;d++){a[d]=[];for(var h=0;h<g;h++)a[d][h]={column:null,colSpan:0,rowSpan:0}}this._setTableValues(e,0,0);return a},this._getVisibleHeight=function(a,d){var b=0;if($.isArray(a))for(var c=0,e=a.length;c<e;c++){var f=this._getVisibleHeight(a[c],d);b=Math.max(b,f)}else{var g=a.visible===undefined?true:a.visible;a.parentVis=g&&d;if(a.isBand){for(var c=0,e=a.columns.length;c<e;c++){var f=this._getVisibleHeight(a.columns[c],a.parentVis);b=Math.max(b,f)}if(!a.parentVis)return b;a.isLeaf=b==0;b++}else{a.isLeaf=true;if(a.parentVis)b=1}}return b},this._getVisibleParent=function(a){while(a){a=f[a.parentIdx];if(a&&(a.parentVis||a.parentVis===undefined))return a}return null},this._setTableValues=function(f,g,k){if($.isArray(f))for(var h=0,n=f.length;h<n;h++)this._setTableValues(f[h],g,k);else{if(f.travIdx===undefined)throw"undefined travIdx";var l=k+d;if(f.parentVis){var i=l+e;a[g][i].column=f;c[f.travIdx]=i}if(f.isBand)for(var h=0,n=f.columns.length;h<n;h++)this._setTableValues(f.columns[h],g+1,k);if(f.parentVis)if(d-l===0){a[g][c[f.travIdx]].rowSpan=b-g;d++}else a[g][c[f.travIdx]].colSpan=d-l;else if(!f.isBand&&b>0){var j=this._getVisibleParent(f),m=j?j.isLeaf:false;if(m)e++;if(g>=b)g=b-1;var i=k+d+e;a[g][i].column=f;if(!m){j&&c[j.travIdx]===i&&this._shiftTableElements(i,g);e++}}}},this._shiftTableElements=function(d,e){for(var b=0;b<e;b++){a[b][d+1]=a[b][d];a[b][d]={column:null,colSpan:0,rowSpan:0};if(a[b][d+1].column)c[a[b][d+1].column.travIdx]++}}},getAllLeaves:function(b){var a=[];this._getAllLeaves(b,a);return a},_getAllLeaves:function(c,e){if(c)for(var d=0,f=c.length;d<f;d++){var b=c[d],a;if(b.options){if($.isFunction(b.columns))a=b.columns()}else a=b.columns;if(a&&a.length)this._getAllLeaves(a,e);else e.push(b)}},getColumnByTravIdx:function(c,d){var e=null;if(c)for(var f=0,g=c.length;f<g&&!e;f++){var a=c[f],b;if(a.options){if(a._field("travIdx")===d)return a;if($.isFunction(a.columns))b=a.columns()}else{if(a.travIdx===d)return a;b=a.columns}if(b)e=this.getColumnByTravIdx(b,d)}return e},getLeaves:function(b){var a=[];this._getLeaves(b,a);return a},_getLeaves:function(a,d){if(a)for(var c=0,e=a.length;c<e;c++){var b=a[c];b.isLeaf&&d.push(b);this._getLeaves(b.columns,d)}},setTraverseIndex:function(a){return this._setTraverseIndex(a,0,-1)},_setTraverseIndex:function(d,b,f){if(d)for(var e=0,g=d.length;e<g;e++){var a=d[e],c;if(a.options){a._field("travIdx",b++);a._field("parentIdx",f);if($.isFunction(a.columns))c=a.columns()}else{a.travIdx=b++;a.parentIdx=f;c=a.columns}if(c)b=this._setTraverseIndex(c,b,b-1)}return b},flatten:function(b){var a=[];this.traverse(b,function(b){a.push(b)});return a},traverse:function(c,b){if(c&&$.isFunction(b))for(var d=0,f=c.length;d<f;d++){var a=c[d];b(a);var e=$.isFunction(a.columns)?a.columns():a.columns;e&&this.traverse(e,b)}}});$.extend($.ui.wijgrid,{htmlTableDataReader:function(a){this.readTHead=function(){var e=a.element.find(" > table");if(!e.length)throw"table not found";var f=[],g=e[0].tHead;if(g)for(var c=0,j=1;c<j;c++){for(var h=g.rows[c],d=[],b=0,i=h.cells.length;b<i;b++)d.push(h.cells[b].innerHTML);f.push(d)}return f},this.readTBody=function(){var f=a.element.find(" > table");if(!f.length)throw"table not found";var g=[],d=f.find("> tbody");if(d.length)for(var c=0,j=d[0].rows.length;c<j;c++){for(var h=d[0].rows[c],e=[],b=0,i=h.cells.length;b<i;b++)e[b]={value:h.cells[b].innerHTML,originalRowIndex:c};g.push(e)}return g}}});$.extend($.ui.wijgrid,{dataMode:{dom:1,statical:2,remoteStatical:4,remoteDynamical:8},dataStore:function(b){var a=null,h=0,m=this,d=false,c=null,i,g=false,e=false;this.dataMode=function(){return f()},this.dataSource=function(){return a},this.getFieldsCount=function(){if(!d)throw"data is not loaded yet";return a.items&&a.items.length?p(a.items[0]):0},this.getFieldsNames=function(){if(!d)throw"data is not loaded yet";var e=[];if(a.items&&a.items.length)for(var c in a.items[0]){var b=c;if(typeof b==="string")b=c.toLowerCase();e[b]=c}return e},this.getTotalRowsCount=function(){if(!d)throw"data is not loaded yet";return f()===$.ui.wijgrid.dataMode.remoteDynamical?h:a.items.length},this.getDataSlice=function(){if(!d)throw"data is not loaded yet";if(!g){g=true;q()}if(!e){e=true;if(f()!==$.ui.wijgrid.dataMode.remoteDynamical)i=r();else i=$.extend(true,[],c);if(b.options.allowPaging){var a=Math.ceil(m.getTotalRowsCount()/b.options.pageSize)||1;b._field("pageCount",a)}}return i},this.load=function(c){if(!a)a=$.proxy(o,this)(b);if(f()===$.ui.wijgrid.dataMode.remoteDynamical)a.load(c);else if(!d)a.load(c);else{j(a,c);k(a,c)}},this.updateValue=function(b,f,e){if(!d)throw"data is not loaded yet";a.items[b][f]=e;c[b][f]=e};var o=function(c){var b=null,a=c.options.data;if(a===null)b=new wijdatasource({data:c.element.find("> table"),reader:new l(new n),loading:$.proxy(j,this),loaded:$.proxy(k,this)});else if($.isArray(a))b=new wijdatasource({data:a,reader:new l(new wijarrayreader),loading:$.proxy(j,this),loaded:$.proxy(k,this)});else b=new wijdatasource({data:a.data,reader:new l(a.reader),proxy:a.proxy,loading:$.proxy(function(b,c){a.loading&&a.loading(b,c);$.proxy(j,this)(b,c)},this),loaded:$.proxy(function(b,c){a.loaded&&a.loaded(b,c);$.proxy(k,this)(b,c)},this)});return b},j=function(d,a){g=false;e=false;i=null;c=null;b._dataLoading(a)},k=function(h,l){d=true;if(m.dataMode()===$.ui.wijgrid.dataMode.remoteDynamical){g=false;e=true}else{g=false;e=false}for(var j=[],a=0,n=h.items.length;a<n;a++){var f=h.items[a],i=$.isArray(f)?[]:{};for(var k in f)i[k]={value:f[k],originalRowIndex:a};j.push(i)}c=j;b._dataLoaded(l)},f=function(){return!a.data?$.ui.wijgrid.dataMode.dom:a.data.proxy?a.data.proxy.dynamic===true?$.ui.wijgrid.dataMode.remoteDynamical:$.ui.wijgrid.dataMode.remoteStatical:$.ui.wijgrid.dataMode.statical},p=function(a){if($.isArray(a))return a.length;else{var b=0;for(var c in a)b++;return b}},q=function(){if(c&&c.length){var e=[];$.ui.wijgrid.traverse(b.options.columns,function(a){$.ui.wijgrid.validDataKey(a.dataKey)&&e.push(a)});for(var i=Math.min(e.length,m.getFieldsCount()),g=0,j=c.length;g<j;g++)for(var h=c[g],f=0;f<i;f++){var a=null,d=e[f];if(d&&d.dataParser){a=b._parse(d,h[d.dataKey].value);switch(d.dataType){case"datetime":if(a!==null&&!(a instanceof Date))throw"invalid value.";break;case"number":case"currency":if(a!==null&&(typeof a!=="number"||isNaN(a)))throw"invalid value.";break;case"boolean":if(a!==null&&(typeof a!=="boolean"||isNaN(a)))throw"invalid value.";}h[d.dataKey].value=a}}}},r=function(){if(c&&c.length){var d=b._buildFilterInfo(),a=null;if(b.options.allowSorting)a=b._buildSortInfo();var e=(new $.ui.wijgrid.dataHelper).getDataSlice(b,$.extend(true,[],c),d,a);return e}return[]},l=function(a){this.read=function(b){if(a&&$.isFunction(a.read))a.read(b);else b.items=b.data;if(b.items&&$.isArray(b.items)){var c=0;if(f()===$.ui.wijgrid.dataMode.remoteDynamical){c=1;if(b.items.length<1||b.items[0].length!==1)throw"invalid data";h=parseInt(b.items[0][0]);if(isNaN(h))throw"invalid data";b.items.splice(0,1)}}else{h=0;b.items=[]}}},n=function(){this.read=function(b){b.items=[];if(b&&b.data&&b.data.length){b.items=a(b.data);b.data=null}else throw"invalid data source";};function a(j){var e=[],c=j.find("> tbody:first");if(c.length)for(var f=c[0],b=0,i=f.rows.length;b<i;b++){for(var g=f.rows[b],d=[],a=0,h=g.cells.length;a<h;a++)d[a]=g.cells[a].innerHTML;e[b]=d}return e}}},dataHelper:function(){this.getDataSlice=function(d,c,i,j){c=a(c,i,d);d.options.allowSorting&&$.proxy(b,this)(c,j);if(d.options.allowPaging){var e=Math.min(c.length-1,d.options.pageIndex*d.options.pageSize);if(e<0)e=0;for(var k=Math.min(c.length,e+d.options.pageSize),g=[],f=e,l=0,h=0;f<k;f++,h++)g[h]=c[f];c=g}return c};var a=function(c,b,m){var i,f;if(!c||(i=c.length)===0||!b||(f=b.length)===0)return c;for(var h={},a=0;a<f;a++){var d=b[a],n=d.operator,l=d.column;if(n.arity>1)h[a]=m._parse(l,l.filterValue)}for(var j=[],a=0;a<i;a++){for(var k=c[a],g=true,e=0;e<f&&g;e++){var d=b[e],o=k[d.column.dataIndex].value;g&=d.operator.operator(o,h[e])}g&&j.push($.extend(true,[],k))}return j},b=function(i,f){if(f.length){var a=[];a.push("var _wijgriddatahelper = this;");a.push("var _wijgridSortFunc = function(a, b)\n{\n");for(var e=0,j=f.length;e<j;e++){var d="arg"+e,b=f[e],c=typeof b.dataKey==="string"?'"'+b.dataKey+'"':b.dataKey;if(b.sortDirection==="ascending"||b.sortDirection==="descending")if(b.sortDirection==="ascending")a.push("var ",d," = _wijgriddatahelper._sortAsc","(a[",c,"].value, b[",c,"].value);\n");else a.push("var ",d," = _wijgriddatahelper._sortDesc","(a[",c,"].value, b[",c,"].value);\n");else a.push("var ",d," = _wijgriddatahelper._sortDigitAsc","(a[",c,"].originalRowIndex, b[",c,"].originalRowIndex);\n");a.push("if (",d," == 0)\n");a.push("{\n")}var g=f.length-1;if(g>=0){var d="arg"+g,b=f[g],c=typeof b.dataKey==="string"?'"'+b.dataKey+'"':b.dataKey;if(b.sortDirection==="ascending"||b.sortDirection==="descending")if(b.sortDirection==="ascending")a.push("var ",d," = _wijgriddatahelper._sortDigitAsc","(a[",c,"].originalRowIndex, b[",c,"].originalRowIndex);\n");else a.push("var ",d," = _wijgriddatahelper._sortDigitDesc","(a[",c,"].originalRowIndex, b[",c,"].originalRowIndex);\n")}for(var e=f.length-1;e>=0;e--){a.push("}\n");var d="arg"+e;a.push("return ",d,";\n")}a.push("}");var h=a.join("");eval(h);i.sort(_wijgridSortFunc)}};this._sortAsc=function(a,b){if(a instanceof Date)a=a.getTime();if(b instanceof Date)b=b.getTime();return a===b?0:a===null?-1:b===null?1:a<b?-1:1};this._sortDesc=function(a,b){if(a instanceof Date)a=a.getTime();if(b instanceof Date)b=b.getTime();return a===b?0:a===null?1:b===null?-1:a<b?1:-1};this._sortDigitAsc=function(a,b){return a-b};this._sortDigitDesc=function(a,b){return b-a}}});$.extend($.ui.wijgrid,{groupRange:function(c,f,g,e){this.value=-1;switch(arguments.length){case 4:this.isExpanded=c;this.cr=f;this.sum=g;this.position=e;break;case 1:this.isExpanded=c;this.cr=new $.ui.wijgrid.cellRange(-1,-1);this.sum=-1;this.position="none";break;default:this.isExpanded=false;this.cr=new $.ui.wijgrid.cellRange(-1,-1);this.sum=-1;this.position="none"}this.isSubRange=function(a){return this.cr.r1>=a.cr.r1&&this.cr.r2<=a.cr.r2},this.toString=function(){return this.cr.r1+"-"+this.cr.r2},this._getHeaderImageClass=function(b){var a=this.owner;return a?b?a.expandedImageClass||"ui-icon-minus":a.collapsedImageClass||"ui-icon-plus":null},this.collapse=function(){var a,f,e;if((a=this.owner)&&(f=a.owner)&&(e=f.owner)){var b=new $.ui.wijgrid.groupHelper,c=e._field("leaves");if(b.isParentExpanded(c,this.cr,a.level))if(a.position!=="footer"&&a.outlineMode!=="none"){var g=b.getGroupedColumnsCount(c);d(b,e._rows(),c,this,g)}}},this.expand=function(h){var c,f,e;if((c=this.owner)&&(f=c.owner)&&(e=f.owner)){var a=new $.ui.wijgrid.groupHelper,d=e._field("leaves");if(a.isParentExpanded(d,this.cr,c.level)){var g=a.getGroupedColumnsCount(d);b(a,e._rows(),d,this,g,h,true)}}};var d=function(l,e,n,b,k){var j=b.owner,i=b.cr.r1,m=b.cr.r2;switch(j.position){case"header":case"headerAndFooter":i++}for(var d=i;d<=m;d++){var c=e.item(d);if(c){if(c[0])c[0].style.display="none";if(c[1])c[1].style.display="none"}}b.isExpanded=false;a(e,b);for(var d=j.level+1;d<=k;d++)for(var g=l.getChildGroupRanges(n,b.cr,b.owner.level),f=0,o=g.length;f<o;f++){var h=g[f];h.isExpanded=false;a(e,h)}},b=function(l,e,m,f,k,n,o){var r=f.owner,g=f.cr.r1,h=f.cr.r2;switch(r.position){case"header":var c=e.item(g);if(c){if(c[0])c[0].style.display="";if(c[1])c[1].style.display=""}g++;break;case"footer":var c=e.item(h);if(c){if(c[0])c[0].style.display="";if(c[1])c[1].style.display=""}h--;break;case"headerAndFooter":var c=e.item(g);if(c){if(c[0])c[0].style.display="";if(c[1])c[1].style.display=""}if(o){var c=e.item(h);if(c){if(c[0])c[0].style.display="";if(c[1])c[1].style.display=""}}g++;h--}if(o){f.isExpanded=true;a(e,f)}else return;if(f.owner.level===k)for(var d=g;d<=h;d++){var c=e.item(d);if(c){if(c[0])c[0].style.display="";if(c[1])c[1].style.display=""}}else{var i=l.getChildGroupRanges(m,f.cr,f.owner.level);if(n)for(var d=0,p=i.length;d<p;d++){var j=i[d];b(l,e,m,j,k,n,true)}else for(var d=0,p=i.length;d<p;d++){var j=i[d],q=j.owner.position==="footer"||j.owner.outlineMode==="none"?true:false;b(l,e,m,j,k,false,q)}}},a=function(d,a){if(a.owner.position!=="footer"){var b=null,c=d.item(a.cr.r1);if(c)if(c[0])b=$(c[0]).find("div.ui-wijgrid-grouptogglebtn:first-child");if(b&&b.length){b.toggleClass(a._getHeaderImageClass(!a.isExpanded),false);b.toggleClass(a._getHeaderImageClass(a.isExpanded),true)}}}},grouper:function(){this.group=function(e,f,b){this._grid=e;this._data=f;this._leaves=b;this._visibleLeaves=e._field("visibleLeaves");this._groupRowIdx=0;this._groupHelper=new $.ui.wijgrid.groupHelper;for(var d=1,c=0,g=b.length;c<g;c++){var a=b[c];this._groupRowIdx=0;if(a.dynamic!==true&&a.groupInfo&&(a.groupInfo.position&&a.groupInfo.position!=="none")&&a.dataIndex>=0){a.groupInfo.level=d;a.groupInfo.expandInfo=[];this._processRowGroup(a,d++)}}delete this._grid;delete this._data;delete this._leaves;delete this._visibleLeaves},this._processRowGroup=function(d,c){for(var e=0;e<this._data.length;e++){if(this._data[e].rowType!=="data")continue;var a=this._getGroupCellRange(e,d,c),g=true,l=d.groupInfo.outlineMode==="startCollapsed";if(l||this._groupHelper.isParentCollapsed(this._leaves,a,c)){if(d.groupInfo.groupSingleRow===false&&a.r1==a.r2)continue;g=false}if(c&&this._grid.options.groupIndent)for(var k=a.r1;k<=a.r2;k++)this._addIndent(this._data[k][0],c);switch(d.groupInfo.position){case"header":var b=this._addGroupRange(d.groupInfo,a,g);this._updateByGroupRange(b,c);var f=this._groupHelper.isParentCollapsed(this._leaves,b.cr,c),j=this._buildGroupRow(b,a,true,f);if(!g)for(var h=a.r1;h<=a.r2;h++)this._data[h].display="none";this._data.splice(a.r1,0,j);if(f)j.display="none";e=a.r2+1;break;case"footer":var b=this._addGroupRange(d.groupInfo,a,true);this._updateByGroupRange(b,c);var i=this._buildGroupRow(b,a,false,false);this._data.splice(a.r2+1,0,i);e=a.r2+1;var f=this._groupHelper.isParentCollapsed(this._leaves,b.cr,c);if(f)i.display="none";break;case"headerAndFooter":var b=this._addGroupRange(d.groupInfo,a,g);this._updateByGroupRange(b,c);var f=this._groupHelper.isParentCollapsed(this._leaves,b.cr,c),j=this._buildGroupRow(b,a,true,f),i=this._buildGroupRow(b,a,false,false);if(!g)for(var h=a.r1;h<=a.r2;h++)this._data[h].display="none";this._data.splice(a.r2+1,0,i);if(f||!g)i.display="none";this._data.splice(a.r1,0,j);if(f)j.display="none";e=a.r2+2;break;default:throw $.ui.wijgrid.stringFormat('Unknown Position value: "{0}"',d.groupInfo.position);}this._groupRowIdx++}},this._buildGroupRow=function(k,f,e){var d=k.owner,a=d.owner,q=a.owner,h=[];h.id=(e?"GH":"GF")+this._groupRowIdx+"-"+d.level;h.rowType=e?"groupHeader":"groupFooter";var i="",p;if(a.dataIndex>=0&&(p=this._data[f.r1][a.dataIndex].value)!==null)i=q._toStr(a,p);this._grid.options.showRowHeader&&h.push({html:"&nbsp;"});var g={html:""};if(e&&d.outlineMode!=="none")if(k.isExpanded)g.html='<div class="ui-icon '+k._getHeaderImageClass(true)+' ui-wijgrid-grouptogglebtn">&nbsp;</div>';else g.html='<div class="ui-icon '+k._getHeaderImageClass(false)+' ui-wijgrid-grouptogglebtn">&nbsp;</div>';h.push(g);var m=0,j="";if(a.aggregate&&a.aggregate!=="none"){j=this._getAggregate(f,a,a,e,i);if(a.parentVis)m=1}var b=e?d.headerText:d.footerText;if(b==="custom"){var o={data:this._data,column:a,groupByColumn:d.owner,groupText:i,text:"",groupingStart:f.r1,groupingEnd:f.r2,isGroupHeader:e,aggregate:j};if(this._grid._trigger("grouptext",null,o))b=o.text}else{if(b===undefined||b===null){if(e)b="{1}: {0}";if(j||j===0)b=b?b+" {2}":"{2}"}b=$.ui.wijgrid.stringFormat(b,i,a&&a.headerText?a.headerText:"",j.toString())}if(!b)b="&nbsp;";g.html+="<span>"+b+"</span>";this._addIndent(g,d.level-1);for(var n=m,c=this._grid.options.showRowHeader?1:0;c<f.c1;c++)if(this._leaves[c].parentVis)n++;c=f.c1+m;for(;c<this._leaves.length;c++){var a=this._leaves[c];if(a.dynamic!==true&&a.aggregate&&a.aggregate!=="none")break;if(a.parentVis)n++}for(;c<this._leaves.length;c++){var a=this._leaves[c];if(a.parentVis){var l=this._getAggregate(f,a,d.owner,e,i);if(!l&&l!==0)l="&nbsp;";h.push({html:l.toString()})}}g.colSpan=n;return h},this._getAggregate=function(c,a,g,h,i){var b="";if(!a.parentVis||!a.aggregate||a.aggregate==="none")return b;if(a.aggregate==="custom"){var f={data:this._data,column:a,groupByColumn:g,groupText:i,text:"",groupingStart:c.r1,groupingEnd:c.r2,isGroupHeader:h};if(this._grid._trigger("groupaggregate",null,f))b=f.text}else{for(var e=new this._tally,d=c.r1;d<=c.r2;d++)e.add(this._data[d][a.dataIndex].value);b=e.getValueString(a)}return b},this._getGroupCellRange=function(b,c,f){var g=c.leavesIdx,a=new $.ui.wijgrid.cellRange(b,g),d=this._groupHelper.getParentGroupRange(this._leaves,a,f);if(this._data[b].rowType==="data"){var h=this._data[b][c.dataIndex].value,e=0;for(a.r2=b,e=this._data.length-1;a.r2<e;a.r2++){if(this._data[a.r2+1].rowType!=="data"||d&&a.r2+1>d.r2)break;if(this._data[a.r2+1][c.dataIndex].value!==h)break}}return a},this._addGroupRange=function(a,b,g){var c=null,d=this._groupHelper.getChildGroupIndex(b,a.expandInfo);if(d>=0&&d<a.expandInfo.length)c=a.expandInfo[d];else{var h=new $.ui.wijgrid.cellRange(b.r1,b.r1,b.r2,b.r2),f=a.position==="footer"?true:g&&a.outlineMode!=="startCollapsed";c=new $.ui.wijgrid.groupRange(f,h,-1,a.position);c.owner=a;a.expandInfo.push(c)}if(c){var i=b.r1,e=b.r2;if(a.position==="headerAndFooter")e+=2;if(a.position!=="headerAndFooter")e++;c.cr.r2=e}return c},this._updateByGroupRange=function(c,g){for(var d=0,i=this._leaves.length;d<i;d++){var b=this._leaves[d].groupInfo;if(b&&b.level<g)for(var h=b.expandInfo?b.expandInfo.length:0,e=0;e<h;e++){var a=b.expandInfo[e],f=c.position==="headerAndFooter"?2:1;if(a.cr.r1>=c.cr.r1&&!(a.cr.r1===c.cr.r1&&a.position==="footer"))a.cr.r1+=f;if(a.cr.r2>=c.cr.r1)a.cr.r2+=f}}},this._addIndent=function(c,b){var a;if(b>0&&(a=this._grid.options.groupIndent))c.paddingLeft=a*b+"px"},this._tally=function(){this._sum=0;this._sum2=0;this._cntNumbers=0;this._cntStrings=0;this._max=0;this._min=0;this._minString=undefined;this._maxString=undefined;this.add=function(a){if(a===null||a==="")return;this._cntStrings++;if(typeof a==="string"){if(this._minString===undefined||a<this._minString)this._minString=a;if(this._maxString===undefined||a>this._maxString)this._maxString=a;a=this._parseValue(a)}if(!isNaN(a)){if(this._cntNumbers===0){this._min=a;this._max=a}this._cntNumbers++;this._sum+=a;this._sum2+=a*a;if(a<this._min)this._min=a;if(a>this._max)this._max=a}},this.getValueString=function(a){if(this._cntNumbers){var c=this._getValue(a.aggregate),b=a.owner;return b._toStr(a,c)}if(this._cntStrings)switch(a.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings.toString()}return""},this._getValue=function(b){switch(b){case"average":return this._cntNumbers===0?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":return this._cntNumbers<=1?0:Math.sqrt(this._getValue("var"));case"stdPop":return this._cntNumbers<=1?0:Math.sqrt(this._getValue("varPop"));case"var":return this._cntNumbers<=1?0:this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1)return 0;var a=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-a*a}return 0},this._parseValue=function(a){var d=false,b=a.length;if(b>0&&a.indexOf("%")===b-1){d=true;a=a.substr(0,b-1)}var c=parseFloat(a);return isNaN(c)?NaN:d?c/100:c}}}});$.extend($.ui.wijgrid,{groupHelper:function(){this.getGroupInfo=function(b){if(b){if(!$.ui.wijgrid._getGroupInfoRegExp)$.ui.wijgrid._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$");var a=$.ui.wijgrid._getGroupInfoRegExp.exec(b.id);if(a){var e=parseInt(a[3]),d=parseInt(a[2]),c=a[1]==="H";return{level:e,index:d,isHeader:c,toString:function(){return(this.isHeader?"GH":"GF")+this.index+"-"+this.level}}}}return null},this.getColumnByGroupLevel=function(c,d){for(var b=0,e=c.length;b<e;b++){var a=c[b];if(a.groupInfo&&a.groupInfo.level===d)return a}return null},this.getGroupedColumnsCount=function(c){for(var d=0,a=0,e=c.length;a<e;a++){var b=c[a].groupInfo;if(b&&b.position!=="none")d++}return d};this.getChildGroupIndex=function(f,d){var a=0,c=d.length-1;while(a<=c){var b=(c-a>>1)+a,e=d[b].cr.r1-f.r1;if(e===0)return b;if(e<0)a=b+1;else c=b-1}return a},this.getParentGroupIndex=function(c,b){var a=this.getChildGroupIndex(c,b);if(a>0)a--;return a<b.length?a:-1},this.getChildGroupRanges=function(h,e,i){var f=[],c=this.getColumnByGroupLevel(h,i+1);if(c)for(var a=c.groupInfo.expandInfo,g=this.getChildGroupIndex(e,a),b=g,j=a.length;b<j;b++){var d=a[b];if(d.cr.r2<=e.r2)f.push(d);else break}return f},this.getParentGroupRange=function(d,f,b){if(b===undefined)b=65535;if(b-2>=0)for(var c=d.length-1;c>=0;c--){var a=d[c].groupInfo;if(!a||!a.expandInfo||a.level<0||a.level>=b)continue;var e=this.getParentGroupIndex(f,a.expandInfo);if(e>=0)return a.expandInfo[e]}return null},this.isParentCollapsed=function(e,c,d){if(d===1)return false;for(var b=d;b>1;b--){var a=this.getParentGroupRange(e,c,b);if(a&&!a.isExpanded)return true;c=a.cr}return false},this.isParentExpanded=function(e,c,d){if(d===1)return true;for(var b=d;b>1;b--){var a=this.getParentGroupRange(e,c,b);if(a&&a.isExpanded)return true;c=a.cr}return false}}});$.extend($.ui.wijgrid,{cellRange:function(b,a,d,c){switch(arguments.length){case 2:this.r1=this.r2=b;this.c1=this.c2=a;break;case 4:this.r1=b;this.r2=d;this.c1=a;this.c2=c;break;default:this.r1=0;this.r2=0;this.c1=0;this.c2=0}this.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2}},merger:function(){this.merge=function(d,b){this.leaves=b;this.data=d;for(var c=0,e=b.length;c<e;c++){var a=b[c];a.dataIndex>=0&&!a.isBand&&(a.rowMerge==="free"||a.rowMerge==="restricted")&&this.mergeColumn(a)}delete this.data;delete this.leaves};this.mergeColumn=function(e){for(var d=e.dataIndex,b=0,g=this.data.length;b<g;b++){if(this.data[b].rowType!=="data")continue;var a=this.getCellRange(b,e);if(a.r1!==a.r2){var f=a.r2-a.r1+1;this.data[a.r1][d].rowSpan=f;for(var c=a.r1+1;c<=a.r2;c++)this.data[c][d].visible=false}b=a.r2}};this.getCellRange=function(b,d){var c=d.dataIndex,a=new $.ui.wijgrid.cellRange(b,c),j=this.data[b][c].value,i=this.data.length;for(a.r2=b;a.r2<i-1;a.r2++){var e=this.data[a.r2+1];if(e.rowType!=="data"||e[c].value!==j)break}var g=d.leavesIdx;if(g>0&&d.rowMerge==="restricted"){var f=this.leaves[g-1];if(f.dataIndex>=0){var h=this.getCellRange(b,f);a.r1=Math.max(a.r1,h.r1);a.r2=Math.min(a.r2,h.r2)}}return a}}});$.extend($.ui.wijgrid,{stringFormat:function(a){if(!a)return"";for(var b=1,c=arguments.length;b<c;b++)a=a.replace(new RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a},validDataKey:function(a){return a!==undefined&&!(a<0)},iterateChildrenWidgets:function(a,b){if(a&&b){if(a.nodeType)a=$(a);a.find(".ui-widget").each(function(a,c){$.each($(c).data(),function(d,c){c.widgetName&&d!=="owner"&&b(a,c)})})}},domSelection:function(a){this.getSelection=function(){var b=0,c=0;if(a.selectionStart){b=a.selectionStart;c=a.selectionEnd}else if(document.selection){var d=document.selection.createRange().duplicate();c=d.text.length;b=Math.abs(d.moveStart("character",-a.value.length));c+=b}return{start:b,end:c,length:c-b}};this.setSelection=function(c){if(a.selectionStart)a.setSelectionRange(c.start,c.end);else{var b=a.createTextRange();b.collapse(true);b.moveStart("character",c.start);b.moveEnd("character",c.end);b.select()}}},bounds:function(c,d){if(c){var b=c.nodeType?$(c):c,a=b.offset();if(a)return d?{top:a.top,left:a.left,width:b[0].clientWidth||0,height:b[0].clientHeight||0}:{top:a.top,left:a.left,width:b.outerWidth(),height:b.outerHeight()}}return null},_getDOMText:function(a,c,b){if(b===undefined)b=0;if(a&&(!c||c&&b<2))if(a.nodeType===3)return a.nodeValue;else if(a.nodeType===1){switch(a.type){case"button":case"text":case"textarea":case"select-one":return a.value;case"checkbox":return a.checked.toString()}for(var e="",d=0;a.childNodes[d];d++)e+=this._getDOMText(a.childNodes[d],c,b+1);return e}return""}});$.extend($.ui.wijgrid,{measurments:[],timerOn:function(a){this.measurments[a]=(new Date).getTime()},timerOff:function(a){var b=((new Date).getTime()-this.measurments[a])/1e3;delete this.measurments[a];return b},shallowMerge:function(a,c){if(c&&a)for(name in c){var d=c[name],b=typeof d;if((b==="string"||b==="boolean"||b=="number")&&a[name]===undefined)a[name]=d}}});var wijgridStringParser={parseDOM:function(d,b,c,a){return this.parse($.ui.wijgrid._getDOMText(d,true),b,c,a)},parse:function(a,c,d,b){return a===null||a===b?null:a===undefined||a==="&nbsp;"?"":""+a},toStr:function(a,c,d,b){return a===null?b:a}},wijgridNumberParser={parseDOM:function(d,b,c,a){return this.parse($.ui.wijgrid._getDOMText(d,true),b,c,a)},parse:function(a,c,d,b){return typeof a==="number"&&isNaN(a)?NaN:!a&&a!==0||a==="&nbsp;"||a===b?null:$.parseFloat(a,10,c.name)},toStr:function(b,d,a,c){return b===null?c:$.format(b,a?a:"n",d.name)}},wijgridCurrencyParser={parseDOM:function(d,b,c,a){return this.parse($.ui.wijgrid._getDOMText(d,true),b,c,a)},parse:function(a,b,d,c){if(typeof a==="number"&&isNaN(a))return NaN;if(!a&&a!==0||a==="&nbsp;"||a===c)return null;if(typeof a==="string")a=a.replace(b.numberFormat.currency.symbol,"");return $.parseFloat(a,10,b.name)},toStr:function(b,d,a,c){return b===null?c:$.format(b,a?a:"c",d.name)}},wijgridDateTimeParser={parseDOM:function(d,b,c,a){return this.parse($.ui.wijgrid._getDOMText(d,true),b,c,a)},parse:function(a,c,d,b){if(a instanceof Date)return a;if(!a||a==="&nbsp;"||a===b)return null;var e=$.parseDate(a,d,c.name);return e},toStr:function(b,d,a,c){return b===null?c:$.format(b,a?a:"d",d.name)}},wijgridBoolParser={parseDOM:function(d,b,c,a){return this.parse($.ui.wijgrid._getDOMText(d,true),b,c,a)},parse:function(a,d,e,c){var b=typeof a;if(b==="boolean")return a;if(b==="string")a=$.trim(a);if(!a||a==="&nbsp;"||a===c)return null;switch(a.toLowerCase()){case"true":return true;case"false":return false}return NaN},toStr:function(a,c,d,b){return a===null?b:a?"true":"false"}};$.extend($.ui.wijgrid,{filterOperatorsCache:function(){var a={};this.add=function(b){if(b&&b.name&&b.operator){var c=b.name.toLowerCase();if(!a[c])a[c]=b}},this.clear=function(){a.length=0},this.getByName=function(b){return a[b.toLowerCase()]},this.getByDataType=function(d){var c=[];for(var e in a){var b=a[e];$.inArray(d,b.applicableTo)>=0&&c.push(b)}return c},this.removeCustom=function(){for(var b in a)if(a[b].custom)delete a[b]};this.sort=function(a,e){switch(e.toLowerCase()){case"alphabetical":a.sort(d);break;case"alphabeticalcustomfirst":a.sort(c);break;case"alphabeticalembeddedFirst":a.sort(b)}return a};function d(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}return a===b?0:a<b?-1:1}function b(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}if(c.custom!==d.custom){if(c.custom)return 1;if(d.custom)return-1}return a===b?0:a<b?-1:1}function c(c,d){var a=c.name.toLowerCase(),b=d.name.toLowerCase();if(a!==b){if(a==="nofilter")return-1;if(b==="nofilter")return 1}if(c.custom!==d.custom){if(c.custom)return-1;if(d.custom)return 1}return a===b?0:a<b?-1:1}}});$.ui.wijgrid.embeddedFilters=[{name:"NoFilter",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(){return true}},{name:"Contains",arity:2,applicableTo:["string"],operator:function(a,b){return a===b?true:a?a.indexOf(b)>=0:false}},{name:"NotContain",arity:2,applicableTo:["string"],operator:function(a,b){return a===b?false:a?a.indexOf(b)<0:true}},{name:"BeginsWith",arity:2,applicableTo:["string"],operator:function(a,b){return a===b?true:a?a.indexOf(b)===0:false}},{name:"EndsWith",arity:2,applicableTo:["string"],operator:function(a,b){if(a===b)return true;if(a){var c=a.lastIndexOf(b);return c>=0?a.length-c===b.length:false}return false}},{name:"Equals",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b===a}},{name:"NotEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b!==a}},{name:"Greater",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b>a}},{name:"Less",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b<a}},{name:"GreaterOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b>=a}},{name:"LessOrEqual",arity:2,applicableTo:["string","number","datetime","currency","boolean"],operator:function(b,a){if(b instanceof Date)b=b.getTime();if(a instanceof Date)a=a.getTime();return b<=a}},{name:"IsEmpty",arity:1,applicableTo:["string"],operator:function(a){return!a&&a!==0&&a!==false}},{name:"NotIsEmpty",arity:1,applicableTo:["string"],operator:function(a){return!!a||a===0||a===false}},{name:"IsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(a){return a===null}},{name:"NotIsNull",arity:1,applicableTo:["string","number","datetime","currency","boolean"],operator:function(a){return a!==null}}];$.extend($.ui.wijgrid,{htmlTableAccessor:function(d){var b=[],c=0,a=d;e();function e(){for(var f=[],h=0,n=a.rows.length;h<n;h++){var e=[];b[h]=e;for(var k=a.rows[h],g=0,d=0,m=k.cells.length;g<m;g++,d++){for(var j=k.cells[g];f[d]>1;d++){f[d]--;e[d]={cellIdx:-1,colIdx:-1}}if(!(f[d]>1))f[d]=j.rowSpan;e[d]={cellIdx:g,colIdx:-1};e[g].colIdx=d;for(var l=j.colSpan;l>1;l--)e[++d]={cellIdx:-1,colIdx:-1}}for(var i=f.length;d<i;d++){f[d]--;e[d]={cellIdx:-1,colIdx:-1}}c=Math.max(c,i)}}this.element=function(){return d};this.getCellIdx=function(a,d){return a<c?b[d][a].cellIdx:-1};this.getColumnIdx=function(a,e){if(typeof a!=="number"){var d=a;a=d.cellIndex;e=d.parentNode.rowIndex}return a<c?b[e][a].colIdx:-1};this.getSectionLength=function(d){var b=a;switch(d){case 1:b=a.tHead;break;case 2:var c;if((c=a.tBodies)&&c.length)b=c[0];break;case 3:b=a.tFoot}return b?b.rows.length:0};this.getSectionRow=function(d,e){var b=a;switch(e){case 1:b=a.tHead;break;case 2:var c;if((c=a.tBodies)&&c.length)b=c[0];break;case 3:b=a.tFoot}return b?b.rows[d]:undefined};this.forEachColumnCellNatural=function(b,f,h){for(var c=0,g=a.rows.length;c<g;c++){var e=a.rows[c];if(b<e.cells.length){var d=f(e.cells[b],b,h);if(d!==true)return d}}return true};this.forEachColumnCell=function(f,g,i){for(var c=0,h=b.length;c<h;c++){var j=a.rows[c],d=this.getCellIdx(f,c);if(d>=0){var e=g(j.cells[d],c,i);if(e!==true)return e}}return true};this.forEachRowCell=function(f,e,h){for(var d=a.rows[f],b=0,g=d.cells.length;b<g;b++){var c=e(d.cells[b],b,h);if(c!==true)return c}return true};this.colGroupTag=function(){var b=a.getElementsByTagName("colgroup");return b!=null&&b.length>0?b[0]:null};this.colTags=function(){var a=this.colGroupTag();return a!=null?a.getElementsByTagName("col"):[]}}});$.ui.wijgrid.cellInfo=function(a,b){var d=false,c=null;this.cellIndex=function(b){if(b===undefined)return a;a=b};this.rowIndex=function(a){if(a===undefined)return b;b=a};this.isEqual=function(c){return c&&c.rowIndex()===b&&c.cellIndex()===a};this.tableCell=function(){if(c&&this._isValid()){var d=c._getDataToAbsOffset();return c._field("view").getCell(a+d.x,b+d.y)}return null};this.value=function(){return c&&this._isValid()?c.dataTable[b][a].value:undefined};this.toString=function(){return a+":"+b};this._dataToAbs=function(c){a-=c.x;b-=c.y;return this};this._clip=function(e){var d=false,c;if(a<(c=e.topLeft().cellIndex())){d=true;a=c}if(a>(c=e.bottomRight().cellIndex())){d=true;a=c}if(b<(c=e.topLeft().rowIndex())){d=true;b=c}if(b>(c=e.bottomRight().rowIndex())){d=true;b=c}return d};this._clone=function(){return new $.ui.wijgrid.cellInfo(a,b)};this._column=function(){if(c&&this._isValid()){var b=c._getDataToAbsOffset();return c._field("visibleLeaves")[a+b.x]}return null};this._row=function(){return c&&this._isValid()?c._rows().item(b):null};this._isValid=function(){return a>=0&&b>=0};this._isEdit=function(a){if(!arguments.length)return d;d=a};this._setGridView=function(a){c=a}};$.ui.wijgrid.cellInfo.prototype.outsideValue=new $.ui.wijgrid.cellInfo(-1,-1);$.ui.wijgrid.cellInfoRange=function(d,c){if(!d||!c)throw"invalid arguments";var a=d._clone(),b=c._clone();this.bottomRight=function(){return b};this.isEqual=function(c){return c&&a.isEqual(c.topLeft())&&b.isEqual(c.bottomRight())};this.topLeft=function(){return a};this.toString=function(){return a.toString()+" - "+b.toString()};this._isIntersect=function(c){if(c){var d=c.bottomRight().rowIndex()-c.topLeft().rowIndex()+1,f=b.rowIndex()-a.rowIndex()+1;if(c.topLeft().rowIndex()+d-a.rowIndex()<d+f){var e=c.bottomRight().cellIndex()-c.topLeft().cellIndex()+1,g=b.cellIndex()-a.cellIndex()+1;return c.topLeft().cellIndex()+e-a.cellIndex()<e+g}}return false};this._isValid=function(){return a._isValid()&&b._isValid()};this._clip=function(c){return a._clip(c)|b._clip(c)};this._clone=function(){return new $.ui.wijgrid.cellInfoRange(a._clone(),b._clone())};this._containsCellInfo=function(c){return c&&c.cellIndex()>=a.cellIndex()&&c.cellIndex()<=b.cellIndex()&&c.rowIndex()>=a.rowIndex()&&c.rowIndex()<=b.rowIndex()};this._containsCellRange=function(a){return a&&this._containsCellInfo(a.topLeft())&&this._containsCellInfo(a.bottomRight())};this._extend=function(d,c){if(d===1){a.rowIndex(c.topLeft().rowIndex());b.rowIndex(c.bottomRight().rowIndex())}else if(d===2){a.cellIndex(c.topLeft().cellIndex());b.cellIndex(c.bottomRight().cellIndex())}return this};this._normalize=function(){var c=a.cellIndex(),e=a.rowIndex(),d=b.cellIndex(),f=b.rowIndex();a.cellIndex(Math.min(c,d));a.rowIndex(Math.min(e,f));b.cellIndex(Math.max(c,d));b.rowIndex(Math.max(e,f))}};$.extend($.ui.wijgrid,{flatView:function(a){var b=null,c=null;this.element=a.element;this.initialize=function(){b=null;c=null;this._createLayout()};this._createLayout=function(){var c=a.options,b=this.element.find(".ui-wijgrid-flatview")[0];b!=null&&b.parentNode.removeChild(b);b=this.element.find(".ui-wijgrid-fixedview")[0];b!=null&&b.parentNode.removeChild(b);c.scrollMode!=="none"&&this.element.wrapInner('<div class="ui-wijgrid-fixedview"><div class="ui-wijgrid-split-area ui-wijgrid-split-area-se ui-wijgrid-content-area"></div></div>')};this.updateSplits=function(){var d=this,a=d._getMappedScrollMode(),e=this.element.find(".ui-wijgrid-content-area");e.width(this.element.width()).height(this.element.height());if(a.hScrollBarVisibility==="visible"||a.hScrollBarVisibility==="auto"){var f=b.colTags(),c=$(b.element());c.css("tableLayout","");$.each(f,function(e,c){if(c.width===""){var b=d.getHeaderCell(e);if(b){var a=b.offsetWidth;if(a){c.width=a;b.width=a+"px"}}}});var g=0;$.each(f,function(b,a){if(a.width)g+=parseInt(a.width)});c.css("width",g);c.css("tableLayout","fixed")}var a=d._getMappedScrollMode();e.wijsuperpanel({vScroller:{scrollBarVisibility:a.vScrollBarVisibility},hScroller:{scrollBarVisibility:a.hScrollBarVisibility},allowResize:false,scrolling:jQuery.proxy(this._onScrolling,this),scrolled:jQuery.proxy(this._onScrolled,this)});return};this._getMappedScrollMode=function(){var c=a.options.scrollMode,b=hScrollBarVisibility="auto";switch(c){case"horizontal":b="hidden";hScrollBarVisibility="visible";break;case"vertical":b="visible";hScrollBarVisibility="hidden";break;case"both":b="visible";hScrollBarVisibility="visible"}return{vScrollBarVisibility:b,hScrollBarVisibility:hScrollBarVisibility}};this.refreshPanel=function(){var b=this.element.find(".ui-wijgrid-content-area"),a=this._getMappedScrollMode();b.wijsuperpanel({vScroller:{scrollBarVisibility:a.vScrollBarVisibility},hScroller:{scrollBarVisibility:a.hScrollBarVisibility}});b.wijsuperpanel("paintPanel")};this.updateSplitAreaBounds=function(){var b=a.options,d=b.width||this.element.width(),c=b.height||this.element.height();if(c<=0)c=this.element.find(".ui-wijgrid-split-area-se .ui-wijgrid-table:first")[0].offsetHeight;var f=17,e=17;this.element.height(c);this.element.width(d);this.element.find(".ui-wijgrid-split-area-se").height(c-b.splitDistanceY).css("top",b.splitDistanceY);this.element.find(".ui-wijgrid-split-area-se").width(d-b.splitDistanceX).css("left",b.splitDistanceX)};this._onSplitContentScrollNW=function(){this.element.find(".ui-wijgrid-split-area-sw")[0].scrollLeft=this.element.find(".ui-wijgrid-split-area-nw")[0].scrollLeft;this.element.find(".ui-wijgrid-split-area-ne")[0].scrollTop=this.element.find(".ui-wijgrid-split-area-nw")[0].scrollTop};this._onSplitContentScrollNE=function(){this.element.find(".ui-wijgrid-split-area-se")[0].scrollLeft=this.element.find(".ui-wijgrid-split-area-ne")[0].scrollLeft;this.element.find(".ui-wijgrid-split-area-nw")[0].scrollTop=this.element.find(".ui-wijgrid-split-area-ne")[0].scrollTop};this._onSplitContentScrollSW=function(){this.element.find(".ui-wijgrid-split-area-nw")[0].scrollLeft=this.element.find(".ui-wijgrid-split-area-sw")[0].scrollLeft;this.element.find(".ui-wijgrid-split-area-se")[0].scrollTop=this.element.find(".ui-wijgrid-split-area-sw")[0].scrollTop};this._onSplitContentScrollSE=function(){this.element.find(".ui-wijgrid-split-area-ne")[0].scrollLeft=this.element.find(".ui-wijgrid-split-area-se")[0].scrollLeft;this.element.find(".ui-wijgrid-split-area-sw")[0].scrollTop=this.element.find(".ui-wijgrid-split-area-se")[0].scrollTop};this.render=function(){var B=document.createDocumentFragment(),k=a._field("visibleLeaves"),p=B.appendChild(document.createElement("table")),q=null,o=a._field("spanTable");if(o&&o.length){q=p.createTHead();for(var H=o[0].length,j=0,F=o.length;j<F;j++){var h=q.insertRow(-1);h.className="ui-wijgrid-headerrow";for(var I=0,i=0;i<H;i++){var f=o[j][i];if(f.column&&(f.column.visible||f.column.visible===undefined)){f.column.thX=I++;f.column.thY=j;var e=document.createElement("th");if(i===0&&a.options.showRowHeader)e.className="ui-state-default ui-wijgrid-rowheader";if(f.colSpan>1)e.colSpan=f.colSpan;if(f.rowSpan>1)e.rowSpan=f.rowSpan;e.innerHTML=f.column.headerText?f.column.headerText:"&nbsp;";h.appendChild(e)}}}}if(a.options.showFilter){if(!q)q=p.createTHead();for(var s="",n=0,A=k.length;n<A;n++){var g=k[n];if(g.dataIndex>=0&&!g.isBand&&g.showFilter)s+='<td><div class="ui-wijgrid-filter ui-widget ui-state-default ui-corner-all"><span class="ui-wijgrid-filtericon"></span><input type="text" class="ui-wijgrid-filter-input" style="width:1px" /><a class="ui-wijgrid-filter-trigger ui-corner-right ui-state-default" href="#"><span class="ui-icon ui-icon-triangle-1-s"></span></a></div></td>';else s+="<td>&nbsp;</td>"}$(q).append('<tr class="ui-wijgrid-filterrow">'+s+"</tr>")}for(var v=document.createElement("colgroup"),n=0,A=k.length;n<A;n++){var z=document.createElement("col"),g=k[n];if(g.width)z.width=g.width;v.appendChild(z)}p.appendChild(v);for(var y=a.dataTable,x=p.appendChild(document.createElement("tbody")),r=0,j=0,G=y.length;j<G;j++){var c=y[j],C=c.length,h=x.insertRow(-1),m="ui-wijgrid-row ui-widget-content";switch(c.rowType){case"data":m+=" ui-wijgrid-datarow";h.setAttribute("dataRowIndex",r);if(r%2!==0)m+=" ui-wijgrid-alternatingrow";r++;break;case"groupHeader":m+=" ui-wijgrid-groupheaderrow";break;case"groupFooter":m+=" ui-wijgrid-groupfooterrow"}if(m)h.className=m;if(c.display)h.style.display="none";if(c.id)h.id=c.id;for(var i=0,E=k.length;i<E;i++){var g=k[i],D=g.dataIndex,b=0,w=false,u=false;switch(c.rowType){case"data":u=true;b=D;if(b>=0&&(!c[b]||c[b].visible===false))continue;break;case"groupHeader":case"groupFooter":b=i;if(b>=C)w=true}if(w)break;var e=document.createElement("td"),l=undefined;if(b>=0)if(u&&g.dataParser){var t=c[b].value;e.className="wijdata-type-"+(g.dataType||"string");if(g.dataType==="boolean")l=t?'<input type="checkbox" checked="checked" disabled="disabled" />':'<input type="checkbox" disabled="disabled" />';else l=a._toStr(g,t)}else l=c[b].html;if(!l)l="&nbsp;";if(i===0&&a.options.showRowHeader)e.className+=" ui-wijgrid-rowheader";e.className+=" wijgridtd";e.innerHTML=l;if(b>=0){if(c[b].rowSpan>1)e.rowSpan=c[b].rowSpan;if(c[b].colSpan>1)e.colSpan=c[b].colSpan;if(c[b].paddingLeft)e.style.paddingLeft=c[b].paddingLeft}h.appendChild(e)}!h.cells.length&&x.removeChild(h)}d(p)};this.attachEvents=function(){};this.subTables=function(){return[b]};this.focusableElement=function(){return b.element()};this.forEachRowCell=function(c,a,d){return b.forEachRowCell(c,a,d)};this.forEachColumnCell=function(c,a,d){return b.forEachColumnCell(c,a,d)};this.ensureWidth=function(i){if(a.options.scrollMode!=="none"){if(a.options.scrollMode==="vertical")return;var h=$(b.element());h.css({width:""});var f=0;$.each(b.colTags(),function(b,a){if(a.width)f+=parseInt(a.width)});f&&h.width(f);c.wijsuperpanel("paintPanel")}else{var g=a.element.width(),e=$(b.element()).width(),d=e<=g?e:Math.max(g,e);if(!d)d=0;d+=i;if(d<0)d=0;a.element.width(d)}};this.getCell=function(e,a){var c=b.getCellIdx(e,a);if(c>=0){var d=this.getJoinedRows(a,0);if(d[0])return d[0].cells[c]}return null};this.getAbsoluteRowIndex=function(a){return a.rowIndex};this.getJoinedCols=function(c){var a=$(b.element()).find("> colgroup");if(a.length)if(c<a[0].childNodes.length)return[a[0].childNodes[c],null];return[null,null]};this.getJoinedRows=function(a,c){return[b.getSectionRow(a,c),null]};this.getJoinedTables=function(c,a){return[b,null,a]};this.getHeaderCell=function(d){var c=a._field("visibleLeaves")[d],b=a._headerRows();return b?(new $.ui.wijgrid.rowAccessor).getCell(b.item(c.thY),c.thX):null};this.getAbsCellInfo=function(a){return new $.ui.wijgrid.cellInfo(b.getColumnIdx(a),a.parentNode.rowIndex)};this.getVisibleAreaBounds=function(){var c=$.ui.wijgrid.bounds(b.element());if(a.options.scrollMode==="none")return c;else{var d=$.ui.wijgrid.bounds(this.element.find(".ui-wijgrid-split-area-se:first")[0]);return{top:c.top,left:c.left,width:Math.min(d.width,c.width),height:Math.min(d.height,c.height)}}};var d=function(e){var d=$(e);d.addClass("ui-wijgrid-table").find("> tbody").addClass("ui-widget-content ui-wijgrid-data");if(a.options.scrollMode!=="none"){c=a.element.find(".ui-wijgrid-content-area").empty();d.appendTo(c)}else{a.element.find(" > :not(.ui-wijpager)").remove();if(a.$topPagerDiv)a.$topPagerDiv.after(d);else a.element.prepend(d)}b=new $.ui.wijgrid.htmlTableAccessor(e)}}});$.ui.wijgrid.selection=function(a){var f=0,j,d=new $.ui.wijgrid.cellInfoOrderedCollection(a),b=new $.ui.wijgrid.cellInfoOrderedCollection(a),c=new $.ui.wijgrid.cellInfoOrderedCollection(a),e=new $.ui.wijgrid.cellInfoOrderedCollection(a),h=null,i=null;this.selectedCells=function(){return c};this.addRange=function(b,e,d,f){if(!b&&arguments.length==1)throw"invalid argument";var c=arguments.length===4?new $.ui.wijgrid.cellInfoRange(new $.ui.wijgrid.cellInfo(b,e),new $.ui.wijgrid.cellInfo(d,f)):b._clone();c._normalize();if(!c._isValid())throw"invalid argument";this.beginUpdate();this._startNewTransaction(a._field("currency"));this._selectRange(c,false,true,0,null);this.endUpdate()};this.clear=function(){this.beginUpdate();b._clear();b._addFrom(c);this.endUpdate()};this.selectAll=function(){this.beginUpdate();this._selectRange(a._getDataCellsRange(),false,false,0,null);this.endUpdate()};this.beginUpdate=function(){f++};this.endUpdate=function(){if(f>0){f--;if(f===0){k();if(d.length()||b.length()){h!=null&&h.UnderlyingDataChanged();i!=null&&i.UnderlyingDataChanged();a._trigger("selectionchanged",null,{addedCells:d,removedCells:b})}d=new $.ui.wijgrid.cellInfoOrderedCollection(a);b._clear()}}};this._multipleRangesAllowed=function(){var b=a.options.selectionMode;return b&&((b=b.toLowerCase())==="multicolumn"||b==="multirow"||b==="multirange")};this._anchorCell=function(){return j};this._startNewTransaction=function(b){if(b){j=b._clone();e=new $.ui.wijgrid.cellInfoOrderedCollection(a)}};this._clearRange=function(h,m){var f=a.options.selectionMode.toLowerCase();if(h._isValid()&&f!=="none"&&c.length()>0){var d=h._clone();d._normalize();d._clip(a._getDataCellsRange());if(!h._isValid())return;d=g(d,f,m,null);this.beginUpdate();switch(f){case"singlecell":d._containsCellInfo(c.item(0))&&this.clear();break;case"singlecolumn":case"singlerow":case"singlerange":for(var o=d.bottomRight().rowIndex(),n=d.bottomRight().cellIndex(),e=false,j=d.topLeft().rowIndex();!e&&j<=o;j++)for(var i=d.topLeft().cellIndex();!e&&i<=n;i++){e=c.indexOf(i,j)>=0;e&&this.clear()}break;case"multicolumn":case"multirow":case"multirange":for(var p=c.length(),k=0;k<p;k++){var l=c.item(k);d._containsCellInfo(l)&&b._add(l)}}this.endUpdate()}};this._selectRange=function(h,k,f,i,j){var d=a.options.selectionMode.toLowerCase();if(d!=="none"&&h._isValid()){var c=h._clone();c._normalize();c._clip(a._getDataCellsRange());if(!c._isValid())return;this.beginUpdate();if(!this._multipleRangesAllowed())this.clear();else if(k||f){if(f){b._clear();b._addFrom(e)}}else this.clear();c=g(c,d,i,j);l(c,true);this.endUpdate()}};function g(b,f,e,c){var d=a._getDataCellsRange();switch(f){case"singlecell":b=c===null?new $.ui.wijgrid.cellInfoRange(b.topLeft(),b.topLeft()):new $.ui.wijgrid.cellInfoRange(c,c);break;case"singlecolumn":b=c===null?new $.ui.wijgrid.cellInfoRange(b.topLeft(),b.topLeft()):new $.ui.wijgrid.cellInfoRange(c,c);b._extend(1,d);break;case"singlerow":b=c===null?new $.ui.wijgrid.cellInfoRange(b.topLeft(),b.topLeft()):new $.ui.wijgrid.cellInfoRange(c,c);b._extend(2,d);break;case"singlerange":b._extend(e,d);break;case"multicolumn":b._extend(1,d);break;case"multirow":b._extend(2,d);break;case"multirange":b._extend(e,d)}return b}function k(){for(var l=a._getDataToAbsOffset(),j=l.x,k=l.y,n=a._field("view"),h=b.length(),g=0;g<h;g++){var f=b.item(g);if(d.indexOf(f)<0){var i=n.getCell(f.cellIndex()+j,f.rowIndex()+k);i&&$(i).removeClass("ui-state-highlight");c._remove(f);e._remove(f)}else{b._removeAt(g);g--;h--}}h=d.length();for(var g=0;g<h;g++){var f=d.item(g),m=c.indexOf(f);if(m<0){var i=n.getCell(f.cellIndex()+j,f.rowIndex()+k);i&&$(i).addClass("ui-state-highlight");c._insertUnsafe(f,~m);e._add(f)}else{d._removeAt(g);g--;h--}}}function l(e,l){var h=e.topLeft().cellIndex(),j=e.topLeft().rowIndex(),i=e.bottomRight().cellIndex(),k=e.bottomRight().rowIndex();if(l)for(var g=d.length(),c=j;c<=k;c++)for(var a=h;a<=i;a++){var f=new $.ui.wijgrid.cellInfo(a,c);if(g===0)d._appendUnsafe(f);else d._add(f)}else for(var g=b.length(),c=j;c<=k;c++)for(var a=h;a<=i;a++){var f=new $.ui.wijgrid.cellInfo(a,c);if(g===0)b._appendUnsafe(f);else b._add(f)}}};$.ui.wijgrid.cellInfoOrderedCollection=function(b){if(!b)throw"argument is null";var a=[];this.item=function(b){return a[b]};this.length=function(){return a.length};this.indexOf=function(c,g){if(arguments.length===1){g=c.rowIndex();c=c.cellIndex()}var b=0,f=a.length-1;while(b<=f){var e=b+(f-b>>1),h=a[e],d=h.rowIndex()-g;if(d===0)d=h.cellIndex()-c;if(d<0)b=e+1;else if(d>0)f=e-1;else return e}return~b};this.toString=function(){for(var c="",b=0,d=a.length;b<d;b++)c+=a[b].toString()+"\n";return c};this._add=function(c){var d=this.indexOf(c);if(d<0){a.splice(~d,0,c);c._setGridView(b);return true}return false};this._addFrom=function(d){if(d){var e=d.length(),f=a.length;if(f===0){a.length=e;for(var c=0;c<e;c++){a[c]=d.item(c);a[c]._setGridView(b)}}else for(var c=0;c<e;c++)this._add(d.item(c))}};this._appendUnsafe=function(c){a[a.length]=c;c._setGridView(b)};this._insertUnsafe=function(c,b){a.splice(b,0,c)};this._clear=function(){a.length=0};this._remove=function(c){var b=this.indexOf(c);if(b>=0){a.splice(b,1);return true}return false};this._removeAt=function(b){a.splice(b,1)};this._getColumnsIndicies=function(){var e=[],c=a.length;if(c){for(var d=[],b=0;b<c;b++)d[a[b].cellIndex()]=1;c=d.length;for(var f=0,b=0;b<c;b++)if(d[b])e[f++]=b}return e};this._getSelectedRowsIndicies=function(){var e=[],c=a.length;if(c){for(var d=[],b=0;b<c;b++)d[a[b].rowIndex()]=1;c=d.length;for(var f=0,b=0;b<c;b++)if(d[b])e[f++]=b}return e};this._rectangulate=function(){var h=a.length;if(h){for(var c=4294967295,e=4294967295,d=0,f=0,g=0;g<h;g++){var b=a[g];c=Math.min(c,b.cellIndex());e=Math.min(e,b.rowIndex());d=Math.max(d,b.cellIndex());f=Math.Max(f,b.rowIndex())}return new $.ui.wijgrid.cellInfoRange(new $.ui.wijgrid.cellInfo(c,e),new $.ui.wijgrid.cellInfo(d,f))}return null}};$.extend($.ui.wijgrid,{selectionui:function(a){var p=10,s="{0}."+a.widgetName+".selectionui",b=new $.ui.wijgrid.cellInfoOrderedCollection(a),j,d,f,c,g=false,i=false,h=a._field("view"),r=a._field("visibleLeaves").length;a.element.bind(e("mousedown"),o);this.dispose=function(){a.element.unbind(e("mousedown"),o);k()};function o(c){if(!a._canInteract()||a.options.selectionMode.toLowerCase()==="none")return;var b=h.getVisibleAreaBounds(),e={x:c.pageX,y:c.pageY},f=c.target&&c.target.tagName!==undefined?c.target.tagName.toLowerCase():undefined,g=$(c.target);if((!f||(f==="td"||f==="th")&&g.hasClass("wijgridtd")||f==="div"&&g.hasClass("wijgriddiv"))&&(e.x>b.left&&e.x<b.left+b.width)&&(e.y>b.top&&e.y<b.top+b.height)){q();j=e;d=l(j)}}function m(v){if(!d||!d._isValid())return;var o={x:v.pageX,y:v.pageY};if(!g)g=Math.abs(j.x-o.x)>p||Math.abs(j.y-o.y)>p;if(g){var w=l(o);if(!w._isValid())return;f=w;var e=new $.ui.wijgrid.cellInfoRange(d,f);e._normalize();e._clip(a._getDataCellsRange());if(e._isValid()&&!e.isEqual(c)){var n=a._getDataToAbsOffset();c=e;for(var m=new $.ui.wijgrid.cellInfoOrderedCollection(a),y=e.bottomRight().rowIndex(),x=e.bottomRight().cellIndex(),s=e.topLeft().rowIndex();s<=y;s++)for(var q=e.topLeft().cellIndex();q<=x;q++)m._appendUnsafe(new $.ui.wijgrid.cellInfo(q,s));for(var k=0,r=b.length();k<r;k++){var i=b.item(k);if(m.indexOf(i)<0){if(a.selection().selectedCells().indexOf(i)<0){var t=h.getCell(i.cellIndex()+n.x,i.rowIndex()+n.y);t&&$(t).removeClass("ui-state-highlight")}b._removeAt(k);k--;r--}}for(var k=0,r=m.length();k<r;k++){var i=m.item(k);if(b.indexOf(i)<0&&a.selection().selectedCells().indexOf(i)<0)if(b._add(i)){var u=h.getCell(i.cellIndex()+n.x,i.rowIndex()+n.y);u&&$(u).addClass("ui-state-highlight")}}}}}function n(e){k();if(g){g=false;if(c&&c._isValid()){a._changeCurrency(f);(!e.shiftKey||!a.selection()._multipleRangesAllowed()&&a.options.selectionMode.toLowerCase()!=="singleRange")&&a.selection()._startNewTransaction(d);a.selection().beginUpdate();a.selection()._selectRange(c,e.shiftKey,e.ctrlKey,0,f);a.selection().endUpdate();for(var m=a._field("view"),j=a._getDataToAbsOffset(),i=0,n=b.length();i<n;i++){var h=b.item(i);if(a.selection().selectedCells().indexOf(h)<0){var l=m.getCell(h.cellIndex()+j.x,h.rowIndex()+j.y);l!=null&&$(l).removeClass("ui-state-highlight")}}b._clear();d=f=c=null;return false}}}function q(){if(!i)try{a.element.disableSelection();a.element.css({MozUserSelect:"none",WebkitUserSelect:"none"});$(document).bind(e("mousemove"),m).bind(e("mouseup"),n)}finally{i=true}}function k(){if(i)try{a.element.enableSelection();a.element.css({MozUserSelect:"",WebkitUserSelect:""});$(document).unbind(e("mousemove"),m).unbind(e("mouseup"),n)}finally{i=false}}function e(a){return $.ui.wijgrid.stringFormat(s,a)}function l(f){var c=0,e=r-1,b=0,i=-1;while(c<=e){b=(e-c>>1)+c;var d=$.ui.wijgrid.bounds(h.getHeaderCell(b));if(f.x<d.left)e=b-1;else if(f.x>d.left+d.width)c=b+1;else{i=b;break}}if(i===-1)return $.ui.wijgrid.cellInfo.prototype.outsideValue;var g=new $.ui.wijgrid.rowAccessor(h,0,0,0),j=-1,c=0,e=g.length()-1,b=0;while(c<=e){b=(e-c>>1)+c;var m=g.item(b),d=$.ui.wijgrid.bounds(g.getCell(m,0));if(f.y<d.top)e=b-1;else if(f.y>d.top+d.height)c=b+1;else{j=b;break}}if(j==-1)return $.ui.wijgrid.cellInfo.prototype.outsideValue;var k=a._getDataToAbsOffset(),l=new $.ui.wijgrid.cellInfo(i-k.x,j-k.y);l._clip(a._getDataCellsRange());return l}}});$.ui.wijgrid.rowAccessor=function(d,c,a,b){if(!a)a=0;if(!b)b=0;this.item=function(b){var e=this.length();return b<e?d.getJoinedRows(b+a,c):null};this.length=function(){var g=d.getJoinedTables(true,0),e=0,f;if(f=g[0])e=f.getSectionLength(c);if(f=g[1])e+=f.getSectionLength(c);e-=a+b;if(e<0)e=0;return e};this.iterateCells=function(b,e,i){if(b&&e)for(var f=0,c=0,j=b.length;c<j;c++){var a=b[c];if(a)for(var d=0,g=a.cells.length;d<g;d++){var h=e(a.cells[d],f++,i);if(h!==true)return}}};this.getCell=function(d,b){var a;if(a=d[0]){var c=a.cells.length;if(b<c)return a.cells[b];b-=c;if(a=d[1]){c=a.cells.length;if(b<c)return a.cells[b]}}return null};this.cellsCount=function(c){var b=0,a;if(a=c[0]){b=a.cells.Length;if(a=c[1])b+=a.cells.Length}return b}};$.extend($.ui.wijgrid,{cellEditorHelper:function(){this.currencyEditStart=function(e,h){var d=false,a=e.currency();if(a._isValid()&&!a._isEdit()&&a._column().dataIndex>=0){var c=a._row();if(c&&c.length){var g=c[0].attributes.dataRowIndex!==undefined?parseInt(c[0].attributes.dataRowIndex.value):undefined;if(g!==undefined){var f={cell:a,event:h,handled:false};if(d=e._trigger("beforecelledit",null,f))if(!f.handled)d=b(e,f);if(d){a._isEdit(true);if(e.options.showRowHeader){$(c[0].cells[0]).empty();$(c[0].cells[0]).append($("<div>&nbsp;</div>").addClass("ui-icon ui-icon-pencil"))}}}}}return d};this.currencyEditEnd=function(e,i){var a=e.currency();if(!a._isValid()||!a._isEdit())return;var f=false,h=a._row();if(h&&h.length){var o=h[0].attributes.dataRowIndex!==undefined?parseInt(h[0].attributes.dataRowIndex.value):undefined;if(o===undefined)return f;var n=i&&i.which===$.ui.keyCode.ESCAPE;if(!i||!n){var b={cell:a,value:undefined};if(f=e._trigger("beforecellupdate",null,b)){if(b.value===undefined)b.value=d(e,a);var j=false;if(b.cell._column().dataType==="datetime"){var p=b.value?b.value.getTime():null,q=a.value()?a.value().getTime():null;j=p!==q}else j=b.value!==a.value();if(j){var g=a._column(),l=e._parse(g,b.value);if(l===null&&g.valueRequired||g.dataType&&g.dataType!=="string"&&isNaN(l)){e._trigger("invalidcellvalue",null,{cell:a,value:b.value});f=false}else{var m=a.cellIndex(),k=e.dataTable[a.rowIndex()];k[m].value=b.value;e._dataStore.updateValue(k[m].originalRowIndex,g.dataKey,b.value);e._trigger("aftercellupdate",null,{cell:a})}}}}else f=true;if(f){var b={cell:a,event:i,handled:false};e._trigger("aftercelledit",null,b);if(!b.handled)f=c(e,b);f&&a._isEdit(false);e.options.showRowHeader&&$(h[0].cells[0]).html("&nbsp;");e.element.focus();$(e._field("view").focusableElement()).focus();a.tableCell().focus()}}return f};function b(h,c){var i=c.cell._column();if(i.dataIndex>=0){var g=c.cell.value(),j=true;try{var f=c.cell.tableCell();if(i.dataType==="boolean"){var d=document.createElement("input");d.type="checkbox";d.className="wijgridinput ui-wijinput ui-state-focus";$(d).bind("keydown",h,a);f.innerHTML="";f.appendChild(d);d.focus();d.checked=g}else{var b=document.createElement("input");b.type="text";b.className="wijgridinput ui-wijinput ui-state-focus";$(b).bind("keydown",h,a);if(c.event&&c.event.type==="keypress"&&c.event.which)b.value=String.fromCharCode(c.event.which);else switch(c.cell._column().dataType){case"currency":case"number":if(g!==null){b.value=g;break}default:var l=h._toStr(c.cell._column(),g);b.value=l}f.innerHTML="";f.appendChild(b);var k=b.value.length;(new $.ui.wijgrid.domSelection(b)).setSelection({start:k,end:k});b.focus();if($.browser.mozilla&&document.createEvent&&b.dispatchEvent){var e=document.createEvent("KeyboardEvent");e.initKeyEvent("keypress",false,true,null,false,false,false,false,0,$.ui.keyCode.SPACE);b.dispatchEvent(e);e=document.createEvent("KeyboardEvent");e.initKeyEvent("keypress",false,true,null,false,false,false,false,$.ui.keyCode.BACKSPACE,0);b.dispatchEvent(e)}}}catch(m){alert(m.message);j=false}return j}return false}function c(g,b){var d=b.cell._column();if(d.dataIndex>=0){var e=true;try{var c=b.cell.tableCell();if(d.dataType==="boolean"){var a=document.createElement("input");a.type="checkbox";c.innerHTML="";c.appendChild(a);a.checked=b.cell.value();a.disabled=true}else{var f=g._toStr(d,b.cell.value());$(c).html(f)}}catch(h){alert("defaultAfterCellEdit: "+h.message);e=false}return e}return false}function a(a){if(a.which===$.ui.keyCode.ENTER){var b=a.data;if(b){b._endEditInternal(a);return false}}}function d(d,c){var a=$(c.tableCell()).find(":input:first");if(a.length){var b=a.attr("type")==="checkbox"?a[0].checked:a.val();b=d._parse(c._column(),b);return b}return null}}});$.extend($.ui.wijgrid,{fixedView:function(a){var g,b={},e,c,f,d;this.element=a.element;this.initialize=function(){g=a.dataTable.length;this._createLayout()};this._createLayout=function(){var a=this.element.find(".ui-wijgrid-flatview")[0];a!=null&&a.parentNode.removeChild(a);a=this.element.find(".ui-wijgrid-fixedview")[0];a!=null&&a.parentNode.removeChild(a);this.element.wrapInner('<div class="ui-wijgrid-fixedview"><div class="ui-wijgrid-scroller"><div class="ui-wijgrid-split-area-se ui-wijgrid-content-area"></div></div></div>');var b=this.element.find(".ui-wijgrid-scroller");b.after('<div class="ui-wijgrid-split-area ui-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>');b.after('<div class="ui-wijgrid-split-area ui-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>');b.after('<div class="ui-wijgrid-split-area ui-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')};this._onScrolled=function(){this.element.find(".ui-wijgrid-split-area-ne")[0].scrollLeft=parseInt((this.element.find(".ui-wijsuperpanel-templateouterwrapper").css("left")+"").replace("px",""))*-1};this._onScrolling=function(b,a){if(a.dir=="h")this.element.find(".ui-wijgrid-split-area-ne")[0].scrollLeft=parseInt((this.element.find(".ui-wijsuperpanel-templateouterwrapper").css("left")+"").replace("px",""))*-1;else this.element.find(".ui-wijgrid-split-area-sw")[0].scrollTop=parseInt((this.element.find(".ui-wijsuperpanel-templateouterwrapper").css("top")+"").replace("px","")*-1)};this.updateSplits=function(){var b=a.options;if(b.splits)this.element.addClass("ui-wijgrid-splits-enabled");else this.element.removeClass("ui-wijgrid-splits-enabled");var q=this.element.find(".ui-wijgrid-content-area table");if(!b.splits)try{if(b.staticRowIndex>=0)b.splitDistanceY=this.element.find(".ui-wijgrid-split-area-ne table")[0].offsetHeight;else b.splitDistanceY=0;if(a._staticColumnIndex>=0)b.splitDistanceX=this.element.find(".ui-wijgrid-split-area-nw table")[0].offsetWidth;else b.splitDistanceX=0}catch(r){}this._updateSplitAreaBounds();var e=this,n=e.element.find(".ui-wijgrid-scroller"),h=e._getMappedScrollMode(),o=$(c.element()).attr("cellpadding","0").attr("cellspacing","0").css("border-collapse","separate"),g=$(d.element()).attr("cellpadding","0").attr("cellspacing","0").css("border-collapse","separate"),k=a._field("visibleLeaves"),p=c.colTags(),l=d.colTags(),f=g.find(".ui-wijgrid-row:not(.ui-wijgrid-groupheaderrow):first"),m=f.find("td"),i=false;if(!f.is(":visible")){f.show();i=true}var j=[];$.each(k,function(a){var b=e.getHeaderCell(a);j.push(b)});$.each(j,function(b,c){var d=m[b],a=0;if(d!=undefined){a=Math.max(c.offsetWidth,d.offsetWidth);$(d).setOutWidth(a)}else a=c.offsetWidth;$(c).setOutWidth(a);p[b].width=l[b].width=a});i&&f.hide();e._ensureWidth();o.css("tableLayout","fixed");g.css("tableLayout","fixed");n.wijsuperpanel({vScroller:{scrollBarVisibility:h.vScrollBarVisibility},hScroller:{scrollBarVisibility:h.hScrollBarVisibility},allowResize:false,scrolled:jQuery.proxy(this._onScrolled,this)})};this._getMappedScrollMode=function(){var c=a.options.scrollMode,b=hScrollBarVisibility="auto";switch(c){case"horizontal":b="hidden";hScrollBarVisibility="visible";break;case"vertical":b="visible";hScrollBarVisibility="hidden";break;case"both":b="visible";hScrollBarVisibility="visible"}return{vScrollBarVisibility:b,hScrollBarVisibility:hScrollBarVisibility}};this.refreshPanel=function(){var a=this.element.find(".ui-wijgrid-scroller"),b=this._getMappedScrollMode();a.wijsuperpanel({vScroller:{scrollBarVisibility:b.vScrollBarVisibility},hScroller:{scrollBarVisibility:b.hScrollBarVisibility}});a.wijsuperpanel("paintPanel");this._ensureNEContainerWidth(a)};this._updateSplitAreaBounds=function(){var b=a.options,d=b.width||this.element.width(),c=b.height||this.element.height();if(c<=0)c=this.element.find(".ui-wijgrid-split-area-se > table")[0].offsetHeight;var e=18,f=18;this.element.height(c);this.element.width(d);this.element.find(".ui-wijgrid-scroller").height(c);this.element.find(".ui-wijgrid-scroller").width(d);this.element.find(".ui-wijgrid-split-area-nw").height(b.splitDistanceY);this.element.find(".ui-wijgrid-split-area-ne").height(b.splitDistanceY);this.element.find(".ui-wijgrid-split-area-sw").height(c-b.splitDistanceY).css("top",b.splitDistanceY);this.element.find(".ui-wijgrid-split-area-nw").width(b.splitDistanceX);this.element.find(".ui-wijgrid-split-area-sw").width(b.splitDistanceX);this.element.find(".ui-wijgrid-split-area-ne").width(d-b.splitDistanceX-(!b.splits?e:0)).css("left",b.splitDistanceX);this.element.find(".ui-wijgrid-split-area-se").css("marginLeft",b.splitDistanceX);this.element.find(".ui-wijgrid-split-area-se").css("marginTop",b.splitDistanceY)};this.render=function(){var n=a._field("visibleLeaves"),w=document.createDocumentFragment();b.nw=w.appendChild(document.createElement("table"));b.ne=w.appendChild(document.createElement("table"));b.sw=w.appendChild(document.createElement("table"));b.se=w.appendChild(document.createElement("table"));var M=a._getRealStaticRowIndex(),r=a._staticColumnIndex,p={},t=a._field("spanTable");if(t&&t.length){p.nw=b.nw.createTHead();p.ne=b.ne.createTHead();for(var S=t[0].length,o=0,Q=t.length;o<Q;o++){var i=null,g=null;i=p.nw.insertRow(-1);g=p.ne.insertRow(-1);i.className="ui-wijgrid-headerrow";g.className="ui-wijgrid-headerrow";for(var T=0,m=0;m<S;m++){var l=t[o][m];if(l.column&&(l.column.visible||l.column.visible===undefined)){l.column.thX=T++;l.column.thY=o;var e=document.createElement("th");if(m===0&&a.options.showRowHeader)e.className="ui-state-default ui-wijgrid-rowheader";if(l.colSpan>1)e.colSpan=l.colSpan;if(l.rowSpan>1)e.rowSpan=l.rowSpan;e.innerHTML=l.column.headerText?l.column.headerText:"&nbsp;";if(m<=r)i.appendChild(e);else g.appendChild(e)}}}}if(a.options.showFilter){if(p.nw){for(var z="",j=0,L=n.length;j<L&&j<=r;j++){var f=n[j];z+=f.dataIndex>=0&&!f.isBand&&f.showFilter?'<td><div class="ui-wijgrid-filter ui-widget ui-state-default ui-corner-all"><span class="ui-wijgrid-filtericon"></span><input type="text" class="ui-wijgrid-filter-input" style="width:1px" /><a class="ui-wijgrid-filter-trigger ui-corner-right ui-state-default" href="#"><span class="ui-icon ui-icon-triangle-1-s"></span></a></div></td>':"<td>&nbsp;</td>"}$(p.nw).append('<tr class="ui-wijgrid-filterrow ui-widget-content">'+z+"</tr>")}if(p.ne){for(var z="",j=r+1,L=n.length;j<L;j++){var f=n[j];z+=f.dataIndex>=0&&!f.isBand&&f.showFilter?'<td><table cellpadding="0" cellspacing="0" border="0"><tr><td class="filterOp" /><td class="filterEditor"/><td>&nbsp;</td><td class="filterBtn ui-state-default ui-corner-all"><div class="ui-icon ui-icon-triangle-1-s" >rollout</div></td></tr></table></td>':"<td>&nbsp;</td>"}$(p.ne).append('<tr class="ui-wijgrid-filterrow ui-widget-content">'+z+"</tr>")}}var u={t0:b.nw,t1:b.sw};for(var K in u){for(var x=document.createElement("colgroup"),j=0;j<=r;j++){var y=document.createElement("col"),f=n[j];if(f.width)y.width=f.width;x.appendChild(y)}var I=u[K];I.appendChild(x)}u={t0:b.ne,t1:b.se};for(var K in u){for(var x=document.createElement("colgroup"),j=r+1;j<n.length;j++){var y=document.createElement("col"),f=n[j];if(f.width)y.width=f.width;x.appendChild(y)}var I=u[K];I.appendChild(x)}var J=a.dataTable,k={};k.nw=b.nw.appendChild(document.createElement("tbody"));k.ne=b.ne.appendChild(document.createElement("tbody"));k.sw=b.sw.appendChild(document.createElement("tbody"));k.se=b.se.appendChild(document.createElement("tbody"));for(var v=0,A=M-(t.length+(a.options.showFilter?1:0)),o=0,R=J.length;o<R;o++){var c=J[o],N=c.length,i=null,g=null;if(o<=A){i=k.nw.insertRow(-1);g=k.ne.insertRow(-1)}else{i=k.sw.insertRow(-1);g=k.se.insertRow(-1)}var q="ui-wijgrid-row ui-widget-content";switch(c.rowType){case"data":q+=" ui-wijgrid-datarow";i.setAttribute("dataRowIndex",v);g.setAttribute("dataRowIndex",v);if(v%2!==0)q+=" ui-wijgrid-alternatingrow";v++;break;case"groupHeader":q+=" ui-wijgrid-groupheaderrow";break;case"groupFooter":q+=" ui-wijgrid-groupfooterrow"}if(q){i.className=q;g.className=q}if(c.display){i.style.display="none";g.style.display="none"}if(c.id){i.id=c.id;g.id=c.id}for(var m=0,P=n.length;m<P;m++){var f=n[m],O=f.dataIndex,d=0,D=false,C=false;switch(c.rowType){case"data":C=true;d=O;if(d>=0&&(!c[d]||c[d].visible===false))continue;break;case"groupHeader":case"groupFooter":d=m;if(d>=N)D=true}if(D)break;var e=document.createElement("td"),s=undefined;if(d>=0)if(C&&f.dataParser){var B=c[d].value;e.className="wijdata-type-"+(f.dataType||"string");if(f.dataType==="boolean")s=B?'<input type="checkbox" checked="checked" disabled="disabled" />':'<input type="checkbox" disabled="disabled" />';else s=a._toStr(f,B)}else s=c[d].html;if(!s)s="&nbsp;";if(m===0&&a.options.showRowHeader)e.className+=" ui-wijgrid-rowheader";e.className+=" wijgridtd";e.innerHTML=s;if(d>=0){if(c[d].rowSpan>1)e.rowSpan=c[d].rowSpan;if(c[d].colSpan>1)e.colSpan=c[d].colSpan;if(c[d].paddingLeft)e.style.paddingLeft=c[d].paddingLeft}if(m<=r)i.appendChild(e);else g.appendChild(e)}if(o<=A){!i.cells.length&&k.nw.removeChild(i);!g.cells.length&&k.ne.removeChild(g)}else{!i.cells.length&&k.sw.removeChild(i);!g.cells.length&&k.se.removeChild(g)}}var F=a.element.find(".ui-wijgrid-split-area-nw"),E=a.element.find(".ui-wijgrid-split-area-ne"),H=a.element.find(".ui-wijgrid-split-area-sw"),G=a.element.find(".ui-wijgrid-content-area");F[0].innerHTML="";E[0].innerHTML="";H[0].innerHTML="";G[0].innerHTML="";$(b.nw).appendTo(F);$(b.ne).appendTo(E);$(b.sw).appendTo(H);$(b.se).appendTo(G);h()};this.attachEvents=function(){};this.updateCss=function(){};this.subTables=function(){return[e,c,f,d]};this.focusableElement=function(){return d.element()};this.forEachRowCell=function(h,f,g){var c=this.getJoinedTables(false,h),d=c[0],e=c[1];if(d!=null){var b=c[2];if(b<d.element().rows.length){var a=d.forEachRowCell(b,f,g);if(a!=true)return a}if(e!=null&&b<e.element().rows.length){var a=e.forEachRowCell(b,f,g);if(a!=true)return a}}return true};this.forEachColumnCell=function(f,c,e){var a=this.getJoinedTables(true,f);if(a[0]!=null){var d=a[2],b=a[0].forEachColumnCell(d,c,e);if(b!=true)return b;if(a[1]!=null){b=a[1].forEachColumnCell(d,c,e);if(b!=true)return b}}return true};this.ensureWidth=function(){this._ensureWidth();var a=this.element.find(".ui-wijgrid-scroller");a.wijsuperpanel("paintPanel");this._ensureNEContainerWidth(a)};this._ensureNEContainerWidth=function(e){var c=this.element.find(".ui-wijgrid-split-area-ne"),b=a.options.width||this.element.width(),d=18;this._onScrolled();if(e.data("wijsuperpanel").vNeedScrollBar)c.width(b-d);else c.width(b)};this._ensureWidth=function(){var e=$(c.element()),b=$(d.element()),a=0;$.each(c.colTags(),function(c,b){a+=parseInt(b.width)});e.width(a);b.width(a)};this.getCell=function(d,h){var a=this.getJoinedTables(false,h);if(a[0]!=null){var c=this.getJoinedTables(true,d);if(c[0]!=null){var f=a[2],e=c[2],b=null;if(a[1]!=null)b=d==e?a[0]:a[1];else b=a[0];var g=b.getCellIdx(e,f);if(g>=0)return b.element().rows[f].cells[g]}}return null};this.getColumnIndex=function(j){for(var b=null,b=j.parentNode;b.tagName.toLowerCase()!="table";b=b.parentNode);if(b!=null){var g=null,h=false;if(b==e.element())g=e;else if(b==c.element()){g=c;h=true}else if(b==f.element())g=f;else if(b==d.element()){g=d;h=true}if(g!=null){var i=g.getColumnIdx(j);if(h)i+=a._staticColumnIndex+1;return i}}return-1};this.getAbsoluteRowIndex=function(d){var f=d.rowIndex,b=d.parentNode;while(b.tagName.toLowerCase()!="table")b=b.parentNode;return b==e.element()||b==c.element()?f:f+a._getRealStaticRowIndex()+1};this.getJoinedCols=function(b){var c=[],a=this.getJoinedTables(true,b);a.splice(a.length-1,1);$.each(a,function(d,a){c.push($(a.element()).find("col")[b])});return c};this.getJoinedRows=function(j,k){var l=null,m=null,b=null,i=null,r=a._getRealStaticRowIndex(),h=a._staticColumnIndex,s=a._field("leaves").length-1,t=g-1,q=r==t,n=r<0,p=!q&&!n,o=0;if(q||p){if(h>=0&&h<s){b=e;i=c}else b=h<0?c:e;o=b.getSectionLength(k);if(j<o){l=b.getSectionRow(j,k);if(i!=null)m=i.getSectionRow(j,k)}}if(n||p&&l==null){if(!n)j-=o;if(h>=0&&h<s){b=f;i=d}else b=h<0?d:f;l=b.getSectionRow(j,k);if(i!=null)m=i.getSectionRow(j,k)}return l==null&&m==null?null:[l,m]};this.getJoinedTables=function(m,l){var b=null,h=null,i=l,k=a._getRealStaticRowIndex(),j=a._staticColumnIndex;if(m){if(l<=j){b=e;h=f}else{b=c;h=d;i=i-(j+1)}if(k<0)b=null;if(k==g-1)h=null}else{if(l<=k){b=e;h=c}else{b=f;h=d;i=i-(k+1)}if(j<0)b=null;if(j==a._field("leaves").length-1)h=null}if(b==null){b=h;h=null}return[b,h,i]};this.getHeaderCell=function(d){var c=a._field("visibleLeaves")[d],b=a._headerRows();return b?(new $.ui.wijgrid.rowAccessor).getCell(b.item(c.thY),c.thX):null};this.getAbsCellInfo=function(a){return new $.ui.wijgrid.cellInfo(this.getColumnIndex(a),this.getAbsoluteRowIndex(a.parentNode))};this.getVisibleAreaBounds=function(){return $.ui.wijgrid.bounds(a.element.find(".ui-wijsuperpanel-contentwrapper:first"))};this.adjustCellsSizes=function(){for(var g=new $.ui.wijgrid.rowAccessor(this,9,0),i=g.length(),h=[],a=0;a<i;a++){for(var j=this.getJoinedRows(a,9),c=j[0],m=c!=null?c.cells.length:0,e=false,b=0;b<m&&!e;b++)e=c.cells[b].rowSpan>1;var d=j[1],n=d!=null?d.cells.length:0,f=false;if(!e)for(var b=0;b<n&&!f;b++)f=d.cells[b].rowSpan>1;var k=c!=null&&m>0?c.offsetHeight:0,l=d!=null&&n>0?d.offsetHeight:0;h[a]=e||f?Math.min(k,l):Math.max(k,l)}for(var a=0;a<i;a++){var o=this.getJoinedRows(a,9);g.iterateCells(o,this.setCellContentDivHeight,h[a])}};this.setCellContentDivHeight=function(b,a){b.style.height=a+"px";return true};function h(){e=new $.ui.wijgrid.htmlTableAccessor(b.nw);c=new $.ui.wijgrid.htmlTableAccessor(b.ne);f=new $.ui.wijgrid.htmlTableAccessor(b.sw);d=new $.ui.wijgrid.htmlTableAccessor(b.se)}}});$.extend($.ui.wijgrid,{resizer:function(f){var h=[],s=10,r=1,u="{0}."+f.widgetName+".resizer",d=false,a=null,q,g=null,c=null,e=null;this.addElement=function(a){a.element.bind(b("mousemove"),p).bind(b("mousedown"),o).bind(b("mouseout"),i);h.push(a)};this.dispose=function(){$.each(h,function(c,a){a.element.unbind(b("mousemove"),p).unbind(b("mousedown"),o).unbind(b("mouseout"),i)});l()};function p(c){if(!d){var b=n({x:c.pageX,y:c.pageY});if(b&&b._canSize()&&f._canInteract()){b.element.css("cursor","e-resize");a=b}else i(c)}}function i(){if(!d)if(a){a.element.css("cursor","");a=null}}function o(b){a=n({x:b.pageX,y:b.pageY});if(a&&a._canSize()&&f._canInteract())try{a.element.css("cursor","");q=document.body.style.cursor;document.body.style.cursor="e-resize";g=c=$.ui.wijgrid.bounds(a.element);e=$('<div class="ui-wijgrid-resizehandle ui-state-highlight">&nbsp;</div>');e.css({left:b.pageX,top:g.top,height:f._field("view").getVisibleAreaBounds().height-a.element[0].offsetTop});$(document.body).append(e)}finally{t();d=true}}function j(a){var b=r*Math.round((a.pageX-c.left)/r);c={left:c.left+b,top:a.pageY};e.css("left",c.left)}function k(){try{document.body.style.cursor=q;e.remove();g!==c&&f._fieldResized(a,c.left-g.left)}finally{a=null;e=null;l();d=false}}function m(a){a.preventDefault()}function t(){if(!d){$(document).bind(b("mousemove"),j).bind(b("mouseup"),k);$(document.body).disableSelection();$.browser.msie&&$(document.body).bind("selectstart",m)}}function l(){if(d){$(document).unbind(b("mousemove"),j).unbind(b("mouseup"),k);$(document.body).enableSelection();$.browser.msie&&$(document.body).unbind("selectstart",m)}}function n(d){for(var b=0,e=h.length;b<e;b++){var c=h[b],a=$.ui.wijgrid.bounds(c.element),f=$.ui.isOver(d.y,d.x,a.top,a.left+a.width-s,a.height,s);if(f)return c}return null}function b(a){return $.ui.wijgrid.stringFormat(u,a)}}});
Raphael.fn.wij={moveTo:function(a,b){return this.path("M "+a+" "+b)},lineTo:function(a,b){return this.path("M "+this.wij.lastX+" "+this.wij.lastY+"L "+a+" "+b)},line:function(a,b,c,d){return this.path(["M",a,b,"L",c,d])},sector:function(b,c,a,d,e){var f=this.wij.getPositionByAngle(b,c,a,d),g=this.wij.getPositionByAngle(b,c,a,e);return this.path(["M",b,c,"L",f.x,f.y,"A",a,a,0,+(e-d>180),0,g.x,g.y,"z"])},donut:function(f,g,d,c,a,b){var e=this.wij.getPositionByAngle(f,g,d,a),j=this.wij.getPositionByAngle(f,g,d,b),i=this.wij.getPositionByAngle(f,g,c,a),h=this.wij.getPositionByAngle(f,g,c,b);return this.path(["M",e.x,e.y,"A",d,d,0,+(b-a>180),0,j.x,j.y,"L",h.x,h.y,"A",c,c,0,+(b-a>180),1,i.x,i.y,"L",e.x,e.y,"z"])},roundRect:function(l,m,e,d,j,h,g,i){var a=[],c=[-1,1,1,1,1,-1,-1,-1],f=["v","h","v","h"];$.each([j,h,g,i],function(c,b){if(typeof b=="number")a=a.concat({x:b,y:b});else if(typeof b=="object")a=a.concat(b);else a=a.concat({x:0,y:0})});var b=["M",l+a[0].x,m],k=[d-a[0].y-a[1].y,e-a[1].x-a[2].x,a[2].y+a[3].y-d,a[3].x+a[0].x-e];$.each(a,function(d,a){if(a.x&&a.y)b=b.concat("a",a.x,a.y,0,0,0,c[2*d]*a.x,c[2*d+1]*a.y);b=b.concat(f[d],k[d])});b.push("z");return this.path(b)},getPositionByAngle:function(e,f,c,d){var a={},b=Raphael.rad(d);a.x=e+c*Math.cos(-1*b);a.y=f+c*Math.sin(-1*b);return a},round:function(d,c){var b=Math.pow(10,c),a=d*b;a=Math.round(a);return a/b},getSVG:function(){function e(f,d){var c="<"+f+" ",a=null,e=false;for(var b in d){if(b=="text"||b=="opacity"||b=="transform"||b=="path"||b=="w"||b=="h"||b=="translation")continue;if((a=d[b])!=null){if(b=="stroke"&&a===0)a="none";c+=b+"='"+a+"' "}}if((a=d.opacity)!=null){c+="opacity='"+a+"' style='opacity:"+a+";";e=true}if((a=d.transform)!=null&&a.length>0)if(e)c+="transform:"+a;else{c+="style='transform:"+a;e=true}if(e)c+="'";if((a=d.text)!=null)c+="><tspan>"+a+"</tspan>";else c+=">";c+="</"+f+">";return c}for(var c=this,d='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+c.canvas.offsetWidth+'" height="'+c.canvas.offsetHeight+'"><desc>Created with Raphael</desc><defs></defs>',a=c.bottom;a!=null;a=a.next)if(a&&a.type)switch(a.type){case"path":var b="";$.each(a.attrs.path,function(c,a){$.each(a,function(d,c){if(d<1)b+=c;else if(d==a.length-1)b+=c;else b+=c+","})});if(b!=null&&b.length>0)a.attrs.d=b.replace(/,/g," ");case"text":if(a.attrs["text-anchor"]==null)a.attrs["text-anchor"]="middle";case"image":a.attrs.transform=a.transformations?a.transformations.join(" "):"";case"ellipse":case"rect":d+=e(a.type,a.attrs)}d+="</svg>";return d},tooltip:function(c){var a=this;function b(){var k={},j={"fill-opacity":.9,fill:"white"},b=null,e=null,i=false,d={x:0,y:0},g=null,f=null;this.showDelay=250;this.hideDelay=250;this.duration=250;this.easing="";this.compass="west";this.offset=0;this.text="";this.textAttr={};this.rectAttr={};this.rectRadius=5;var h=function(a){if(a!=null){window.clearTimeout(a);a=null}};this.hide=function(a){g&&h(g);f&&h(f);if(a!=null)this.hideDelay=a;var b=this;if(this.hideDelay>0)f=window.setTimeout(function(){b._hide()},this.hideDelay);else b._hide()};this.showAt=function(c,a){g&&h(g);f&&h(f);if(a!=null)this.showDelay=a;var b=this;if(this.showDelay>0)g=window.setTimeout(function(){b._show(c)},this.showDelay);else b._show(c)};this._hide=function(){if(b){b.stop();b.remove();b=null}if(e){e.stop();e.remove();e=null}i=false};this._show=function(m){if(b==null)b=a.text(0,0,this.text);var n=$.extend(k,this.textAttr);b.attr({text:this.text});b.attr(n);var g=b.wijGetBBox();g.width=g.width+10;g.height=g.height>30?g.height:30;var f=c._getCompassTextPosition(this.compass,g,this.offset,m,0);if(e==null)b.attr({x:f.endPoint.x+f.offsetX,y:f.endPoint.y+f.offsetY});else b.attr({x:d.x+d.offsetX,y:d.y+d.offsetY});var o=$.extend(j,this.rectAttr),l=this._convertCompassToPos(this.compass);if(e==null)e=a.popup(f.endPoint.x,f.endPoint.y,b,l);else{e.remove();e=a.popup(d.x,d.y,b,l);var h=f.endPoint.x-d.x+","+(f.endPoint.y-d.y);e.stop().animate({translation:h},this.duration,this.easing);b.stop().animate({translation:h},this.duration,this.easing)}d.x=f.endPoint.x;d.y=f.endPoint.y;d.offsetX=f.offsetX;d.offsetY=f.offsetY;e.attr(o);b.toFront();i=true};this._convertCompassToPos=function(b){var a="";switch(b){case"northeast":a="top-left";break;case"northwest":a="top-right";break;case"southeast":a="bottom-left";break;case"southwest":a="bottom-right";break;case"south":a="bottom";break;case"north":a="top";break;case"east":a="right";break;case"west":default:a="left"}return a}}return new b}};Raphael.el.wijGetBBox=function(){var a=this.getBBox();if(Raphael.vml)if(this.type==="text"){this.shape.style.display="inline";a.width=this.shape.scrollWidth;a.height=this.shape.scrollHeight}else{a.width=this.W;a.height=this.H}return a};Raphael.el.getBBoxRotated=function(){if(this.attrs.rotation!=0){var d=this._.rt.deg*Math.PI/180,c=[],b=this.getBBox();c.push({x:0,y:0});c.push({x:b.width,y:0});c.push({x:0,y:b.height});c.push({x:b.width,y:b.height});var a=[];a.left=0;a.right=0;a.top=0;a.bottom=0;for(_px=0;_px<c.length;_px++){var e=c[_px],f=parseInt(e.x*Math.cos(d)+e.y*Math.sin(d)),g=parseInt(e.x*Math.sin(d)+e.y*Math.cos(d));a.left=Math.min(a.left,f);a.right=Math.max(a.right,f);a.top=Math.min(a.top,g);a.bottom=Math.max(a.bottom,g)}var i=parseInt(Math.abs(a.right-a.left)),h=parseInt(Math.abs(a.bottom-a.top)),f=b.x+b.width/2-i/2,g=b.y+b.height/2-h/2;return{x:f,y:g,width:i,height:h}}else return this.getBBox()};Raphael.el.wijAnimate=function(a,f,c,b){this.animate(a,f,c,b);var e=this.shadow;if(e){var d=e.offset;if(a.x)a.x+=d;if(a.y)a.y+=d;this.shadow.animate(a,f,c,b)}};Raphael.el.wijAttr=function(a,c){this.attr(a,c);if(this.shadow)if(typeof a=="object"){var b=$.extend(true,{},a);if(b.fill)delete b.fill;if(b.stroke)delete b.stroke;if(b["stroke-width"]!=null)delete b["stroke-width"];this.shadow.attr(b,c)}else if(typeof a=="string")switch(a){case"clip-rect":case"cx":case"cy":case"fill-opacity":case"font":case"font-family":case"font-size":case"font-weight":case"height":case"opacity":case"path":case"r":case"rotation":case"rx":case"ry":case"scale":case"stroke-dasharray":case"stroke-linecap":case"stroke-linejoin":case"stroke-miterlimit":case"stroke-opacity":case"stroke-width":case"translation":case"width":this.shadow.attr(a,c);break;case"x":this.shadow.attr(a,c);this.shadow.attr("translation","1 0");break;case"y":this.shadow.attr(a,c);this.shadow.attr("translation","0 1")}};Raphael.st.wijAttr=function(c,b){for(var a=0,d=this.items.length;a<d;a++)this.items[a].wijAttr(c,b);return this};Raphael.st.wijAnimate=function(e,f,d,c){for(var b=0,g=this.items.length;b<g;b++){var a=this.items[b];a.animate(e,f,d,c);a.shadow&&a.shadow.animate(e,f,d,c)}return this};function isSVGElem(a){var b="http://www.w3.org/2000/svg";return a.nodeType==1&&a.namespaceURI==b}$.expr.filter.CLASS=function(a,c){var b=!isSVGElem(a)?a.className:a.className?a.className.baseVal:a.getAttribute("class");return(" "+b+" ").indexOf(c)>-1};$.expr.preFilter.CLASS=function(b,d,f,g,i,h){b=" "+b[1].replace(/\\/g,"")+" ";if(h)return b;for(var c=0,a={};a!=null;c++){a=d[c];if(!a)try{a=d.item(c)}catch(j){}if(a){var e=!isSVGElem(a)?a.className:(a.className?a.className.baseVal:"")||a.getAttribute("class");if(i^(e&&(" "+e+" ").indexOf(b)>-1))!f&&g.push(a);else if(f)d[c]=false}}return false};(function(a){a.widget("ui.wijchartcore",{options:{width:null,height:null,seriesList:[],seriesStyles:[{stroke:"#77b3af",opacity:.9,"stroke-width":"1"},{stroke:"#67908e",opacity:.9,"stroke-width":"1"},{stroke:"#465d6e",opacity:.9,"stroke-width":"1"},{stroke:"#5d3f51",opacity:.9,"stroke-width":"1"},{stroke:"#682e32",opacity:.9,"stroke-width":"1"},{stroke:"#8c5151",opacity:.9,"stroke-width":"1"},{stroke:"#ce9262",opacity:.9,"stroke-width":"1"},{stroke:"#ceb664",opacity:.9,"stroke-width":"1"},{stroke:"#7fb34f",opacity:.9,"stroke-width":"1"},{stroke:"#2a7b5f",opacity:.9,"stroke-width":"1"},{stroke:"#6079cb",opacity:.9,"stroke-width":"1"},{stroke:"#60a0cb",opacity:.9,"stroke-width":"1"}],seriesHoverStyles:[{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"},{opacity:1,"stroke-width":"1.5"}],marginTop:25,marginRight:25,marginBottom:25,marginLeft:25,textStyle:{fill:"#888","font-size":"10pt",stroke:"none"},header:{text:"",style:{fill:"none",stroke:"none"},textStyle:{"font-size":"18pt",fill:"#666",stroke:"none"},compass:"north",orientation:"horizontal",visible:true},footer:{text:"",style:{fill:"#fff",stroke:"none"},textStyle:{fill:"#000",stroke:"none"},compass:"south",orientation:"horizontal",visible:false},legend:{textSpacing:50,text:"",textMargin:{left:2,top:2,right:2,bottom:2},style:{fill:"none",stroke:"none"},textStyle:{fill:"#333",stroke:"none"},titleStyle:{"font-weight":"bold",fill:"#000",stroke:"none"},compass:"east",orientation:"vertical",visible:true},axis:{x:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:true,textVisible:true,textStyle:{fill:"#888","font-size":"15pt","font-weight":"bold"},labels:{style:{fill:"#333","font-size":"11pt"},textAlign:"near"},compass:"south",autoMin:true,autoMax:true,min:null,max:null,autoMajor:true,autoMinor:true,unitMajor:null,unitMinor:null,gridMajor:{visible:false,style:{stroke:"#CACACA","stroke-dasharray":"- "}},gridMinor:{visible:false,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",valueLabels:[]},y:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:false,textVisible:true,textStyle:{fill:"#888","font-size":"15pt","font-weight":"bold"},labels:{style:{fill:"#333","font-size":"11pt"},textAlign:"center"},compass:"west",autoMin:true,autoMax:true,min:null,max:null,autoMajor:true,autoMinor:true,unitMajor:null,unitMinor:null,gridMajor:{visible:true,style:{stroke:"#999999","stroke-width":"0.5","stroke-dasharray":"none"}},gridMinor:{visible:false,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",valueLabels:[]}},hint:{enable:true,formatter:null,offset:0,compass:"north",showDelay:0,hideDelay:0,textStyle:{fill:"#d1d1d1","font-size":"16pt"},style:{fill:"270-#333333-#000000","stroke-width":"2"},duration:120,easing:"easeOutExpo"},showDefaultChartLabels:true,chartLabelStyle:{},disableDefaultTextStyle:false,shadow:true,mousedown:null,mouseup:null,mouseover:null,mouseout:null,mousemove:null,click:null,beforeserieschange:null,serieschanged:null,beforepaint:null,painted:null},innerState:{},_setOption:function(c,b){switch(c){case"seriesList":if(b==null)b=[];var d=a.Event("beforeserieschange");this._trigger("beforeserieschange",d,{oldSeriesList:this.options.seriesList,newSeriesList:b});if(d.isImmediatePropagationStopped())return false;this.options.seriesList=b;this.innerState={};this._paint();this._trigger("serieschanged",null,b);break;default:if(a.isPlainObject(this.options[c]))a.extend(true,this.options[c],b);else this.options[c]=b;this._unbindLiveEvents();this._paint();this._bindLiveEvents()}a.Widget.prototype._setOption.apply(this,arguments)},_create:function(){var d=this.options.width,c=this.options.height;this.innerState={};if(this.element.length>0){var e=this.element[0];if(this.element.is("table")){this._parseTable();var b=a("<div></div>");if(d!=null)b.css("width",d);else b.css("width",this.element.width());if(c!=null)b.css("height",c);else b.css("height",this.element.height());this.element.after(b);e=b[0];this.chartElement=b}else this.chartElement=this.element;this.chartElement.addClass("ui-widget");if(d==null)d=a(e).width();if(c==null)c=a(e).height();this.canvas=Raphael(e,d,c);this.width=d;this.height=c}this.headerEles=[];this.footerEles=[];this.legendEles=[];this.axisEles=[];this.legends=[];this.legendIcons=[];this.chartLabelEles=[]},_parseTable:function(){var d=this.element,b=this.options;if(!d.is("table"))return;var c=a("caption",d);if(c.length){b.header=a.extend({visible:true,text:a.trim(a(c[0]).text())},b.header);if(c.length>1)b.footer=a.extend({visibel:true,text:a.trim(a(c[1]).text())},b.footer)}b.legend=a.extend({visible:true},b.legend);var g=[],f=a("thead th",d);f.length&&f.each(function(){var b=a.trim(a(this).text());g.push(b)});var e=[],h=a("tbody tr",d);h.length&&h.each(function(){var h=a("th",a(this)),f=a.trim(h.text()),b=[],c=a("td",a(this));c.length&&c.each(function(){var c=a(this);b.push(parseFloat(a.trim(c.text())))});var d={label:f,legendEntry:true,data:{x:g,y:b}};e.push(d)});this.options.seriesList=e},_init:function(){var b=this;if(!b._rendered){b._paint();b._bindLiveEvents();b._rendered=true;if(b.options.width==null||b.options.height==null){var c;a(window).resize(function(){clearTimeout(c);c=setTimeout(function(){b._unbindLiveEvents();var c=b.element.width(),a=b.element.height();b.canvas.setSize(c,a);b.width=c;b.height=a;b._paint();b._bindLiveEvents()},250)})}}},destroy:function(){this._unbindLiveEvents();this._clearChartElement();this.chartElement.removeClass("ui-widget");this.element!=this.chartElement&&this.chartElement.remove();a.Widget.prototype.destroy.apply(this,arguments)},getCanvas:function(){return this.canvas},getSVG:function(){return Raphael.type=="SVG"?this.chartElement.html():this.canvas.wij.getSVG()},exportChart:function(){var b=document.createElement("form");b.action="http://export.highcharts.com/";b.method="post";b.style.display="none";document.body.appendChild(b);var c=this.getSVG();a.each(["filename","type","width","svg"],function(f,e){var d=document.createElement("input");a(d).attr("name",e).attr("type","hidden").attr("value",({filename:"chart",type:"image/png",width:600,svg:c})[e]);b.appendChild(d)});b.submit();document.body.removeChild(b)},addSeriesPoint:function(c,d,f){var b=this.options.seriesList;if(c>=b.length)return;var e=b[c],a=e.data||[];a.x.push(d.x);a.y.push(d.y);if(f){a.x.shift();a.y.shift()}this._setOption("seriesList",b)},_clearChartElement:function(){if(this.headerEles.length){for(var a=0,b=this.headerEles.length;a<b;a++)this.headerEles[a].remove();this.headerEles=[]}if(this.footerEles.length){for(var a=0,b=this.footerEles.length;a<b;a++)this.footerEles[a].remove();this.footerEles=[]}if(this.legendEles.length){for(var a=0,b=this.legendEles.length;a<b;a++)this.legendEles[a].remove();this.legendEles=[]}if(this.legends.length){for(var a=0,b=this.legends.length;a<b;a++)this.legends[a].remove();this.legends=[]}if(this.legendIcons.length){for(var a=0,b=this.legendIcons.length;a<b;a++)this.legendIcons[a].remove();this.legendIcons=[]}if(this.axisEles.length){for(var a=0,b=this.axisEles.length;a<b;a++)this.axisEles[a].remove();this.axisEles=[]}if(this.chartLabelEles.length){for(var a=0,b=this.chartLabelEles.length;a<b;a++)this.chartLabelEles[a].remove();this.chartLabelEles=[]}this.canvas.clear()},_text:function(c,d,b){var a=this.canvas.text(c,d,b);if(this.options.disableDefaultTextStyle)a.node.style.cssText="";return a},_paintShadow:function(c,a,d){if(this.options.shadow){a=a||1;d=d||"#CCCCCC";var b=c.clone();b.insertBefore(c);b.attr({translation:a+" "+a,stroke:d,"stroke-width":a});b.toBack();b.offset=a;c.shadow=b}},_paint:function(){this._clearChartElement();var b=a.Event("beforepaint");this._trigger("beforepaint",b);if(b.isImmediatePropagationStopped())return false;var c=this.options;this.canvasBounds={startX:0,endX:this.width,startY:0,endY:this.height};this._paintHeader();this._paintFooter();this._paintLegend();this._paintChartArea();this._paintChartLabels();this._trigger("painted")},_calculatePosition:function(f,e,d){var a={x:0,y:0},b=5,c=5;switch(f){case"north":a.x=(this.canvasBounds.endX-this.canvasBounds.startX)/2;a.y=this.canvasBounds.startY+d/2+c;this.canvasBounds.startY=this.canvasBounds.startY+c*2+d;break;case"south":a.x=(this.canvasBounds.endX-this.canvasBounds.startX)/2;a.y=this.canvasBounds.endY-d/2-c;this.canvasBounds.endY=this.canvasBounds.endY-c*2-d;break;case"east":a.x=this.canvasBounds.endX-e/2-b;a.y=(this.canvasBounds.endY-this.canvasBounds.startY)/2;this.canvasBounds.endX=this.canvasBounds.endX-b*2-e;break;case"west":a.x=this.canvasBounds.startX+e/2+b;a.y=(this.canvasBounds.endY-this.canvasBounds.startY)/2;this.canvasBounds.startX=this.canvasBounds.startX+b*2+e}return a},_paintHeader:function(){var d=2,i=this.options,b=i.header;if(b.text&&b.text.length>0&&b.visible){var k=b.compass,c=this._text(0,0,b.text),j=a.extend(true,{},i.textStyle,b.textStyle);c.attr(j);var h=c.wijGetBBox(),g=this._calculatePosition(k,h.width,h.height);c.translate(g.x,g.y);var e=c.wijGetBBox(),f=this.canvas.rect(e.x-d,e.y-d,e.width+2*d,e.height+2*d);f.attr(b.style);f.toBack();this.headerEles.push(c);this.headerEles.push(f)}},_paintFooter:function(){var d=2,i=this.options,b=i.footer;if(b.text&&b.text.length>0&&b.visible){var k=b.compass,c=this._text(0,0,b.text),j=a.extend(true,{},i.textStyle,b.textStyle);c.attr(j);var h=c.wijGetBBox(),g=this._calculatePosition(k,h.width,h.height);c.translate(g.x,g.y);var e=c.wijGetBBox(),f=this.canvas.rect(e.x-d,e.y-d,e.width+2*d,e.height+2*d);f.attr(b.style);f.toBack();this.footerEles.push(c);this.footerEles.push(f)}},_paintLegend:function(){var p=this.options,g=2,e={size:{width:22,height:10}};a.extend(true,e,p.legend);if(e.visible){var r=e.compass,q=e.orientation,h;if(e.text&&e.text.length){h=this._text(0,0,e.text);var D=a.extend(true,{},p.textStyle,e.textStyle,e.titleStyle);h.attr(D);this.legendEles.push(h)}var u=p.seriesList,H=p.seriesStyles,k=e.size.width,K=e.size.height;if(!e.reversed)for(var f=0,z=u.length;f<z;f++){var i=u[f];i=a.extend({legendEntry:true},i);var I=H[f],J=a.extend(true,{fill:"none",opacity:1,stroke:"black"},I);if(i.legendEntry){var y=this._text(0,0,i.label),D=a.extend(true,{},p.textStyle,e.textStyle);y.attr(D);this.legends.push(y);var L=a.extend(J,{"stroke-width":1}),n=this.canvas.rect(0,0,k,K);n.attr(L);this.legendIcons.push(n)}}else for(var f=u.length-1;f>=0;f--){var i=u[f];i=a.extend({legendEntry:true},i);var I=H[f],J=a.extend(true,{fill:"none",opacity:1,stroke:"black"},I);if(i.legendEntry){var y=this._text(0,0,i.label),D=a.extend(true,{},p.textStyle,e.textStyle);y.attr(D);this.legends.push(y);var L=a.extend(J,{"stroke-width":1}),n=this.canvas.rect(0,0,k,K);n.attr(L);this.legendIcons.push(n)}}var s=0,T=0,m=0;if(h)T=h.wijGetBBox().width;var w=0,j=0,l=0;if(h)j=h.wijGetBBox().height;var d=this.legends.length;if(d)for(f=0,z=d;f<z;f++){var S=this.legends[f],x=S.wijGetBBox();if(x.width>m)m=x.width;if(x.height>l)l=x.height}var v=this.canvasBounds.endX-this.canvasBounds.startX,t=this.canvasBounds.endY-this.canvasBounds.startY,c=1,b=e.textMargin;if(r=="east"||r=="west"){if(q=="horizontal"){var C=d*(m+k+g)+d*(b.left+b.right);if(C>v/2){c=Math.floor(v/2/m);if(c<1)c=1}else c=d}else if(q=="vertical"){var B=l*d+j+d*(b.top+b.bottom);if(B>t)c=Math.ceil(B/t);else c=1}}else if(r=="south"||r=="north")if(q=="horizontal"){var C=(m+k+g)*d+d*(b.left+b.right);if(C>v){c=Math.floor(d/C*v);if(c<1)c=1}else c=d}else if(q=="vertical"){var B=l*d+j+d*(b.top+b.bottom);if(B>t/2){var U=Math.floor(t-j)/2/l;c=Math.ceil(d/U)}else c=1}s=c*(m+k+g)+c*(b.left+b.right);w=l*Math.ceil(d/c)+j+c*(b.top+b.bottom);var N=this._calculatePosition(r,s,w),E=N.x-s/2,F=N.y-w/2,A=this.canvas.rect(E-g,F-g,s+2*g,w+2*g);A.attr(e.style);A.toBack();this.legendEles.push(A);var O=0;if(h){h.translate(E+s/2,F+O+j/2);if(q=="vertical")O=j}for(var o=0,M=j,f=0,z=d;f<z;f++){var G=this.legends[f],n=this.legendIcons[f],P=G.wijGetBBox(),Q=E+o*(k+m+g)+(o+1)*b.left+o*b.right,R=F+M+P.height/2+b.top;n.translate(Q,R-n.wijGetBBox().height/2);G.translate(Q+k+g+P.width/2,R);G.toFront();o++;if(o==c){o=0;M+=l+b.top+b.bottom}}}},_hasAxes:function(){return this.widgetName=="wijpiechart"?false:true},_applyAxisText:function(c){var e=c.text,b=null;if(e!=null&&e.length>0){var d=this._text(-100,-100,e),f=a.extend(true,{},this.options.textStyle,c.textStyle);d.attr(f);b=d.wijGetBBox();switch(c.compass){case"north":this.canvasBounds.startY+=b.height;break;case"south":this.canvasBounds.endY-=b.height;break;case"east":this.canvasBounds.endX-=b.height;break;case"west":this.canvasBounds.startX+=b.height}d.remove()}return b},_paintChartArea:function(){this._applyMargins();if(this.options.seriesList==null||this.options.seriesList.length==0)return;if(this._hasAxes()){if(this.innerState.axisInfo){this.axisInfo=this.innerState.axisInfo;this.canvasBounds=this.innerState.canvasBounds}else{var a=this.options.axis,g=2,h=this._applyAxisText(a.x),i=this._applyAxisText(a.y);this.axisInfo={x:{id:"x",tprec:0,isTime:false,offset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:h,axisTextOffset:g},y:{id:"y",tprec:0,isTime:false,offset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:i,axisTextOffset:g}};var b=this._getDataExtreme();if(a.x.autoMin)a.x.min=b.txn;if(a.x.autoMax)a.x.max=b.txx;if(a.y.autoMin)a.y.min=b.tyn;if(a.y.autoMax)a.y.max=b.tyx;var d=5,c=this.options.axis;do{var f=this._autoPosition(this.axisInfo.y,c.y),e=this._autoPosition(this.axisInfo.x,c.x);if(f==this.axisInfo.y.offset&&e==this.axisInfo.x.offset){d=0;break}if(f!=this.axisInfo.y)this.axisInfo.y.offset=f;if(e!=this.axisInfo.x)this.axisInfo.x.offset=e;d--}while(d>0);this._adjustPlotArea(c.x,this.axisInfo.x);this._adjustPlotArea(c.y,this.axisInfo.y);this.innerState.axisInfo=this.axisInfo;this.innerState.canvasBounds=this.canvasBounds}this._paintAxes();this._paintPlotArea()}else this._paintPlotArea()},_adjustPlotArea:function(b,a){b.max=a.max;b.min=a.min;switch(b.compass){case"north":this.canvasBounds.startY+=a.offset;break;case"south":this.canvasBounds.endY-=a.offset;break;case"east":this.canvasBounds.endX-=a.offset;break;case"west":this.canvasBounds.startX+=a.offset}},_autoPosition:function(b,a){return this._autoPositionCartesianAxis(b,a)},_autoPositionCartesianAxis:function(b,a){switch(a.compass){case"north":case"south":this._calculateParameters(b,a);var c=this._getMaxExtents(b,a);return c.height;case"east":case"west":this._calculateParameters(b,a);var c=this._getMaxExtents(b,a);return c.width}},_getMaxExtents:function(b,d,o){var s=this._getTickRect(b,d,true,true,o),t=this._getTickRect(b,d,false,true,o);b.majorTickRect=s;b.minorTickRect=t;var h=this._getMajorTickValues(b,d),g={width:0,height:0},p=this.options,v=b.min,u=b.max,r=b.isTime,f=d.annoFormatString;if(!f)f=b.annoFormatString;if(h!=null&&h.length)for(var q=p.is100Percent,m=0,k=0;m<h.length;m++,k++){var c=h[m];if(c>=v&&c<=u){if(d.annoMethod=="valueLabels")c=d.valueLabels[k].text;else if(d.annoMethod=="values")if(f&&f.length){if(r)c=this._fromOADate(c);c=a.format(c,f)}else if(q&&b.id=="y")c=a.format(c,"p0");var n=a.extend(true,{},p.textStyle,d.textStyle,d.labels.style),l=this._text(-100,-100,c).attr(n),j,i;if(n.rotation){var e=l.getBBoxRotated();j=e.width;i=e.height}else{var e=l.wijGetBBox();j=e.width;i=e.height}l.remove();if(e.width>g.width)g.width=j;if(e.height>g.height)g.height=i}else k--}return g},_getMajorTickValues:function(a,c){var b=[];b=this._getTickValues(a.max,a.min,c.unitMajor,a.tprec,!a.isTime);return b},_getMinorTickValues:function(a,c){var b=[];b=this._getTickValues(a.max,a.min,c.unitMinor,a.tprec,!a.isTime);return b},_getTickValues:function(f,a,b,d,l){var g=[],k=a;try{if(b==0)g=[f,a];else{if(d+1<0)d=-1;else if(d+1>15)d=14;var i=this.canvas.wij.round(this._signedCeiling(a/b)*b,d+1);if(i<f)a=i;var m=parseInt(this.canvas.wij.round(f/b,5)),j=parseInt(this.canvas.wij.round(a/b,5)),c=parseInt(m-j+1);if(c>1){var h=j*b;if(h<a){c--;a+=b}h=a+(c-1)*b;if(h>f)c--}if(c<1){c=2;a=k;b=f-a}for(var e=0;e<c;e++)if(l)g[e]=this.canvas.wij.round(a+e*b,d+1);else g[e]=a+e*b}}catch(n){}return g},_getTickRect:function(k,d,j,e){var c=d.compass,f=0,a=null,h=3,i=2,g=2;if(j){a=d.tickMajor.position;f=h*d.tickMajor.factor}else{a=d.tickMinor.position;f=i*d.tickMinor.factor}if(a=="none"||a=="inside"&&e)f=0;var b={x:0,y:0,width:0,height:0};if(c=="east"||c=="west"){b={x:0,y:-1,width:f*g,height:g};if(c=="east"&&(a=="outside"||a=="cross"&&e)||c=="west"&&a=="inside")b.width+=2;else if(!e){if(a=="corss")b.width<<=1;b.width+=2}}else{b={x:-1,y:0,width:g,height:f*g};if(c=="south"&&(a=="outside"||a=="corss"&&e)||c=="north"&&a=="inside")b.height+=2;else if(!e){if(a=="cross")b.height<<=1;b.height+=2}}return b},_applyMargins:function(){var a=this.options;this.canvasBounds.startX+=a.marginLeft;this.canvasBounds.endX-=a.marginRight;this.canvasBounds.startY+=a.marginTop;this.canvasBounds.endY-=a.marginBottom},_paintAxes:function(){this._paintAxis(this.options.axis.x,this.axisInfo.x);this._paintAxis(this.options.axis.y,this.axisInfo.y)},_paintAxis:function(c,f){var b=this.canvasBounds,d={x:0,y:0,ox:0,oy:0},e={x:0,y:0,ox:0,oy:0},r=c.compass,h=2,q=true;switch(r){case"south":d.x=b.startX;d.ox=b.startX;d.y=b.endY;d.oy=b.startY;e.x=b.endX;e.ox=b.endX;e.y=b.endY;e.oy=b.startY;q=false;break;case"north":d.x=b.startX;d.ox=b.startX;d.y=b.startY-h;d.oy=b.endY-h;e.x=b.endX;e.ox=b.endX;e.y=b.startY-h;e.oy=b.endY-h;q=false;break;case"east":d.x=b.endX;d.ox=b.startX;d.y=b.endY;d.oy=b.endY;e.x=b.endX;e.ox=b.startX;e.y=b.startY;e.oy=b.startY;break;case"west":d.x=b.startX-h;d.ox=b.endX;d.y=b.endY;d.oy=b.endY;e.x=b.startX-h;e.ox=b.endX;e.y=b.startY;e.oy=b.startY}var u=this.canvas.wij.line(d.x,d.y,e.x,e.y);u.attr(c.style);!c.visible&&u.hide();this.axisEles.push(u);var p=this._getMajorTickValues(f,c),l=this._getMinorTickValues(f,c);l=this._resetMinorTickValues(l,p);var L=p.length,M=l.length,o=f.min,n=f.max,J=c.unitMajor,K=c.unitMinor,H=c.tickMajor.position,I=c.tickMinor.position,y=f.offset,z=c.tickMajor.style,A=c.tickMinor.style,B=f.majorTickRect,C=f.minorTickRect,w=f.axisTextOffset,N=f.isTime,k=c.annoFormatString;if(!k)k=f.annoFormatString;for(var D=this.options.is100Percent,E=c.gridMajor,F=c.gridMinor,s=c.labels,t=0,x=[],j=0,v=0;v<L;j++,v++){var g=p[v],i=g;if(g>=o&&g<=n){if(c.annoMethod=="valueLabels")i=c.valueLabels[j].text;else if(c.annoMethod=="values")if(k&&k.length){if(N)i=this._fromOADate(g);i=a.format(i,k)}else if(D&&f.id=="y")i=a.format(g,"p0");var G=a.extend(true,{},this.options.textStyle,c.textStyle,s.style),m=this._paintMajorMinor(n,o,g,H,J,B,r,d,e,y,w,z,i,E,c.textVisible,G,s.textAlign);if(m){x.push(m);if(t<m.len)t=m.len}}else j--}a.each(x,function(d,c){var b=c.text,a=(c.len-t)/2;a=s.textAlign=="near"?a*-1:a;if(q)b.translate(a,0);else b.translate(0,a)});for(var j=0;j<M;j++){var g=l[j];g>o&&g<n&&this._paintMajorMinor(n,o,g,I,K,C,r,d,e,y,w,A,null,F,c.textVisible)}this._paintAxisText(c,f)},_paintAxisText:function(g,d){var p=g.text;if(p==null||p.length==0)return;var m=g.compass,r=g.alignment,i=this.canvasBounds.startX,j=this.canvasBounds.startY,n=this.canvasBounds.endX,o=this.canvasBounds.endY,e=i,f=j,b=d.textBounds,l=this._isVertical(m),h=d.axisTextOffset,q=d.majorTickRect,s=g.tickMajor.position,c=l?q.width:q.height;if(s=="cross")c=c/2;else if(s=="inside")c=0;if(l){switch(r){case"near":f=o-b.width/2;break;case"center":f=(j+o)/2;break;case"far":f=j+b.width/2}if(m=="west")e=i-(d.offset+h+c+b.height/2);else e=n+d.offset+h+c+b.height/2}else{switch(r){case"near":e=i+b.width/2;break;case"center":e=(i+n)/2;break;case"far":e=n-b.width/2}if(m=="north")f=j-(d.offset+h+c+b.height/2);else f=o+d.offset+h+c+b.height/2}var k=this._text(e,f,p);this.axisEles.push(k);var t=a.extend(true,{},this.options.textStyle,g.textStyle);k.attr(t);l&&k.rotate(-90)},_resetMinorTickValues:function(a,d){for(var b=a.length-1;b>=0;b--)for(var f=a[b],c=d.length-1;c>=0;c--){var e=d[c];f==e&&a.splice(b,1)}return a},_paintMajorMinor:function(z,p,A,e,F,b,g,k,v,l,i,s,y,o,B,D,C){var c=k.x,d=k.y,m=-1,n=-1,j=true,f=this.canvasBounds,w=null;switch(g){case"south":if(e=="inside")d-=b.height;else if(e=="cross")d-=b.height/2;n=d+i+b.height+l/2;j=false;break;case"west":if(e=="outside")c-=b.width;else if(e=="cross")c-=b.width/2;m=c-(i+l/2);break;case"north":if(e=="outside")d-=b.height;else if(e=="cross")d-=b.height/2;n=d-(i+l/2);j=false;break;case"east":if(e=="inside")c-=b.width;else if(e=="cross")c-=b.width/2;m=c+i+b.width+l/2}var r=null,E=[],t={"stroke-width":2};if(j){d+=(A-p)/(z-p)*(v.y-k.y);if(o.visible)if(d!=f.startY&&g=="east"||d!=f.endY&&g=="west"){var x=["M",f.startX,d,"H",f.endX],q=this.canvas.path(x.concat(" "));q.attr(o.style);this.axisEles.push(q)}n=d;var E=["M",c,d,"h",b.width];s["stroke-width"]=b.height}else{c+=(A-p)/(z-p)*(v.x-k.x);if(o.visible)if(c!=f.startX&&g=="south"||c!=f.endX&&g=="north"){var x=["M",c,f.startY,"V",f.endY],q=this.canvas.path(x.concat(" "));q.attr(o.style);this.axisEles.push(q)}m=c;var E=["M",c,d,"v",b.height];s["stroke-width"]=b.width}r=this.canvas.path(E.concat(" "));t=a.extend(t,s);r.attr(t);this.axisEles.push(r);if(y!=null){var h=this._text(m,n,y.toString());h.attr(D);this.axisEles.push(h);!B&&h.hide();if(C!="center"){var u=h.wijGetBBox();w={text:h,len:j?u.width:u.height}}}return w},_paintPlotArea:function(){},_paintChartLabels:function(){var b=this.options.chartLabels;if(b&&b.length)for(var e=0,f=b.length;e<f;e++){var c=a.extend(true,{compass:"east",attachMethod:"coordinate",attachMethodData:{seriesIndex:-1,pointIndex:-1,x:-1,y:-1},offset:0,visible:false,text:"",connected:false},b[e]);if(c.visible){var d=this._getChartLabelPointPosition(c);if(isNaN(d.x)||isNaN(d.y))break;this._setChartLabel(c,d)}}},_getChartLabelPointPosition:function(){},_setChartLabel:function(c,e,l,i){var k=c.compass,g=this.options,j=a.extend(true,{},g.textStyle,g.chartLabelStyle),d=this._text(0,0,c.text).attr(j);this.chartLabelEles.push(d);var f=c.offset,b=this._getCompassTextPosition(k,d.wijGetBBox(),f,e,l);if(f&&c.connected){var h=this.canvas.path("M"+e.x+" "+e.y+"L"+b.endPoint.x+" "+b.endPoint.y);h.attr(i);this.chartLabelEles.push(h)}d.translate(b.endPoint.x+b.offsetX,b.endPoint.y+b.offsetY);d.toFront()},_getCompassTextPosition:function(g,b,h,f,a){var c=0,d=0,e={x:0,y:0};switch(g){case"east":a=0;break;case"west":a=180;break;case"north":a=90;break;case"south":a=270;break;case"northeast":a=45;break;case"northwest":a=135;break;case"southeast":a=315;break;case"southwest":a=225}if(a>=0&&a<45/2||a>675/2&&a<360)c=b.width/2;else if(a>=45/2&&a<135/2){c=b.width/2;d=-1*b.height/2}else if(a>=135/2&&a<225/2)d=-1*b.height/2;else if(a>=225/2&&a<315/2){c=-1*b.width/2;d=-1*b.height/2}else if(a>=315/2&&a<405/2)c=-1*b.width/2;else if(a>=405/2&&a<495/2){c=-1*b.width/2;d=b.height/2}else if(a>=495/2&&a<585/2)d=b.height/2;else{c=b.width/2;d=b.height/2}e=this.canvas.wij.getPositionByAngle(f.x,f.y,h,a);return{endPoint:e,offsetX:c,offsetY:d}},_getXSortedPoints:function(e){var b=e.data.x,f=[].concat(b),g=[].concat(e.data.y),d=[],c=b;if(b.length==0)return;function h(a,b){return a-b}if(typeof b[0]=="number")c=[].concat(b).sort(h);a.each(c,function(c,b){a.each(f,function(e,a){if(b==a){if(isNaN(a))a=c;d.push({x:a,y:g[e]});f.splice(e,1);g.splice(e,1);return false}})});return d},_bindLiveEvents:function(){},_unbindLiveEvents:function(){},_isBarChart:function(){return this.widgetName=="wijbarchart"},_calculateParameters:function(c,d){var b=d.max,a=d.min,m=d.autoMax,n=d.autoMin,o=d.autoMajor,p=d.autoMinor,g=null,q=d.annoMethod=="valueLabels";if(m&&b!=Number.MIN_VALUE)if(c.id!="x"&&this._isBarChart())if(b<0&&.5*(b-a)>-b)b=0;if(n&&a!=Number.MAX_VALUE)if(c.id!="x"&&this._isBarChart())if(a>0&&.5*(b-a)>a)a=0;if(b==a){if(a!=0)a-=1;b+=1}var e=b-a,h=0,i=c.isTime;if(i){g=d.annoFormatString;if(g==null||g.length==0){g=this._getTimeDefaultFormat(b,a);c.annoFormatString=g}h=this._niceTimeUnit(0,g)}var l=this._nicePrecision(e);c.tprec=l;if(m)if(i){var j=this._roundTime(b,h,true);if(j<b)b=j+h;else b=j}else{var j=this._precCeil(-l,b);if(!isNaN(j))b=j}if(n)if(i){var k=this._roundTime(a,h,false);if(k>a)a=k-h;else a=k}else{var k=this._precFloor(-l,a);if(!isNaN(k))a=k}c.max=b;c.min=a;c.axisAnno=g;c.tinc=h;if(o||p){e=b-a;this._calculateMajorMinor(d,c);var f=d.unitMajor;if(m&&f!=0&&!i&&!q){e=b-parseInt(b/f)*f;if(e!=0){b+=f-e;b=this._precCeil(-l,b)}}if(n&&f!=0&&!i&&!q){e=a-parseInt(a/f)*f;if(e!=0){if(e<0)e+=f;a-=Math.abs(e);a=this._precFloor(-l,a)}}}!o||!p;c.max=b;c.min=a},_roundTime:function(i,e,c){var b=e*this._tmInc.day,d=this._fromOADate(i);if(b>0){var a={year:d.getFullYear(),month:d.getMonth(),day:d.getDate(),hour:d.getHours(),minute:d.getMinutes(),second:d.getSeconds()};if(b<this._tmInc.minute){a.second=this._tround(a.second,b,c);return this._getTimeAsDouble(a)}a.second=0;if(b<this._tmInc.hour){b/=this._tmInc.minute;a.minute=this._tround(a.minute,b,c);return this._getTimeAsDouble(a)}a.minute=0;if(b<this._tmInc.day){b/=this._tmInc.hour;a.hour=this._tround(a.hour,b,c);return this._getTimeAsDouble(a)}a.hour=0;if(b<this._tmInc.month){b/=this._tmInc.day;a.day=this._tround(a.day,b,c);return this._getTimeAsDouble(a)}a.day=1;if(b<this._tmInc.year){b/=this._tmInc.month;a.month=this._tround(a.month,b,c);return this._getTimeAsDouble(a)}a.month=0;b/=this._tmInc.year;a.year=this._tround(a.year,b,c);return this._getTimeAsDouble(a)}else{var f=d,h=f-b,g=parseInt(h/e)*e;if(c&&g!=h)g+=e;f=b+g;return f}},_tround:function(c,a,d){var b=parseInt(c/a*a);if(d&&b!=c)b+=parseInt(a);return b},_getTimeAsDouble:function(a){var d=0,c=0;if(a.day<1){c=-1-a.day;a.day=1}else if(a.day>28){c=a.day-28;a.day=28}if(a.month<0){d=-1-a.day;a.month=0}else if(a.month>11){d=a.month-11;a.month=11}var b=new Date(a.year,a.month,a.day,a.hour,a.minute,a.second);b.setDate(b.getDate()+c);b.setMonth(b.getMonth()+d);return this._toOADate(b)},_getTimeDefaultFormat:function(c,d){var b=(c-d)*this._tmInc.day,a="s";if(b>2*this._tmInc.year)a="yyyy";else if(b>this._tmInc.year)a="MMM yy";else if(b>3*this._tmInc.month)a="MMM";else if(b>2*this._tmInc.week)a="MMM d";else if(b>2*this._tmInc.day)a="ddd d";else if(b>this._tmInc.day)a="ddd H:mm";else if(b>this._tmInc.hour)a="H:mm";else if(b>=1e3)a="H:mm:ss";else b>0;return a},_niceTimeUnit:function(c,b){var a=c*this._tmInc.day;a=this._niceTimeSpan(a,b);return a/this._tmInc.day},_niceTimeSpan:function(e,d){var b=this._manualTimeInc(d),c=0,a=0;b<this._tmInc.second;c=Math.ceil(e);if(c==0)return this._timeSpanFromTmInc(b);a=1;if(b<this._tmInc.minute){if(c<this._tmInc.minute){a=this._getNiceInc([1,2,5,10,15,30],c,b);if(a!=0)return a}b=this._tmInc.minute}if(b<this._tmInc.hour){if(c<this._tmInc.hour){a=this._getNiceInc([1,2,5,10,15,30],c,b);if(a!=0)return a}b=this._tmInc.hour}if(b<this._tmInc.day){if(c<this._tmInc.day){a=this._getNiceInc([1,3,6,12],c,b);if(a!=0)return a}b=this._tmInc.day}if(b<this._tmInc.month){if(c<this._tmInc.month){a=this._getNiceInc([1,2,7,14],c,b);if(a!=0)return a}b=this._tmInc.month}if(b<this._tmInc.year){if(c<this._tmInc.year){a=this._getNiceInc([1,2,3,4,6],c,b);if(a!=0)return a}b=this._tmInc.year}a=100*this._tmInc.year;if(c<a){a=this._getNiceInc([1,2,5,10,20,50],c,b);if(a==0)a=100*this._tmInc.year}return a},_getNiceInc:function(c,f,d){for(var a=0,e=c.length;a<e;a++){var b=c[a]*d;if(f<=b)return b}return 0},_timeSpanFromTmInc:function(a){var b=1e3;if(a!=this._tmInc.maxtime)if(a>this._tmInc.tickf1)b=a;else{var d=a,c=1;a+=7;while(d>0){c*=10;d--}b=c}return b},_manualTimeInc:function(a){var b=this._tmInc.second;if(a==null||a.length==0)return b;var c=a.indexOf("f");if(c<=0)if(a.indexOf("s")>=0)b=this._tmInc.second;else if(a.indexOf("m")>=0)b=this._tmInc.minute;else if(a.indexOf("h")>=0||a.indexOf("H")>=0)b=this._tmInc.hour;else if(a.indexOf("d")>=0)b=this._tmInc.day;else if(a.indexOf("M")>=0)b=this._tmInc.month;else if(a.indexOf("y")>=0)b=this._tmInc.year;return b},_tmInc:{tickf7:-7e3,tickf6:-6e3,tickf5:-5e3,tickf4:-4e3,tickf3:-3e3,tickf2:-2e3,tickf1:-1,second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3,month:31*24*60*60*1e3,year:365*24*60*60*1e3,maxtime:2147483647},_niceTickNumber:function(a){if(a==0||a==0)return a;else if(a<0)a=-a;var e=Math.log(a)/Math.log(10),d=parseInt(this._signedFloor(e)),c=a/Math.pow(10,d),b=10;if(c<=1)b=1;else if(c<=2)b=2;else if(c<=5)b=5;return b*Math.pow(10,d)},_niceNumber:function(b,d,e){if(b==0||b==0)return b;else if(b<0)b=-b;var c=b/Math.pow(10,d),a=10;if(e){if(c<1.5)a=1;else if(c<3)a=2;else if(c<7)a=5}else if(c<=1)a=1;else if(c<=2)a=2;else if(c<=5)a=5;return a*Math.pow(10,d)},_nicePrecision:function(a){if(a<=0||isNaN(a))return 0;var c=Math.log(a)/Math.log(10),b=parseInt(this._signedFloor(c)),d=a/Math.pow(10,b);if(d<3)b=-b+1;return b},_precCeil:function(d,c){var b=Math.pow(10,d),a=c/b;a=Math.ceil(a);return a*b},_precFloor:function(d,c){var b=Math.pow(10,d),a=c/b;a=Math.floor(a);return a*b},_signedCeiling:function(a){return a<0?Math.floor(a):Math.ceil(a)},_signedFloor:function(a){return a<0?Math.ceil(a):Math.floor(a)},_getDataExtreme:function(){var a={txx:0,txn:0,tyx:0,tyn:0};this._getDataExtremes(a);if(a.txn>a.txx){a.txn=0;a.txx=1}return a},_getDataExtremes:function(a){var m=this.options,l=m.seriesList,t=m.stacked,s=m.is100Percent,e=m.axis;if(!l||l.length==0)return a;for(var q=[],c=0,o=l.length;c<o;c++){var f=l[c].data,d=[].concat(f.x),b=[].concat(f.y),n=[].concat(f.xy);if(f.xy){d=[],b=[];var g=0,h=0,r=n.length;while(g<r){d[h]=n[g];b[h]=n[g+1];g+=2;h++;f.x=d;f.y=b}}else if(!f.x){d=[];for(var g=0,r=b.length;g<r;g++)d[g]=g;f.x=d}if(t){if(c>0)for(var h=0;h<b.length;h++)b[h]+=q[h];q=[].concat(b)}var i=this._getMinMaxValue(d),j=this._getMinMaxValue(b);if(c==0){a.txx=i.max;a.txn=i.min;a.tyx=j.max;a.tyn=j.min}else{if(a.txx<i.max)a.txx=i.max;if(a.txn>i.min)a.txn=i.min;if(a.tyx<j.max)a.tyx=j.max;if(a.tyn>j.min)a.tyn=j.min}}if(s){a.tyx=1;a.tyn=0}if(d.length)if(isNaN(d[0])){for(var k=[],c=0,o=d.length;c<o;c++){var p={text:d[c],value:c};k.push(p)}e.x.annoMethod="valueLabels";e.x.valueLabels=k;e.x.autoMajor=false;e.x.autoMinor=false;e.x.unitMajor=1;e.x.unitMinor=.5}else if(this._isDate(d[0]))this.axisInfo.x.isTime=true;if(b.length)if(isNaN(b[0])){for(var k=[],c=0,o=b.length;c<o;c++){var p={text:b[c],value:c};k.push(p)}e.y.annoMethod="valueLabels";e.y.valueLabels=k;e.y.autoMajor=false;e.y.autoMinor=false;e.y.unitMajor=1;e.x.unitMinor=.5}else this._isDate(b[0]);return a},_isDate:function(a){return typeof a=="object"&&a.constructor==Date},_getMinMaxValue:function(b){var a={min:0,max:0};if(!b.length)return;if(isNaN(b[0]))if(this._isDate(b[0])){a.min=b[0];a.max=b[0]}else{a.min=0;a.max=b.length-1;return a}else{a.min=b[0];a.max=b[0]}for(var c=0;c<b.length;c++)if(b[c]<a.min)a.min=b[c];else if(b[c]>a.max)a.max=b[c];if(this._isDate(a.min)){a.min=this._toOADate(a.min);a.max=this._toOADate(a.max)}return a},_toOADate:function(b){return(b-new Date(1900,0,1))/this._tmInc.day+2},_fromOADate:function(a){return new Date((a-2)*this._tmInc.day+(new Date(1900,0,1)).getTime())},_isVertical:function(a){return a=="west"||a=="east"},_calculateMajorMinor:function(e,c){var t=e.autoMajor,q=e.autoMinor,m=c.max,n=c.min,r=c.isTime,s=c.tinc;if(t||q){var d=m-n,f=null,g=null,j=a.extend(true,{},this.options.textStyle,e.textStyle,e.labels.style);if(r){var p=c.annoFormatString,u=a.format(this._fromOADate(m),p),v=a.format(this._fromOADate(n),p),l=this._text(-100,-100,u).attr(j),k=this._text(-100,-100,v).attr(j);f=l.wijGetBBox();g=k.wijGetBBox();l.remove();k.remove()}else{var o=this._nicePrecision(d),i=o+1;if(i<0||i>15)i=0;var l=this._text(-100,-100,this.canvas.wij.round(m,i)).attr(j),k=this._text(-100,-100,this.canvas.wij.round(n,i)).attr(j);f=l.wijGetBBox();g=k.wijGetBBox();l.remove();k.remove()}var h=0,b=0;if(f.width<g.width)f.width=g.width;if(f.height<g.height)f.height=g.height;if(!this._isVertical(e.compass)){var x=this.canvasBounds.endX-this.canvasBounds.startX-c.offset-c.axisTextOffset;b=x/f.width;if(Number.POSITIVE_INFINITY==b)h=0;else h=parseInt(b)}else{var w=this.canvasBounds.endY-this.canvasBounds.startY-c.offset-c.axisTextOffset;b=w/f.height;if(Number.POSITIVE_INFINITY==b)h=0;else h=parseInt(b)}b=d;if(h>0){d/=h;if(r)if(d<s)b=s;else b=this._niceTimeUnit(d,c.annoFormatString);else{c.tprec=this._nicePrecision(d);b=this._niceNumber(2*d,-o,true);if(b<d)b=this._niceNumber(d,-o+1,false);if(b<d)b=this._niceTickNumber(d)}}e.unitMajor=b;if(q)e.unitMinor=e.unitMajor/2}},_getScaling:function(b,d,e,c){var a=d-e;if(a==0)a=1;if(b)a=-a;return c/a},_getTranslation:function(d,b,e,f,c){var a=0;if(d){a=b.y;a-=c*e}else{a=b.x;a-=c*f}return a},_addClass:function(c,b){b=b||"";a.each(c,function(){if(isSVGElem(this)){var c=this;a.each(b.split(/\s+/),function(e,d){var b=c.className?c.className.baseVal:c.getAttribute("class");if(a.inArray(d,b.split(/\s+/))==-1){b+=(b?" ":"")+d;c.className?(c.className.baseVal=b):c.setAttribute("class",b)}})}else a(this).addClass(b)})}})})(jQuery);
(function(a){a.widget("ui.wijbarchart",a.ui.wijchartcore,{options:{stacked:false,is100Percent:false,clusterOverlap:0,clusterWidth:85,clusterRadius:0,clusterSpacing:0,animation:{enabled:true,duration:400,easing:"easeOutExpo"}},_create:function(){var b=["0-#8ac4c0-#77b3af","0-#73a19e-#67908e","0-#4f687b-#465d6e","0-#69475b-#5d3f51","0-#7a3b3f-#682e32","0-#9d5b5b-#8c5151","0-#e5a36d-#ce9262","0-#e6cc70-#ceb664","0-#8ec858-#7fb34f","0-#3a9073-#2a7b5f","0-#6c88e3-#6079cb","0-#6cb4e3-#60a0cb"];a.extend(true,this.options.axis,{x:{compass:"west"},y:{compass:"south"}});a.ui.wijchartcore.prototype._create.apply(this,arguments);this.chartElement.addClass("ui-wijbarchart");a.extend(true,{compass:"east"},this.options.hint);a.each(this.options.seriesStyles,function(c,a){if(a.fill==null)a.fill=b[c]})},destroy:function(){this.chartElement.removeClass("ui-wijbarchart ui-helper-reset");a.ui.wijchartcore.prototype.destroy.apply(this,arguments)},getBar:function(a){return this.bars[a]},_get_clusterOverlap:function(a){return a/100},_get_clusterWidth:function(a){return a/100},_adjustToLimits:function(a,c,b){return a<c?c:a>b?b:a},_transformPoints:function(c,d,e,f,b){a.each(b,function(h,a){var b=a.x,g=a.y;a.y=c*b+e;a.x=d*g+f});return b},_paintPlotArea:function(){var f=this.options,M=a.extend(true,{visible:true},f.plotArea);if(!M||!M.visible)return;var u=f.stacked,X=u&&f.is100Percent,x=f.seriesList,t=x.length,J=f.seriesStyles.slice(0,t),I=f.seriesHoverStyles.slice(0,t),j=f.axis.x,k=f.axis.y,q=this._get_clusterOverlap(f.clusterOverlap),W=this._get_clusterWidth(f.clusterWidth),r={x:this.canvasBounds.startX,y:this.canvasBounds.startY},gb=this.canvasBounds.endX-r.x,O=this.canvasBounds.endY-r.y,m={},S=[],C=[],D=1,V=f.clusterSpacing+D,i=null,bb=true;if(bb&&!u){x.reverse();J.reverse();I.reverse()}if(t>0){var v=this._barPointList(x);if(u)v=this._stackValues(v);var N=v.length,fb=this._getMinDX(v),hb=fb*W,B=hb,K=this.canvas.set(),s=f.animation,L=s&&s.enabled,E=this._getScaling(true,j.max,j.min,O),F=this._getScaling(false,k.max,k.min,gb),Q=this._getTranslation(true,r,j.max,j.min,E),R=this._getTranslation(false,r,k.max,k.min,F);m.xscale=E;m.yscale=F;m.xlate=Q;m.ylate=R;if(t>1&&!u){q-=N*(t-1)*V/O;B/=t*(1-q)+q}for(var w=0;w<N;w++){var T=v[w],e=T.paSpec,ib=e.length,H;if(u)H=B;else H=B*(ib*(1-q)+q);for(var h={x:T.x-H/2,y:0,width:B,height:e[0].y},d=0;d<e.length;d++){var y=x[e[d].sIdx],n=J[e[d].sIdx],U=I[e[d].sIdx];if(u)if(X){var z=e[e.length-1].y;if(z>0)h.height=e[d].y/z;if(d>0){h.height-=e[d-1].y/z;h.y=e[d-1].y/z}}else{h.height=e[d].y;if(d>0){h.height-=e[d-1].y;h.y=e[d-1].y}}else if(d>0){h.x+=h.width*(1-q);h.height=e[d].y}var b=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y+h.height}],Y=(j.min<=b[0].x&&b[0].x<=j.max||j.min<=b[1].x&&b[1].x<=j.max)&&(k.min<=b[0].y&&b[0].y<=k.max||k.min<=b[1].y&&b[1].y<=k.max);b[0].x=this._adjustToLimits(b[0].x,j.min,j.max);b[0].y=this._adjustToLimits(b[0].y,k.min,k.max);b[1].x=this._adjustToLimits(b[1].x,j.min,j.mMax);b[1].y=this._adjustToLimits(b[1].y,k.min,k.max);b=this._transformPoints(E,F,Q,R,b);var A=0;if(b[0].x>b[1].x){A=b[0].x;b[0].x=b[1].x;b[1].x=A}if(b[0].y>b[1].y){A=b[0].y;b[0].y=b[1].y;b[1].y=A}var c={x:b[0].x,y:b[0].y,width:b[1].x-b[0].x,height:b[1].y-b[0].y};if(Y){if(c.width==0)c.width=.5;if(c.height==0)c.height=.5}if(m.rects==null)m.rects=[];if(m.rects[d]==null)m.rects[d]=[];m.rects[d][w]=c;var p=null;if(f.showDefaultChartLabels){var Z=a.extend(true,{},f.textStyle,f.chartLabelStyle);p=this._text(c.x+c.width,c.y+c.height/2,e[d].y).attr(Z);var cb=p.getBBox();p.translate(cb.width/2,0);K.push(p)}var l=null,o=n.r?n.r:f.clusterRadius,P=n=a.extend(true,{fill:"#fff","fill-opacity":1,stroke:"#000","stroke-dasharray":"","stroke-opacity":1,"stroke-width":1},n);if(o)P=a.extend(true,{},n,{r:0});var g=n["stroke-width"],eb=n.stroke;if(eb!="none"&&g)g=parseInt(g);if(!g||isNaN(g))g=0;if(L){if(o){l=this.canvas.wij.roundRect(c.x,c.y,c.width-g,c.height-g,0,0,o,o).hide();i=this.canvas.rect(r.x,c.y,0,c.height-g);this._paintShadow(i,D);i.wijAttr(P);i.bar=l}else{l=this.canvas.rect(r.x,c.y,0,c.height-g);i=l}if(p){p.attr({opacity:0});i.chartLabel=p}i.left=c.x;i.width=c.width-g;i.r=o}else if(o)l=this.canvas.wij.roundRect(c.x,c.y,c.width-g,c.height-g,0,0,o,o);else l=this.canvas.rect(c.x,c.y,c.width-g,c.height-g);this._paintShadow(l,D);l.wijAttr(n);y.type="bar";y.style=n;y.hoverStyle=U;this._addClass(a(l.node),"wijchart-canvas-object");a(l.node).data("wijchartDataObj",a.extend(true,{index:w,bar:l},y));S.push(l);C.push(i)}}this.chartElement.data("plotInfos",m);a.each(K,function(b,a){a.toFront()})}if(L)for(var ab=s.duration?s.duration:2e3,db=s.easing?s.easing:"linear",G=0;G<C.length;G++){i=C[G];i.wijAnimate({width:i.width,x:i.left},ab,db,function(){var a=this,c=a.r,b=a;a.chartLabel&&a.chartLabel.animate({opacity:1},250);if(c){b=a.bar;b.show();if(a.shadow){a.shadow.remove();a.shadow=null}a.remove();a=null}})}this.bars=S},_getChartLabelPointPosition:function(i){var n=this.options,l=i.attachMethod,d=i.attachMethodData,f={x:0,y:0},a=null,e=null,g=null,b=null,c=null;switch(l){case"coordinate":f.x=d.x;f.y=d.y;break;case"dataCoordinate":a=this.chartElement.data("plotInfos");b=d.x;c=d.y;if(this._isDate(b))b=this._toOADate(b);if(this._isDate(c))c=this._toOADate(c);f=this._transformPoints(a.xscale,a.yscale,a.xlate,a.ylate,{x:b,y:c});break;case"dataIndex":e=d.seriesIndex;g=d.pointIndex;a=this.chartElement.data("plotInfos");if(e>-1){var j=a.rects;if(j.length>e){var m=j[e],h=m[g];f.x=h.x+h.width;f.y=h.y+h.height/2}}break;case"dataIndexY":e=d.seriesIndex;g=d.pointIndex;if(e>-1){var k=n.seriesList[e].data;b=k.x[g];c=d.y;a=this.chartElement.data("plotInfos");if(this._isDate(b))b=this._toOADate(b);if(this._isDate(c))c=this._toOADate(c);f=this._transformPoints(a.xscale,a.yscale,a.xlate,a.ylate,{x:b,y:c})}}return f},_bindLiveEvents:function(){var c=this.options,b=this,d={mousedown:function(b){this._trigger("mousedown",b,a(b.target).data("wijchartDataObj"))},mouseup:function(b){this._trigger("mouseup",b,a(b.target).data("wijchartDataObj"))},mouseover:function(b){this._trigger("mouseover",b,a(b.target).data("wijchartDataObj"))},mouseout:function(b){this._trigger("mouseout",b,a(b.target).data("wijchartDataObj"))},mousemove:function(b){this._trigger("mousemove",b,a(b.target).data("wijchartDataObj"))},click:function(b){this._trigger("click",b,a(b.target).data("wijchartDataObj"))}};a(".wijchart-canvas-object",this.chartElement[0]).live("mousedown.wijbarchart",a.proxy(d.mousedown,this)).live("mouseup.wijbarchart",a.proxy(d.mouseup,this)).live("mouseover.wijbarchart",a.proxy(d.mouseover,this)).live("mouseout.wijbarchart",a.proxy(d.mouseout,this)).live("mousemove.wijbarchart",a.proxy(d.mousemove,this)).live("click.wijbarchart",a.proxy(d.click,this));a(".wijchart-canvas-object",this.chartElement[0]).live("mouseout.wijbarchart",function(){var c=a(this).data("wijchartDataObj"),d=c.bar;if(!c.hoverStyle)d&&d.attr({opacity:"1"});else d.attr(c.style);b.tooltipEle&&b.tooltipEle.hide()});a(".wijchart-canvas-object",this.chartElement[0]).live("mousemove.wijbarchart",function(p){var e=a(this).data("wijchartDataObj"),k=e.bar;if(!e.hoverStyle)k&&k.attr({opacity:"0.8"});else k.attr(e.hoverStyle);if(c.hint.enable){if(!b.tooltipEle)b.tooltipEle=b.canvas.wij.tooltip(b);var h=e.index,d=e.data,l=b.chartElement.offset(),m={x:p.pageX,y:p.pageY},j,g;if(d.x){j=d.x[h];g=d.y[h]}else{j=d.xy[2*h];g=d.xy[2*h+1]}d={data:e,content:"",cancel:false,offset:c.hint.offset||3,compass:c.hint.compass,showDelay:c.hint.showDelay,hideDelay:c.hint.hideDelay,textStyle:c.hint.textStyle,duration:c.hint.duration,easing:c.hint.easing,style:c.hint.style,x:j,y:g,index:h};var q={x:m.x-l.left+d.offset,y:m.y-l.top-d.offset};b.element.trigger("hintShowing",d);if(!d.cancel){var f=d.content,i=c.hint.formatter;if(!f)if(i===null)f=g;else if(a.isFunction(i)){var o={x:j,y:g,data:e,fmt:i},r=a.proxy(o.fmt,o);f=r()}else f=i;var n=e.style;b.tooltipEle.showDelay=d.showDelay;b.tooltipEle.hideDelay=d.hideDelay;b.tooltipEle.duration=d.duration;b.tooltipEle.easing=d.easing;b.tooltipEle.textAttr=a.extend(true,{},c.textStyle,d.textStyle);b.tooltipEle.rectAttr=a.extend({stroke:n.stroke||n.fill,"stroke-opacity":"0.9"},d.style);b.tooltipEle.text=f;b.tooltipEle.offset=d.offset;b.tooltipEle.compass=d.compass;b.tooltipEle.showAt(q,200);b._trigger("hintshown",null,d)}}})},_unbindLiveEvents:function(){a(".wijchart-canvas-object",this.chartElement[0]).die("wijbarchart")},_calculateParameters:function(c,e){a.ui.wijchartcore.prototype._calculateParameters.apply(this,arguments);if(c.id=="x"){var d=e.unitMinor,g=e.autoMin,f=e.autoMax,b=this._getBarAdjustment(c);if(b==0)b=d;else if(d<b&&d!=0)b=Math.floor(b/d)*d;if(g)c.min-=b;if(f)c.max+=b;this._calculateMajorMinor(e,c)}},_getBarAdjustment:function(c){for(var a=0,h=this.options,d=c.max,b=c.min,f=h.seriesList,e=0;e<f.length;e++){var g=f[e].data.x.length;if(a<g)a=g}if(a>1)return(d-b)/a*h.clusterWidth*.0125;else if(a==1){if(b==0&&d==1){b=-1;c.min=b}return(d-b)*.0125}else return 0}});a.extend(a.ui.wijbarchart.prototype,{_barPointList:function(f){var b=[],d=this._getXSortedPoints;function c(a){this.x=a;this.paSpec=[];this.stackValues=function(){var b=this.paSpec.length;if(b>1)for(var c=this.paSpec[0],a=1;a<b;a++){var d=this.paSpec[a];d.y+=c.y;c=d}}}function e(o,m){var e=d(m),l=m.length,g=null,n=0;if(e!=null)n=e.length;var f=0,h=0;if(b!=null)h=b.length;for(var k=true,i=0,j=false,a=0;a<n;a++){if(k){k=false;i=e[a].x}else{if(i==e[a].x)j=true;else j=false;i=e[a].x}while(f<h&&b[f].x<e[a].x)f++;if(f<h)if(b[f].x!=e[a].x){g=new c(e[a].x,l);b.splice(f,0,g);h=b.length}else g=b[f];else{g=new c(e[a].x,l);b.push(g);h=b.length}g.paSpec.push({y:e[a].y,sIdx:o,pIdx:a,dupl:j})}}a.each(f,function(b,a){e(b,a)});return b},_getSpecWithValue:function(a){for(var d=a.length,b=0;b<d;b++){var c=a[b];if(c.x>=a)return c.x==a?c:null}return null},_getMinDX:function(d){for(var a=Number.MAX_VALUE,e=d.length,b=1;b<e;b++){var c=d[b].x-d[b-1].x;if(c<a&&c>0)a=c}return a==Number.MAX_VALUE?2:a},_stackValues:function(b){a.each(b,function(b,a){a.stackValues()});return b}})})(jQuery);
Raphael.fn.tri=function(b,c,e){var g=b,j=c-e,a=Math.cos(30*Math.PI/180)*e,d=Math.tan(60*Math.PI/180)*a,h=b+a,k=c+d,i=b-a,l=c+d,f=["M",g,j,"L",h,k,"L",i,l,"z"];return this.path(f.concat(" "))};Raphael.fn.invertedTri=function(b,c,e){var g=b,j=c+e,a=Math.cos(30*Math.PI/180)*e,d=Math.tan(60*Math.PI/180)*a,h=b+a,k=c-d,i=b-a,l=c-d,f=["M",g,j,"L",h,k,"L",i,l,"z"];return this.path(f.concat(" "))};Raphael.fn.box=function(b,c,e){var a=Math.cos(45*Math.PI/180)*e,d=["M",b-a,c-a,"L",b+a,c-a,"L",b+a,c+a,"L",b-a,c+a,"z"];return this.path(d.concat(" "))};Raphael.fn.diamond=function(b,c,a){var d=["M",b,c-a,"L",b+a,c,"L",b,c+a,"L",b-a,c,"z"];return this.path(d.concat(" "))};Raphael.fn.cross=function(b,c,e){var a=Math.cos(45*Math.PI/180)*e,d=["M",b-a,c-a,"L",b+a,c+a,"M",b-a,c+a,"L",b+a,c-a];return this.path(d.concat(" "))};(function(a){a.widget("ui.wijlinechart",a.ui.wijchartcore,{options:{animation:{enabled:true,duration:2e3},zoomOnHover:true},_create:function(){a.ui.wijchartcore.prototype._create.apply(this,arguments);this.chartElement.addClass("ui-wijlinechart");this.paths=[];this.shadowPaths=[];this.markersSet=[];this.animationSet=this.canvas.set();this.symbols=[];this.hoverPoint=null;this.hoverLine=null;this.linesStyle=[];this.shadow=true},destroy:function(){this.chartElement.removeClass("ui-wijlinechart");a.ui.wijchartcore.prototype.destroy.apply(this,arguments)},getLinePath:function(a){return this.paths[a]},getLineMarkers:function(a){var b=this.options;if(b.seriesList&&b.seriesList[a].markers&&b.seriesList[a].markers.visible)return this.markersSet[a];else{var c;return c}},_getAnchors:function(f,g,a,b,h,i){var j=(a-f)/2,k=(h-a)/2,c=Math.atan((a-f)/Math.abs(b-g)),d=Math.atan((h-a)/Math.abs(b-i));c=g<b?Math.PI-c:c;d=i<b?Math.PI-d:d;var e=Math.PI/2-(c+d)%(Math.PI*2)/2,l=j*Math.sin(e+c),n=j*Math.cos(e+c),m=k*Math.sin(e+d),o=k*Math.cos(e+d);return{x1:a-l,y1:b+n,x2:a+m,y2:b+o}},_paintLegend:function(){var g=this.options;a.extend(true,g,{legend:{size:{width:30,height:3}}});a.ui.wijchartcore.prototype._paintLegend.apply(this,arguments);if(g.legend.visible){if(this.legends.length&&this.legendIcons.length)for(var b=0,n=this.legendIcons.length;b<n;b++){var j=this.legendIcons[b];j.attr({fill:j.attr("stroke")})}var i=g.seriesList,l=g.seriesStyles,m=0;if(!g.legend.reversed)for(var b=0,n=i.length;b<n;b++){var c=i[b],h=l[b];if(c.legendEntry){if(c.markers&&c.markers.visible){var j=this.legendIcons[b],d=j.wijGetBBox(),o=d.x+d.width/2,p=d.y+d.height/2,e=c.markerStyle;e=a.extend({fill:h.stroke,stroke:h.stroke,opacity:1},e);var f=c.markers.type;if(!f)f="circle";var k=this._paintMarker(f,o,p,3);k.attr(e);this.legendEles.push(k)}m++}}else for(var b=i.length-1;b>=0;b--){var c=i[b],h=l[b];if(c.legendEntry&&c.markers.visible){if(c.markers.visible){var j=this.legendIcons[b],d=j.wijGetBBox(),o=d.x+d.width/2,p=d.y+d.height/2,e=c.markerStyle;e=a.extend({fill:h.stroke,stroke:h.stroke,opacity:1},e);var f=c.markers.type;if(!f)f="circle";var k=this._paintMarker(f,o,p,3);k.attr(e)}m++}}}},_clearChartElement:function(){this.linesStyle=[];if(this.paths.length){for(var b=0,c=this.paths.length;b<c;b++)this.paths[b].remove();this.paths=[]}if(this.shadowPaths.length){for(var b=0,c=this.shadowPaths.length;b<c;b++)this.shadowPaths[b].remove();this.shadowPaths=[]}if(this.markersSet.length){for(var b=0,c=this.markersSet.length;b<c;b++)for(var e=this.markersSet[b],d=0,f=e.length;d<f;d++)e[d].remove();this.markersSet=[]}if(this.animationSet.length){for(var b=0,c=this.animationSet.length;b<c;b++)this.animationSet[b].remove();this.animationSet=this.canvas.set()}if(this.symbols.length){for(var b=0,c=this.symbols.length;b<c;b++)this.symbols[b].remove();this.symbols=[]}a.ui.wijchartcore.prototype._clearChartElement.apply(this,arguments)},_paintMarker:function(e,c,d,b){var a=null;switch(e){case"circle":a=this.canvas.circle(c,d,b);break;case"tri":a=this.canvas.tri(c,d,b);break;case"invertedTri":a=this.canvas.invertedTri(c,d,b);break;case"box":a=this.canvas.box(c,d,b);break;case"diamond":a=this.canvas.diamond(c,d,b);break;case"cross":a=this.canvas.cross(c,d,b)}return a},_paintPlotArea:function(){var y=this,j=y.options,e=y.canvasBounds,H=e.endX-e.startX,x=e.endY-e.startY,N=j.seriesList,W=j.seriesStyles;this.plotInfos=[];for(var k=0,cb=N.length;k<cb;k++){var b=N[k],X=W[k];b=a.extend(true,{fitType:"line",markers:{visible:false,type:"circle"},visible:true},b);var Q=b.data,s=a.extend({stroke:"black",opacity:1,fill:"none","stroke-width":2,"stroke-linejoin":"round","stroke-linecap":"round"},X),r=b.markerStyle;r=a.extend({fill:s.stroke,stroke:s.stroke,opacity:1,width:3},r);var C=Q.x,w=Q.y,m=j.axis.x.min,t=j.axis.y.min,U=j.axis.x.max,V=j.axis.y.max,q=H/(U-m),J=x/(V-t),ab={minX:m,minY:t,maxX:U,maxY:V,width:H,height:x};this.plotInfos.push(ab);var n=this.canvas.set(),f=[],B=b.fitType,O=false;if(b.markers.symbol&&b.markers.symbol.length)O=true;for(var R=this.axisInfo.x.isTime,S=this.axisInfo.y.isTime,u=this.canvas.set(),c=0,I=w.length;c<I;c++){var p=C[c];if(R)p=this._toOADate(p);var z=w[c];if(S)z=this._toOADate(z);if(p==undefined)break;var d=0;if(isNaN(p))d=e.startX+(c-m)*q;else d=e.startX+(p-m)*q;var g=e.endY-(z-t)*J;if(B=="line")f=f.concat([c?"L":"M",d,g]);else if(B=="spline")if(!c)f=["M",d,g,"C",d,g];else if(c&&c<I-1){var F=w[c-1],G=w[c+1];if(S){F=this._toOADate(F);G=this._toOADate(G)}var eb=e.endY-(F-t)*J,K=0,fb=e.endY-(G-t)*J,L=0;if(isNaN(p)){K=e.startX+(c-1-m)*q;L=e.startX+(c+1-m)*q}else{var D=C[c-1],E=C[c+1];if(R){D=this._toOADate(D);E=this._toOADate(E)}K=e.startX+(D-m)*q;L=e.startX+(E-m)*q}var A=this._getAnchors(K,eb,d,g,L,fb);f=f.concat([A.x1,A.y1,d,g,A.x2,A.y2])}else f=f.concat([d,g,d,g]);else if(B=="bezier")if(!c)f=f.concat(["M",d,g]);else if(c==I-1&&c%2==1)f=f.concat(["Q",d,g,d,g]);else if(c%2==0)f=f.concat([d,g]);else f=f.concat(["Q",d,g]);if(j.showDefaultChartLabels){var v=this.canvas.text(d,g,z);this.chartLabelEles.push(v);var bb=v.wijGetBBox();v.translate(0,-bb.height);u.push(v)}var i=null,P=false;if(O)for(var T=b.markers.symbol,M=0,db=T.length;M<db;M++){var o=T[M];if(o.index==c){i=this.canvas.image(o.url,d-o.width/2,g-o.height/2,o.width,o.height);this.symbols.push(i);P=true;break}}if(i==null){var Z=b.markers.type,Y=r.width;i=this._paintMarker(Z,d,g,Y);b.markers.visible&&i.attr(r)}this._addClass(a(i.node),"wijchart-canvas-object wijchart-canvas-marker");var l={};l.marker=i;l.index=c;l.type="marker";l.lineSeries=b;l.x=d;l.y=g;l.isSymbol=P;a(i.node).data("wijchartDataObj",l);n.push(i);this.animationSet.push(i)}var h=this.canvas.path(f.join(" "));this._paintShadow(h);h.wijAttr(s);this.paths[k]=h;if(h.shadow)this.shadowPaths[k]=h.shadow;this.animationSet.push(h);this.linesStyle[k]={lineStyle:s,markerStyle:r};!b.markers.visible&&n.hide();if(!b.visible){h.hide();h.shadow&&h.shadow.hide()}b.markers.style&&n.attr(b.markers.style);n.toFront();if(u.length){u.attr(j.chartLabelStyle);u.toFront()}this.markersSet[k]=n;b.index=k;b.type="line";b.path=h;b.lineMarkers=n;b.lineStyle=s;this._addClass(a(h.node),"wijchart-canvas-object");a(h.node).data("wijchartDataObj",b)}if(j.animation.enabled){this.animationSet.wijAttr("clip-rect",e.startX+" "+e.startY+" 0 "+x);this.animationSet.wijAnimate({"clip-rect":e.startX+" "+e.startY+" "+H+" "+x},j.animation.duration,function(){if(Raphael.vml)for(var c=0,g=y.animationSet.length;c<g;c++){var b=y.animationSet[c];if(b.node.clipRect){var e=b.attrs;delete e["clip-rect"];b.node.clipRect=null;var f=a(b.node).parent(),d=f.parent();d.before(f);d.remove();b.attr(e)}}})}},_getChartLabelPointPosition:function(l){var m=this.options,n=l.attachMethod,e=l.attachMethodData,f={x:0,y:0};switch(n){case"coordinate":f.x=e.x;f.y=e.y;break;case"dataCoordinate":var d=e.seriesIndex;if(d>-1){var g=this.plotInfos;if(g.length>d){var b=e.x,c=e.y;if(this._isDate(b))b=this._toOADate(b);if(this._isDate(c))c=this._toOADate(c);var a=g[d],j=a.width/(a.maxX-a.minX);f.x=this.canvasBounds.startX+(b-a.minX)*j;var k=a.height/(a.maxY-a.minY);f.y=this.canvasBounds.startY+a.height-(c-a.minY)*k}}break;case"dataIndex":var d=e.seriesIndex,h=e.pointIndex,i=m.seriesList[d].data,b=i.x[h],c=i.y[h];if(this._isDate(b))b=this._toOADate(b);if(this._isDate(c))c=this._toOADate(c);if(d>-1){var g=this.plotInfos;if(g.length>d){var a=g[d],j=a.width/(a.maxX-a.minX);f.x=this.canvasBounds.startX+(b-a.minX)*j;var k=a.height/(a.maxY-a.minY);f.y=this.canvasBounds.startY+a.height-(c-a.minY)*k}}break;case"dataIndexY":var d=e.seriesIndex,h=e.pointIndex,i=m.seriesList[d].data,b=i.x[h],c=e.y;if(this._isDate(b))b=this._toOADate(b);if(this._isDate(c))c=this._toOADate(c);if(d>-1){var g=this.plotInfos;if(g.length>d){var a=g[d],j=a.width/(a.maxX-a.minX);f.x=this.canvasBounds.startX+(b-a.minX)*j;var k=a.height/(a.maxY-a.minY);f.y=this.canvasBounds.startY+a.height-(c-a.minY)*k}}}return f},_bindLiveEvents:function(){var b=this,e=false,d={element:this.chartElement,mousedown:function(c){var f=a(c.target),d=a(c.target).data("wijchartDataObj");if(f.hasClass("wijchart-canvas-marker")){var e=d.lineSeries;if(!e.markers.visible)b._trigger("mousedown",c,e);else b._trigger("mousedown",c,d)}else b._trigger("mousedown",c,d)},mouseup:function(c){var f=a(c.target),d=a(c.target).data("wijchartDataObj");if(f.hasClass("wijchart-canvas-marker")){var e=d.lineSeries;if(!e.markers.visible)b._trigger("mouseup",c,e);else b._trigger("mouseup",c,d)}else b._trigger("mouseup",c,d)},mouseover:function(g){var j=a(g.target),c=a(g.target).data("wijchartDataObj"),i=b.options.zoomOnHover;if(j.hasClass("wijchart-canvas-marker")){var d=c.lineSeries;if(!d.markers.visible)b._trigger("mouseover",g,d);else b._trigger("mouseover",g,c);if(!(b.hoverLine==d)){e=true;if(i){if(b.hoverLine!=null){var h=b.hoverLine.index,f=b.linesStyle[h];b.hoverLine.path.wijAttr({"stroke-width":parseInt(f.lineStyle["stroke-width"])});if(b.hoverPoint!=null&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr({stroke:f.markerStyle.stroke});b.hoverPoint.marker.scale(1,1)}}var h=d.index,f=b.linesStyle[h].lineStyle;d.path.wijAttr({"stroke-width":parseInt(f["stroke-width"])+1})}b.hoverLine=d;b.hoverPoint=null}}else{b._trigger("mouseover",g,c);if(c.type=="line")if(!(b.hoverLine==c)){e=true;if(i){if(b.hoverLine!=null){var h=b.hoverLine.index,f=b.linesStyle[h];b.hoverLine.path.wijAttr({"stroke-width":parseInt(f.lineStyle["stroke-width"])});if(b.hoverPoint!=null&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr({stroke:f.markerStyle.stroke});b.hoverPoint.marker.scale(1,1)}}var h=c.index,f=b.linesStyle[h].lineStyle;c.path.wijAttr({"stroke-width":parseInt(f["stroke-width"])+1})}b.hoverLine=c;b.hoverPoint=null}}},mouseout:function(c){var f=a(c.target),d=a(c.target).data("wijchartDataObj");if(f.hasClass("wijchart-canvas-marker")){var e=d.lineSeries;if(!e.markers.visible)b._trigger("mouseout",c,e);else b._trigger("mouseout",c,d)}else b._trigger("mouseout",c,d)},mousemove:function(c){var f=a(c.target),d=a(c.target).data("wijchartDataObj");if(f.hasClass("wijchart-canvas-marker")){var e=d.lineSeries;if(!e.markers.visible)b._trigger("mousemove",c,e);else b._trigger("mousemove",c,d)}else b._trigger("mousemove",c,d)},click:function(c){var f=a(c.target),d=a(c.target).data("wijchartDataObj");if(f.hasClass("wijchart-canvas-marker")){var e=d.lineSeries;if(!e.markers.visible)b._trigger("click",c,e);else b._trigger("click",c,d)}else b._trigger("click",c,d)}},i=this.options,c=i.hint;a(".wijchart-canvas-object",this.chartElement[0]).live("mousedown.wijliechart",a.proxy(d.mousedown,d)).live("mouseup.wijliechart",a.proxy(d.mouseup,d)).live("mouseover.wijliechart",a.proxy(d.mouseover,d)).live("mouseout.wijliechart",a.proxy(d.mouseout,d)).live("mousemove.wijliechart",a.proxy(d.mousemove,d)).live("click.wijliechart",a.proxy(d.click,d));if(c.enable)if(!this.tooltipEle)this.tooltipEle=this.canvas.wij.tooltip(this);var f=b.canvasBounds,h=b.chartElement.offset(),g=i.zoomOnHover;this.chartElement.bind("mousemove",function(z){var n={left:z.pageX-h.left,top:z.pageY-h.top};if(n.left>=f.startX&&n.left<=f.endX&&n.top>=f.startY&&n.top<=f.endY){if(b.hoverLine!=null){if(e){c.enable&&b.tooltipEle.hide(0);e=false}for(var s=b.hoverLine.lineMarkers,i=-1,r=0,j={x:0,y:0},l=0,D=s.length;l<D;l++){var A=s[l],k=A.wijGetBBox(),w=k.x+k.width/2,v=Math.abs(w-n.left);if(l==0){r=v;i=l;j={x:w,y:k.y+k.height/2}}else if(v<r){r=v;i=l;j={x:w,y:k.y+k.height/2}}}if(b.hoverPoint!=null&&b.hoverPoint.index==i)return;if(i>-1){var j=a(s[i].node).data("wijchartDataObj");if(g){if(b.hoverPoint!=null&&!b.hoverPoint.isSymbol){var B=b.hoverLine.index,u=b.linesStyle[B];b.hoverPoint.marker.wijAttr({stroke:u.markerStyle.stroke});b.hoverPoint.marker.scale(1,1)}if(!j.isSymbol){j.marker.wijAttr({stroke:"white"});j.marker.scale(1.5,1.5)}}b.hoverPoint=j}if(c.enable){var p,q,m=b.hoverLine.data;if(m.x){p=m.x[i];q=m.y[i]}else{p=m.xy[2*i];q=m.xy[2*i+1]}var x=b.hoverPoint,d={data:x,content:"",cancel:false,offset:c.offset,compass:c.compass,showDelay:c.showDelay,hideDelay:c.hideDelay,textStyle:c.textStyle,duration:c.duration,easing:c.easing,style:c.style,x:p,y:q,index:i};b._trigger("hintshowing",null,d);if(!d.cancel){var o=d.content,t=c.formatter;if(!o)if(a.isFunction(t)){var y={x:p,y:q,data:x,fmt:t},C=a.proxy(y.fmt,y);o=C()}else o=t;b.tooltipEle.showDelay=d.showDelay;b.tooltipEle.hideDelay=d.hideDelay;b.tooltipEle.duration=d.duration;b.tooltipEle.easing=d.easing;b.tooltipEle.textAttr=d.textStyle;b.tooltipEle.rectAttr=a.extend({stroke:b.hoverLine.path.attr("stroke")},d.style);b.tooltipEle.text=o;b.tooltipEle.offset=d.offset;b.tooltipEle.compass=d.compass;b.tooltipEle.showAt(j);b._trigger("hintshown",null,d)}}}}else{c.enable&&b.tooltipEle.hide();if(g)if(b.hoverLine!=null){var i=b.hoverLine.index,u=b.linesStyle[i];b.hoverLine.path.wijAttr({"stroke-width":parseInt(u.lineStyle["stroke-width"])});if(b.hoverPoint!=null&&!b.hoverPoint.isSymbol){b.hoverPoint.marker.wijAttr({stroke:u.markerStyle.stroke});b.hoverPoint.marker.scale(1,1)}}b.hoverLine=null;b.hoverPoint=null}})},_unbindLiveEvents:function(){a(".wijchart-canvas-object",this.chartElement[0]).die("wijlinechart")}})})(jQuery);
(function(a){a.widget("ui.wijpiechart",a.ui.wijchartcore,{options:{radius:null,innerRadius:0},_create:function(){var b=["0-#8ac4c0-#77b3af","0-#73a19e-#67908e","0-#4f687b-#465d6e","0-#69475b-#5d3f51","0-#7a3b3f-#682e32","0-#9d5b5b-#8c5151","0-#e5a36d-#ce9262","0-#e6cc70-#ceb664","0-#8ec858-#7fb34f","0-#3a9073-#2a7b5f","0-#6c88e3-#6079cb","0-#6cb4e3-#60a0cb"];a.ui.wijchartcore.prototype._create.apply(this,arguments);this.chartElement.addClass("ui-wijpiechart");a.each(this.options.seriesStyles,function(c,a){if(a.fill==null)a.fill=b[c]})},destroy:function(){this.chartElement.removeClass("ui-wijpiechart ui-helper-reset");a.ui.wijchartcore.prototype.destroy.apply(this,arguments)},getSector:function(a){return this.sectors[a]},_paintPlotArea:function(){var b=this.options,i=this.canvasBounds.endX-this.canvasBounds.startX,h=this.canvasBounds.endY-this.canvasBounds.startY;if(!b.radius)b.radius=Math.min(i,h)/2;else{if(i<2*b.radius)b.radius=i/2;if(h<2*b.radius)b.radius=h/2}this.canvasBounds.startX+=i/2-b.radius;this.canvasBounds.endX=this.canvasBounds.startX+2*b.radius;this.canvasBounds.startY+=h/2-b.radius;this.canvasBounds.endY=this.canvasBounds.startY+2*b.radius;for(var f=b.seriesList,m=b.seriesStyles,j=0,g=0;g<f.length;g++)if(f[g]!=null&&typeof f[g].data=="number")j+=f[g].data;var k=[],c=0,d=this.canvas,e=b.radius,n=this.canvasBounds.startX,o=this.canvasBounds.startY;this.total=j;var l=this;a.each(f,function(t,g){var q=a.extend({opacity:1,stroke:"gray","stroke-width":1},m[t]),p=360*g.data/j,h=n+e,i=o+e;if(g.offset){var r=d.wij.getPositionByAngle(h,i,g.offset,c+p/2);h=r.x;i=r.y}var f=null;if(b.innerRadius){f=d.wij.donut(h,i,e,b.innerRadius,c,c+p);f.innerRadius=b.innerRadius}else f=d.wij.sector(h,i,e,c,c+p);l._paintShadow(f);f.wijAttr(q);f.angles={start:c,end:c+p};f.getOffset=function(b){var a=d.wij.getPositionByAngle(h,i,b,(f.angles.start+f.angles.end)/2);return{x:a.x-h,y:a.y-i}};f.center={x:h,y:i};f.radius=e;l._addClass(a(f.node),"wijchart-canvas-object");a(f.node).data("wijchartDataObj",g);if(b.showDefaultChartLabels){var s=d.wij.getPositionByAngle(h,i,g.offset+e*2/3,c+p/2),u=a.extend(true,{},b.textStyle,b.chartLabelStyle);d.text(s.x,s.y,g.label).attr(u)}k.push(f);g.style=q;g.index=t;g.type="pie";c+=p});this.sectors=k},_paintChartLabels:function(){var f=this.options,b=f.chartLabels;if(b&&b.length)for(var d=0,n=f.radius,m=0,u=b.length;m<u;m++){var k=this.canvasBounds.startX+n,l=this.canvasBounds.startY+n,c=a.extend(true,{compass:"east",attachMethod:"coordinate",attachMethodData:{seriesIndex:-1,x:-1,y:-1},offset:0,visible:false,text:"",connected:false},b[m]);if(c.visible){var r=c.attachMethod,t=c.attachMethodData,e={x:0,y:0},i=0,q=null;if(r=="dataIndex"){var g=t.seriesIndex;if(g>-1){var j=f.seriesList[g],s=j.data,h=360*s/this.total,o=f.seriesStyles[g];q={stroke:o.stroke||o.fill};i=d+h/2;if(j.offset){var p=this.canvas.wij.getPositionByAngle(k,l,j.offset,d+h/2);k=p.x;l=p.y}e=this.canvas.wij.getPositionByAngle(k,l,n,i);d=d+h}}if(isNaN(e.x)||isNaN(e.y))break;this._setChartLabel(c,e,i,q)}}},_bindLiveEvents:function(){var d={mousedown:function(b){this._trigger("mousedown",b,a(b.target).data("wijchartDataObj"))},mouseup:function(b){this._trigger("mouseup",b,a(b.target).data("wijchartDataObj"))},mouseover:function(b){this._trigger("mouseover",b,a(b.target).data("wijchartDataObj"))},mouseout:function(b){this._trigger("mouseout",b,a(b.target).data("wijchartDataObj"))},mousemove:function(b){this._trigger("mousemove",b,a(b.target).data("wijchartDataObj"))},click:function(b){this._trigger("click",b,a(b.target).data("wijchartDataObj"))}},c=this.options;a(".wijchart-canvas-object",this.chartElement[0]).live("mousedown.wijpiechart",a.proxy(d.mousedown,this)).live("mouseup.wijpiechart",a.proxy(d.mouseup,this)).live("mouseover.wijpiechart",a.proxy(d.mouseover,this)).live("mouseout.wijpiechart",a.proxy(d.mouseout,this)).live("mousemove.wijpiechart",a.proxy(d.mousemove,this)).live("click.wijpiechart",a.proxy(d.click,this));if(c.hint.enable){if(!this.tooltipEle)this.tooltipEle=this.canvas.wij.tooltip(this);var b=this;a(".wijchart-canvas-object",this.chartElement[0]).live("mousemove.wijpiechart",function(l){var d=a(this).data("wijchartDataObj"),m=d.index,g=b.chartElement.offset(),j=d.data,h={x:l.pageX,y:l.pageY};data={data:d,content:"",cancel:false,offset:c.hint.offset||3,compass:c.hint.compass,showDelay:c.hint.showDelay,hideDelay:c.hint.hideDelay,textStyle:c.hint.textStyle,duration:c.hint.duration,easing:c.hint.easing,style:c.hint.style,value:j,index:m};var n={x:h.x-g.left+data.offset,y:h.y-g.top-data.offset};b.element.trigger("hintShowing",data);if(!data.cancel){var e=data.content,f=c.hint.formatter;if(!e)if(a.isFunction(f)){var k={value:j,total:b.total,data:d,fmt:f},o=a.proxy(k.fmt,k);e=o()}else e=f;var i=d.style;b.tooltipEle.showDelay=data.showDelay;b.tooltipEle.hideDelay=data.hideDelay;b.tooltipEle.duration=data.duration;b.tooltipEle.easing=data.easing;b.tooltipEle.textAttr=a.extend(true,{},c.textStyle,data.textStyle);b.tooltipEle.rectAttr=a.extend({stroke:i.stroke||i.fill,"stroke-opacity":"0.9"},data.style);b.tooltipEle.text=e;b.tooltipEle.offset=data.offset;b.tooltipEle.compass=data.compass;b.tooltipEle.showAt(n,200);b._trigger("hintshown",null,data)}});a(".wijchart-canvas-object",this.chartElement[0]).live("mouseout.wijpiechart",function(){b.tooltipEle.hide()})}},_unbindLiveEvents:function(){a(".wijchart-canvas-object",this.chartElement[0]).die("wijpiechart")}})})(jQuery);
(function(a){a.widget("ui.wijtree",{options:{accessKey:"",allowDrag:false,allowDrop:false,allowEdit:false,allowSorting:true,allowTriState:true,autoCheckNodes:true,autoCollapse:false,disabled:false,expandCollapseHoverUsed:false,showCheckBoxes:false,showExpandCollapse:true,expandAnimation:{effect:"blind",easing:"easeOutExpo",duration:200},expandDelay:0,collapseAnimation:{effect:"blind",easing:"easeOutExpo",duration:200},collapseDelay:0},_create:function(){this._initState();this._createTree();this._attachEvent();this._attachNodeEvent()},_init:function(){},_setOption:function(e,c){var b=this,d=false;switch(e){case"allowDrag":b._setAllowDrag(c);break;case"allowDrop":b._setAllowDrop(c);break;case"showCheckBoxes":b._setCheckBoxes(c);break;case"showExpandCollapse":if(b.options.showExpandCollapse!=c)d=true}a.Widget.prototype._setOption.apply(b,arguments);d==true&&b._setHitArea(c)},_initState:function(){this._selectedNodes=[];this._checkedNodes=[];this._enabled=true;this._insertPosition="unKnown"},_createTree:function(){var b=this,d=b.options,c=[];if(b.element.is("ul")){b.element.wrap("<div></div>");b.widgetDom=b.element.parent();b.widgetDom.addClass("ui-wijtree ui-widget ui-widget-content ui-helper-clearfix ui-corner-all");b.element.addClass("ui-wijtree-list ui-helper-reset");b.element.children("li").each(function(){var f=a(this);b._createNodeWidget(f,d);var e=b._getNodeWidget(a(this));c.push(e)});b._hasChildren=c.length>0;b._setField("nodes",c);b.nodes=c;b.widgetDom.append(a("<div>").css("clear","both"))}},_createNodeWidget:function(b,c){if(a.fn.wijtreenode){b.data("owner",this);b.wijtreenode(c)}return b},_attachEvent:function(){var b=this;b.element.bind(a.browser.msie?"focusin.":"focus."+b.widgetName,a.proxy(b._onFocus,b)).bind("mouseover."+this.widgetName,a.proxy(b._onMouseOver,b));b.options.allowDrop&&b._attachDroppable()},_attachDroppable:function(){var b=this;b.widgetDom.droppable({drop:function(n,l){var c=l.draggable,e=b._getNodeWidget(c);if(e){var f=e._dropTarget;if(f){var d=e._insertPosition;if(f&&d!="unKnown"){var g=c.data("owner");g&&g.remove(c);if(!g.element.is(":ui-wijtree")&&g._getField("nodes").length>0)b.options.showCheckBoxes&&b.options.allowTriState&&g._getField("nodes")[0]._setParentCheckState();if(d==="end"){c.show();f.add(c)}else if(d=="before"||d=="after"){var h=f._getField("owner"),m=h._getField("nodes"),i=a.inArray(f,m);if(i!=-1){c.show();if(d==="before")h.add(c,i);else d==="after"&&h.add(c,i+1)}}e._tree=b;for(var k=e._getField("nodes"),j=0;j<k.length;j++)k[j]._tree=b;b._trigger("nodeDroped",n,l)}}else c.draggable("option","revert",true)}},accept:"li",scope:"tree"})},_attachNodeEvent:function(){this.element.bind("click."+this.widgetName,a.proxy(this._onClick,this)).bind("mouseout."+this.widgetName,a.proxy(this._onMouseOut,this)).bind("keydown."+this.widgetName,a.proxy(this._onKeyDown,this))},_onClick:function(a){this._callEvent(a,"_onClick")},_onFocus:function(a){this._callEvent(a,"_onFocus")},_onKeyDown:function(a){this._callEvent(a,"_onKeyDown")},_onMouseOut:function(a){this._callEvent(a,"_onMouseOut")},_onMouseOver:function(a){this._callEvent(a,"_onMouseOver")},_callEvent:function(a,d){var c=a.target;if(c){var b=this._getNodeWidgetByDom(c);if(b==null)return;b[d](a)}},getSelectedNodes:function(){return this._selectedNodes},getCheckedNodes:function(){return this._checkedNodes},destroy:function(){var b=this;b.widgetDom.removeClass("ui-wijtree ui-widget ui-widget-content ui-helper-clearfix ui-corner-all");var c=b.element;b.widgetDom.data("droppable")&&b.widgetDom.droppable("destroy");c.removeData("nodes").removeClass("ui-wijtree-list ui-helper-reset");c.children("li").each(function(){var c=b._getNodeWidget(a(this));c&&c.destroy()});a.Widget.prototype.destroy.apply(this)},add:function(c,d){var b=null,g=this.options;if(typeof c==="string"){var i="<li><a>{0}</a></li>",e=a(i.replace(/\{0\}/,c));this._createNodeWidget(e,g);b=e.data(e.data("widgetName"))}else if(c.jquery){!c.data("widgetName")&&this._createNodeWidget(c,g);b=c.data(c.data("widgetName"))}else if(c.nodeType){e=a(c);this._createNodeWidget(e,g);b=e.data(e.data("widgetName"))}if(b==null)return;var f=this._getField("nodes");if(!d&&d>f.length)d=f.length;b._setField("owner",this);var h=f.length;f.splice(d,0,b);if(h>0&&h!=d)b.element.get(0)!=f[d+1].element.get(0)&&b.element.insertBefore(f[d+1].element);else this.element.append(b.element);this._refreshNodesClass()},remove:function(b){var a=-1;if(b.jquery)a=b.index();else if(typeof b=="number")a=b;var c=this._getField("nodes");if(a<0&&a>=c.length)return;var d=c[a];d.element.detach();c.splice(a,1);this._refreshNodesClass()},findNodeByText:function(c){var b=a(".ui-wijtree-node a>span",this.element).filter(function(){return a(this).text()==c});return b.length?this._getNodeWidgetByDom(b.get(0)):null},_setAllowDrag:function(c){var b;if(c){b=this.element.find(":ui-wijtreenode");b.each(function(){var b=a(this).data("wijtreenode");if(!a(this).data("draggable")&&!b.$navigateUrl.data("events").mousedown)b.$navigateUrl.one("mousedown",b,b._onMouseDown)})}else{b=this.element.find(":ui-wijtreenode:ui-draggable");b.draggable("destroy")}},_setAllowDrop:function(a){if(a)!this.widgetDom.data("droppable")&&this._attachDroppable();else this.widgetDom.droppable&&this.widgetDom.droppable("destroy")},_setCheckBoxes:function(c){var b=this;b.element.children("li").each(function(){var d=b._getNodeWidget(a(this));d!=null&&d._setCheckBoxes(c)})},_setHitArea:function(c){var b=this;b.element.children("li").each(function(){var d=b._getNodeWidget(a(this));d!=null&&d._setHitArea(c)})},_getNodeWidget:function(a){return a.is(":ui-wijtreenode")?a.data(a.data("widgetName")):null},_getNodeWidgetByDom:function(b){var a=this._getNodeByDom(b);return this._getNodeWidget(a)},_getNodeByDom:function(b){return a(b).closest(":ui-wijtreenode")},_refreshNodesClass:function(){for(var b=this._getField("nodes"),a=0;a<b.length;a++){var c=b[a];c._initNodeClass()}},_getField:function(a){return this.element.data(a)},_setField:function(b,a){return this.element.data(b,a)}})})(jQuery);(function(a){a.widget("ui.wijtreenode",{options:{accessKey:"",checked:false,collapsedIconClass:"",expanded:false,expandedIconClass:"",itemIconClass:"",navigateUrl:"",selected:false,text:"",toolTip:""},_setOption:function(d,b){var c=this;switch(d){case"accessKey":this.$navigateUrl!=null&&this.$navigateUrl.attr("accesskey",b);case"checked":this._checkState=b?"checked":"unChecked";c._setChecked(b);break;case"collapsedIconClass":case"expandedIconClass":case"itemIconClass":this.options[d]=b;c._initNodeImg();break;case"expanded":c._setExpanded(b);break;case"selected":c._setSelected(b);break;case"text":c._setText(b);break;case"toolTip":this._setToolTip(b);break;case"navigateUrl":this._setNavigateUrlHref(b)}a.Widget.prototype._setOption.apply(c,arguments)},_initState:function(){this._tree=null,this._dropTarget=null;this._checkState="unChecked";this._value=this._text=this._navigateUrl="";this._insertPosition="unKnown";this._hasPotentialNodes=false},_create:function(){this._initState();this._createTreeNode();this._initNode();this.element.data("widgetName","wijtreenode")},_createTreeNode:function(){var b=this.element,c=this,d=[];this.$navigateUrl=b.children("a");if(this._tree==null)this._tree=this._getTree();this.$nodeBody=null,this.$checkBox=null,this.$nodeImage=a("<span>"),this.$hitArea=null,this.$nodes=null,this.$nodeBody=a("<div>");if(this._tree.options.showCheckBoxes===true)this.$checkBox=a("<div>");if(this.$navigateUrl.length==0){this.$navigateUrl=a("<a>");this.$navigateUrl.attr("href","#")}this.$text=this.$navigateUrl.find("span:eq(0)");if(this.$text.length==0){this.$navigateUrl.wrapInner("<span></span>");this.$text=this.$navigateUrl.find("span:eq(0)")}this._hasChildren=this._getChildren();this.$inner=a("<span class='ui-helper-clearfix ui-wijtree-inner ui-corner-all'></span>");if(this._hasChildren){b.addClass("ui-wijtree-parent");this.$nodeBody.addClass("ui-wijtree-node ui-wijtree-header ui-state-default");this.$hitArea=a("<span>");this.$inner.append(this.$navigateUrl);if(this.$checkBox!=null){this.$inner.prepend(this.$checkBox);this.$checkBox.wijtreecheck()}this.$inner.prepend(this.$nodeImage).prepend(this.$hitArea);this.$nodes=b.find("ul:eq(0)");this.$nodes.addClass("ui-wijtree-list ui-helper-reset ui-wijtree-child");this.$nodes.children().filter("li").each(function(f){var b=a(this);b.data("owner",c);b.wijtreenode(c.options);var e=c._getNodeWidget(b);e._index=f;d.push(e)})}else{b.addClass("ui-wijtree-item");this.$nodeBody.addClass("ui-wijtree-node ui-state-default");this.$inner.append(this.$navigateUrl);if(this.$checkBox!=null){this.$inner.prepend(this.$checkBox);this.$checkBox.wijtreecheck()}this.$inner.prepend(this.$nodeImage)}this.$nodeBody.append(this.$inner);this._setField("nodes",d);b.prepend(this.$nodeBody)},_initNodeClass:function(){var b=this,d=b.options,c="ui-icon "+(d.expanded?"ui-icon-triangle-1-se":"ui-icon-triangle-1-e");if(b._tree.options.showExpandCollapse)if(b._hasChildren)if(b.$hitArea!=null)b.$hitArea.removeClass("ui-icon ui-icon-triangle-1-se ui-icon-triangle-1-e").addClass(c);else{b.$hitArea=a("<span>").addClass(c).prependTo(b.$inner);b.element.removeClass("ui-wijtree-node ui-state-default ui-corner-all").addClass("ui-wijtree-parent")}else if(b.$hitArea){b.$hitArea.remove();b.$hitArea=null;b.element.removeClass("ui-wijtree-parent").addClass("ui-wijtree-node ui-state-default ui-corner-all")}},_initNode:function(){if(!this._initialized){this._initialized=true;this._initNodeImg();this._initNavigateUrl();this._text=this.$text.html();this._hasChildren=this._getChildren();this._initNodesUL();this._initNodeClass();this.$navigateUrl.one("mousedown",this,this._onMouseDown)}},_initNodesUL:function(){var a=this;if(a._tree.options.showExpandCollapse)a._hasChildren&&a.$nodes[a._expanded?"show":"hide"]()},_initNavigateUrl:function(){var a=this;a.$navigateUrl.bind("blur."+a.widgetName,a,a._onBlur);var b=a.$navigateUrl.attr("href");a._navigateUrl=!!b?b:"";a._setNavigateUrlHref(b)},_initNodeImg:function(){var b=this,c=this.options;if(this.$nodeImage==null||!this.$nodeImage.length)this.$nodeImage=a("<span>");if(b.options.collapsedIconClass!=""&&b.options.expandedIconClass!=""){this.$nodeImage.removeClass().addClass("ui-icon");this.$nodeImage.addClass(b._expanded?c.expandedIconClass:c.collapsedIconClass);!b._tree.options.showExpandCollapse&&this.$nodeImage.addClass(b.options.expandedIconClass);this.$nodeImage.insertBefore(this.$checkBox)}else if(b.options.itemIconClass!=""){this.$nodeImage.removeClass().addClass("ui-icon");this.$nodeImage.addClass(b.options.itemIconClass);this.$nodeImage.insertBefore(this.$checkBox)}},_setNavigateUrlHref:function(a){if(this.$navigateUrl){if(a===""||typeof a=="undefined")a="#";this.$navigateUrl.attr("href",a)}},_editNode:function(){this._tree._editMode=true;this.$navigateUrl.hide();if(!this.$editArea)this.$editArea=a("<input>").wijtextboxdecorator();this.$editArea.val(this.$text.html());this.$editArea.insertBefore(this.$navigateUrl);this.$editArea.bind("blur",this,this._editionComplete);this.$editArea.focus()},_editionComplete:function(b){var a=b.data;a._tree._editMode=false;if(a.$editArea){var c=a.$editArea.val();a.$editArea.remove()}a.$navigateUrl.show();a.$editArea=null;a._changeText(c)},_changeText:function(a){if(this.$text!=null&&a!=""){this.$text.text(a);this._tree._trigger("nodeTextChanged",this)}},_expandCollapseItem:function(){if(!this._tree.options.disabled)this._hasChildren&&this._setExpanded(!this._expanded)},_expandNode:function(a){if(!this._tree.options.disabled)if(a)if(this.options.expandDelay>0){if(typeof this._expandTimer!="undefined")this._expandTimer=window.clearTimeout(this._expandTimer);this._expandTimer=window.setTimeout(this._expandNodeVisually,this.options.expandDelay)}else this._expandNodeVisually();else if(this.options.collapseDelay>0){this._collapseTimer=window.clearTimeout(this._collapseTimer);this._collapseTimer=window.setTimeout(this._collapseNodeVisually,this.options.collapseDelay)}else this._collapseNodeVisually()},_expandNodeVisually:function(){var b=this;if(b._tree.options.autoCollapse){var c=b.element.siblings(":ui-wijtreenode");a.each(c,function(d){var a=b._getNodeWidget(c[d]);a._expanded&&a._setExpanded(false)})}b.options.collapsedIconClass!=""&&b.options.expandedIconClass!=""&&b.$nodeImage.removeClass(b.options.collapsedIconClass).addClass(b.options.expandedIconClass);b._internalSetNodeClass(true);b._show()},_collapseNodeVisually:function(){var a=this;a.options.collapsedIconClass!=""&&a.options.expandedIconClass!=""&&a.$nodeImage.removeClass(a.options.expandedIconClass).addClass(a.options.collapsedIconClass);a._internalSetNodeClass(false);a._hide()},_internalSetNodeClass:function(a){this.$hitArea.removeClass("ui-icon ui-icon-triangle-1-se ui-icon-triangle-1-e").addClass("ui-icon "+(a?"ui-icon-triangle-1-se":"ui-icon-triangle-1-e"))},_show:function(){this._animation(true)},_hide:function(){this._animation(false)},_animation:function(d){var b=this,e=b.$nodes;if(e){var c=d?"expandAnimation":"collapseAnimation",f=d?"nodeExpanded":"nodeCollapsed";if(a.effects&&!!b._tree.options[c].duration)e[d?"show":"hide"](b._tree.options[c].effect,{},b._tree.options[c].duration,function(){b._tree._trigger(f,null,b)});else e[d?"show":"hide"](b._tree.options[c].duration,function(){b._tree._trigger(f,null,b)})}},_getBounds:function(a){var b=a.height(),e=a.width(),d=a.offset().top,c=a.offset().left;return{h:b,w:e,t:d,l:c}},_isMouseInsideRect:function(b,a){return b.x<a.l||b.x>=a.l+a.w?false:b.y<=a.t+1||b.y>=a.t+a.h?false:true},_getNodeByMouseOn:function(b){a("li").each(function(){var c=this._getBounds(a(this));if(a.ui.isOver(b.y,b.x,c.t,c.l,c.h,c.w))return a(this)});return null},_drowTemplate:function(b,e,d){var f=d.is(".ui-wijtree-node")?d:d.children(".ui-wijtree-node");e.width(f.width());var c="unKnown",a=this._getBounds(f);if(b.y>a.t&&b.y<a.t+a.h/2){e.offset({left:a.l,top:a.t});c="before"}else if(b.y>a.t+a.h/2&&b.y<a.t+a.h){e.offset({left:a.l,top:a.t+a.h});c="after"}return c},_beginDrag:function(d){var b=this,c=b.element;this._insertionTemplate=a("<div>").addClass("ui-wijtree-insertion ui-state-default").hide();c.draggable({cursor:"point",cursorAt:{top:15,left:-25},helper:function(){return a("<div class='ui-widget-header ui-corner-all'>"+b.$text.html()+"</div>")},start:function(a){b._tree._isDragging=true;b._tree._trigger("nodeDragStarted",a,b);b._tree.widgetDom.prepend(b._insertionTemplate);c.hide()},distance:a.browser.msie?1:10,handle:b.$navigateUrl,scope:"tree",drag:function(c){b._insertionTemplate&&b._insertionTemplate.hide();var g=c.srcElement||c.originalTarget,e=a(g);if(e){var d=b._getNodeWidget(e);if(d)if(e.closest(".ui-wijtree-inner",b.element).length){b._dropTarget=d;b._insertPosition="end"}else{var f={x:c.pageX,y:c.pageY};b._insertionTemplate.show();b._insertPosition=b._drowTemplate(f,b._insertionTemplate,d.element);b._dropTarget=d}}b._tree._trigger("nodeDragging",c,b)},stop:function(){c.show();b._insertionTemplate.remove();b._dropTarget=null;b._insertPosition="unKnown";b._tree._isDragging=false;b._resetDrag()}}).trigger(d);a.browser.mozilla&&b._setFocused(true)},_resetDrag:function(){var a=this;!a._tree.options.allowDrag&&a.element.data("draggable")&&a.element.draggable("destroy");for(var c=a._getField("nodes"),b=0;b<c.length;b++)c[b]._resetDrag()},_checkClick:function(){if(!this._tree.options.disabled)if(this._checked&&this._checkState==="indeterminate"){this._checkState="checked";this._checkItem()}else{var a=this._checked;this._checkState=a?"unChecked":"checked";this._setChecked(!a)}},_checkItem:function(){var b=this;if(this._tree==null||!this._tree.options.showCheckBoxes)return;var a=false;if(this._tree.options.autoCheckNodes&&b._checkState!="indeterminate"){a=true;this._changeCheckState(this._checked)}this._tree.options.allowTriState&&this._setParentCheckState();this._checked?this._checkNode(a):this._unCheckNode(a);this._tree._trigger("nodeCheckChanged",null,this)},_checkNode:function(c){if(this._checkState==="checked")this.$checkBox.wijtreecheck("option","checkState","check");else this._checkState=="indeterminate"&&this.$checkBox.wijtreecheck("option","checkState","triState");var b=this._getField("nodes");if(c)for(var a=0;a<b.length;a++)b[a]._checkNode(true)},_unCheckNode:function(c){this.$checkBox.wijtreecheck("option","checkState","unCheck");var b=this._getField("nodes");if(c)for(var a=0;a<b.length;a++)b[a]._unCheckNode(true)},_changeCheckState:function(a){for(var d=this._getField("nodes"),c=0;c<d.length;c++){var b=d[c];b._checked=a;b.options.checked=a;b._checkState=a?"checked":"unChecked";b._changeCheckState(a)}},_setParentCheckState:function(){var a=this._getOwner();if(a.element.is(":ui-wijtree"))return;for(var e=a._getField("nodes"),d=true,c=false,f=false,b=0;b<e.length;b++){if(e[b]._checkState=="indeterminate")f=true;e[b]._checked?(c=true):(d=false);if(!d&&c)break}if(f){a._checkState="indeterminate";a._setChecked(true)}else if(c){if(d){a._checkState="checked";a._checkNode(false)}else a._checkState="indeterminate";a._setChecked(true)}else{a._checkState="unChecked";a._setChecked(false);a._unCheckNode(false)}a._setParentCheckState()},_onKeyDown:function(b){var d=a(b.target),c=this;d.closest(".ui-wijtree-inner",c.element).length>0&&c._keyAction(b)},_onClick:function(b){var d=a(b.target),c=this;if(d.closest(".ui-checkbox",c.element).length>0){c._checkClick(b);b.preventDefault();b.stopPropagation()}else if(d.hasClass("ui-icon-triangle-1-se")||d.hasClass("ui-icon-triangle-1-e")){c._expandCollapseItem(b);b.preventDefault();b.stopPropagation()}else d.closest(".ui-wijtree-inner",c.element).length>0&&c._click(b)},_onMouseDown:function(b){var d=a(b.target),c=b.data;if(c._tree.options.allowDrag)d.closest(".ui-wijtree-node",c.element).length>0&&c._beginDrag(b)},_onMouseOver:function(c){var e=a(c.target),b=this,d=a(c.relatedTarget);if(e.closest(".ui-wijtree-inner",b.element).length>0&&(this._tree._overNode!=b||d.is(":ui-wijtreenode"))){b._mouseOver(c);this._tree._overNode=b}b._mouseOverHitArea(c)},_onMouseOut:function(b){var f=a(b.target),c=this,e=a(b.relatedTarget),d=this._getNodeWidget(e);if(f.closest(".ui-wijtree-inner",c.element).length>0&&(this._tree._overNode!=d||e.is(":ui-wijtreenode"))){c._mouseOut(b);if(!d)this._tree._overNode=null}c._mouseOutHitArea(b)},_onFocus:function(c){var d=a(c.target),b=this;if(d.closest("a",b.element).length>0&&!this._tree.options.disabled){b._tree._focusNode&&b._tree._focusNode.$navigateUrl.blur();b._focused=true;b._tree._focusNode=this;b.$inner.addClass("ui-state-focus")}},_onBlur:function(c){var d=a(c.target),b=c.data;if(!b._tree.options.disabled){b._focused=false;d.closest("a",b.element).length>0&&b.$inner.removeClass("ui-state-focus");b._tree._trigger("nodeBlur",c,b)}},_click:function(a){if(!this._tree.options.disabled){if(!/^[#,\s]*$/.test(this._navigateUrl))return;this._isClick=true;this._tree._ctrlKey=a.ctrlKey;if(this._selected&&this._tree._ctrlKey)this._setSelected(false);else if(this._selected&&this._tree.options.allowEdit)this._editNode();else this._setSelected(!this._selected);a.preventDefault();a.stopPropagation()}else this._setNavigateUrlHref("")},_selectNode:function(d,e){if(!this._tree.options.disabled&&!this._tree._isDragging){var f=this._tree._ctrlKey,b;if(f){b=a.inArray(this,this._tree._selectedNodes);if(b!=-1&&!d){this._tree._selectedNodes.splice(b,1);this.$inner.removeClass("ui-state-active")}}else{for(var c=0;c<this._tree._selectedNodes.length;c++){this._tree._selectedNodes[c].$inner.removeClass("ui-state-active");this._tree._selectedNodes[c].options.selected=false;this._tree._selectedNodes[c]._selected=false}this._tree._selectedNodes=[]}if(d){b=a.inArray(this,this._tree._selectedNodes);b==-1&&this._tree._selectedNodes.push(this);this.$inner.addClass("ui-state-active")}else this.$inner.removeClass("ui-state-active");this._isClick&&this._tree._trigger("nodeClick",e,this);this._tree._ctrlKey=false;this._tree._trigger("selectedNodeChanged",e,this)}},_keyAction:function(b){if(this._tree.options.disabled)return;var c=b.target;if(c){if(this._tree._editMode&&b.keyCode!=a.ui.keyCode.ENTER)return;switch(b.keyCode){case a.ui.keyCode.UP:this._moveUp();break;case a.ui.keyCode.DOWN:this._moveDown();break;case a.ui.keyCode.RIGHT:this._tree.options.showExpandCollapse&&this._moveRight();break;case a.ui.keyCode.LEFT:this._tree.options.showExpandCollapse&&this._moveLeft();break;case 83:!this._tree._editMode&&this._tree.options.allowSorting&&this.sortNodes();break;case 113:this._tree.options.allowEdit&&this._editNode();break;case 109:this._tree.options.showExpandCollapse&&this._expanded&&this._setExpanded(false);break;case 107:this._tree.options.showExpandCollapse&&!this._expanded&&this._setExpanded(true);break;case a.ui.keyCode.ENTER:if(this._tree._editMode){b.data=this;this._editionComplete(b)}break;case a.ui.keyCode.SPACE:if(this._tree.options.showCheckBoxes){this._checkState=this._checked?"unChecked":"checked";this._setChecked(!this._checked)}}b.preventDefault();b.stopPropagation()}},_prevNode:function(a){if(a.element.prev().length>0)return a.element.prev().data("wijtreenode")},_nextNode:function(a){if(a.element.next().length>0)return a.element.next().data("wijtreenode")},_getNextExpandedNode:function(b){var c=b,a=b._getField("nodes");if(b._expanded&&a.length>0){var d=a[a.length-1];if(d!=null)c=this._getNextExpandedNode(d)}return c},_getNextNode:function(b){var a=null;if(b.element.is(":ui-wijtree"))return null;a=this._nextNode(b);return a?a:this._getNextNode(b._getOwner())},_moveUp:function(){var b=this._getCurrentLevel(),a=this._prevNode(this);if(!a)b>0&&this._getOwner()._setFocused(true);else this._getNextExpandedNode(a)._setFocused(true)},_moveDown:function(){var c=this._getField("nodes");if(this._expanded&&c.length>0)c[0]._setFocused(true);else{var b=this._nextNode(this);if(b!=null)b._setFocused(true);else{var d=this._getOwner(),a=this._getNextNode(d);a!=null&&a._setFocused(true)}}},_moveLeft:function(){if(this._expanded)this._setExpanded(false);else if(this._getOwner()._getOwner()!=null){var a=this._getOwner();a._setFocused(true)}},_moveRight:function(){if(this._hasChildren)if(!this._expanded)this._setExpanded(true);else{var a=this._getField("nodes")[0];a!=null&&a._setFocused(true)}},_mouseOver:function(a){if(!this._tree.options.disabled&&!this._tree._editMode){this._mouseOverNode();!this._tree._isDragging&&this._tree._trigger("nodeMouseOver",a,this)}},_mouseOut:function(a){if(!this._tree.options.disabled&&!this._tree._editMode){this._mouseOutNode();!this._tree._isDragging&&this._tree._trigger("nodeMouseOut",a,this)}},_mouseOverNode:function(){if(this.$inner!=null&&!this._isOverNode){this.$inner.addClass("ui-state-hover");this._isOverNode=true}},_mouseOutNode:function(){if(this.$inner!=null&&this._isOverNode){this.$inner.removeClass("ui-state-hover");this._isOverNode=false}},_mouseOverHitArea:function(a){if(!this._tree.options.disabled)if(this._tree.options.expandCollapseHoverUsed)if(this._hasChildren&&!this._isOverHitArea){var b=this._getBounds(this.element),c={x:a.pageX,y:a.pageY};if(this._isMouseInsideRect(c,b)){this._isOverHitArea=true;this._setExpanded(true)}}},_mouseOutHitArea:function(b){if(!this._tree.options.disabled)if(this._tree.options.expandCollapseHoverUsed){var c={x:b.pageX,y:b.pageY},a;if(this._hasChildren&&!!this._isOverHitArea){a=this._getBounds(this.element);if(!this._isMouseInsideRect(c,a)){this._isOverHitArea=false;this._setExpanded(false)}}else if(this._getOwner().element.is(":ui-wijtreenode")){a=this._getBounds(this._getOwner().element);if(!this._isMouseInsideRect(c,a)){this._getOwner()._isOverHitArea=false;this._getOwner()._setExpanded(false)}}}},destroy:function(){var b=this;b.element.data("draggable")&&b.element.draggable("destroy");b.$hitArea&&b.$hitArea.remove();b.$checkBox&&b.$checkBox.remove();b.$nodeImage&&b.$nodeImage.remove();b.$navigateUrl.unwrap().unwrap().removeClass("ui-state-default ui-state-active").unbind("mousedown").unbind("blur");var c=this.element.find("ul:first").show();c.removeClass();c.children("li").each(function(){var c=b._getNodeWidget(a(this));c.destroy()});b.element.removeData("nodes").removeData("owner").removeData("widgetName").removeClass();a.Widget.prototype.destroy.apply(this)},add:function(c,d){var b=null;if(typeof c=="string"){var h="<li><a>{0}</a></li>",e=a(h.replace(/\{0\}/,c));this._createNodeWidget(e);b=e.data(e.data("widgetName"))}else if(c.jquery){!c.data("widgetName")&&this._createNodeWidget(c);b=c.data(c.data("widgetName"))}else if(c.nodeType){e=a(c);this._createNodeWidget(e);b=e.data(e.data("widgetName"))}if(b==null)return;var f=this._getField("nodes");if(!d||d>f.length)if(d!=0)d=f.length;b._setField("owner",this);var g=f.length;if(!this.$nodes){this.$nodes=a("<ul class='ui-wijtree-list ui-helper-reset ui-wijtree-child'></ul>");this.element.append(this.$nodes)}if(g>0&&g!=d)b.element.get(0)!=f[d].element.get(0)&&b.element.insertBefore(f[d].element);else this.$nodes.append(b.element);f.splice(d,0,b);this._collectionChanged("add")},remove:function(b){var a=-1;if(b.jquery)a=b.index();else if(typeof b=="number")a=b;var c=this._getField("nodes");if(a<0&&a>=c.length)return;var d=c[a];d.element.detach();c.splice(a,1);this._collectionChanged("remove")},sortNodes:function(){this._sort();for(var c=this._getField("nodes"),a=0;a<c.length;a++){var b=c[a];b._index=a;b._insertBefore(a)}this._refreshNodesClass()},check:function(a){this._setOption("checked",a)},select:function(a){this._setOption("selected",a)},expand:function(){this._setOption("expanded",true)},collapse:function(){this._setOption("expanded",false)},_insertBefore:function(a){var b=this.element.parent().children("li");this.element.index()!=a&&this.element.insertBefore(b.eq(a))},_sort:function(){var a=this._getField("nodes");if(this._isSorted)if(!this._isDecsSort){a.sort(this._compare2NodeTextAcs);this._isDecsSort=true}else{a.sort(this._compare2NodeTextDesc);this._isDecsSort=false}else{a.sort(this._compare2NodeTextAcs);this._isSorted=true;this._isDecsSort=true}},_compare2NodeTextAcs:function(a,b){if(a!=null&&b!=null)return a._text.localeCompare(b._text)},_compare2NodeTextDesc:function(a,b){if(a!=null&&b!=null)return-1*a._text.localeCompare(b._text)},_collectionChanged:function(){this._hasChildren=this._getChildren();this._initNodeClass();this._refreshNodesClass()},_refreshNodesClass:function(){for(var b=this._getField("nodes"),a=0;a<b.length;a++){var c=b[a];c._initNodeClass()}},_setChecked:function(b){var a=this;if(a._checked==b&&a._checkState!="indeterminate")return;a._checked=b;a.options.checked=b;this._checkItem()},_setExpanded:function(a){var b=this;if(b._expanded==a)return;if(b._hasChildren){b._expanded=a;b.options.expanded=a;this._expandNode(a)}},_setFocused:function(a){if(a)this.$navigateUrl.focus();else this.$navigateUrl.blur()},_setToolTip:function(a){if(a.length)this.element.attr("title",a);else this.element.removeAttr("title")},_setText:function(a){if(this._text!=a&&a.length){this._text=a;this._changeText(a)}},_setSelected:function(a){if(this.options.selected!=a){this._selected=a;this.options.selected=a;this._selectNode(a)}},_setCheckBoxes:function(c){var b=this;b.$checkBox&&b.$checkBox[c?"show":"hide"]();b.$nodes&&b.$nodes.children("li").each(function(){var d=b._getNodeWidget(a(this));d!=null&&d._setCheckBoxes(c)})},_setHitArea:function(c){var b=this;if(this._hasChildren)if(c){this._initNodeClass();this.$hitArea&&this.$hitArea.show()}else{this._expanded=true;this.options.expanded=true;this.$nodes&&this.$nodes.show();this._initNodeClass();this.$hitArea&&this.$hitArea.hide()}b.$nodes&&b.$nodes.children("li").each(function(){var d=b._getNodeWidget(a(this));d!=null&&d._setHitArea(c)})},_getOwner:function(){return this._getField("owner")},_getTree:function(){var a=this._getOwner();return a?a.element.is(":ui-wijtree")?a:a._getTree():null},_getChildren:function(){return this.element.children("ul:first").children("li").length>0&&this.element.children("ul:first")},_getNodeWidget:function(c){var a=this._getNodeByDom(c);return a.length>0?a.data(a.data("widgetName")):null},_createNodeWidget:function(b,c){if(a.fn.wijtreenode){b.data("owner",this);b.wijtreenode(c)}return b},_getNodeByDom:function(b){return a(b).closest(":ui-wijtreenode")},_getCurrentLevel:function(){return this.element.parentsUntil(":ui-wijtree").length-1},_getField:function(a){return this.element.data(a)},_setField:function(b,a){return this.element.data(b,a)}})})(jQuery);(function(a){var c="ui-icon ui-icon-check",b="ui-icon ui-icon-stop";a.widget("ui.wijtreecheck",{options:{checkState:"unCheck"},_create:function(){var b=this,c=this.options;if(b.element.is("div")){b.element.addClass("ui-checkbox ui-widget");b.$icon=a("<span>");b.$icon.addClass("ui-checkbox-icon");if(c.checkState=="check")b.$icon.addClass("ui-icon ui-icon-check");else c.checkState=="triState"&&b.$icon.addClass("ui-icon ui-icon-stop");b.$body=a('<div class="ui-checkbox-box ui-widget ui-corner-all ui-state-default"></div>').css({position:"relative"}).append(b.$icon);b.element.append(b.$body);b.element.bind("mouseover.wijtreecheck",function(){!b.options.disabled&&b.$body.removeClass("ui-state-default").addClass("ui-state-hover")}).bind("mouseout.wijtreecheck",function(){!b.options.disabled&&b.$body.removeClass("ui-state-hover").not(".ui-state-focus").addClass("ui-state-default")})}},_setOption:function(e,a){var d=this;if(e=="checkState")if(a=="unCheck")d.$icon.removeClass("ui-icon ui-icon-check ui-icon-stop");else if(a=="check")d.$icon.removeClass(b).addClass(c);else a=="triState"&&d.$icon.removeClass(c).addClass(b)},destory:function(){this.element.children().remove();this.element.removeClass("ui-checkbox ui-widget");a.Widget.prototype.destroy.apply(this)}})})(jQuery);
(function(a){a.widget("ui.wijwizard",{options:{navButtons:"auto",autoPlay:false,delay:3e3,loop:false,hideOption:{fade:true},showOption:{fade:true,duration:400},ajaxOptions:null,cache:false,cookie:null,load:null,stepHeaderTemplate:'<li><h1>"#{title}"</h1>"#{desc}"</li>',panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>",add:null,remove:null,show:null,validating:null},_create:function(){this._pageLize(true)},_init:function(){var a=this.options;a.autoPlay&&this.play()},_setOption:function(c,b){a.Widget.prototype._setOption.apply(this,arguments);switch(c){case"activeIndex":this.show(b);break;default:this._pageLize()}},play:function(){var b=this.options,a=this;if(!this.element.data("intId.wijwizard")){var c=window.setInterval(function(){var c=b.activeIndex+1;if(c>=a.panels.length)if(b.loop)c=0;else{a.stop();return}a.show(c)},b.delay);this.element.data("intId.wijwizard",c)}},stop:function(){var a=this.element.data("intId.wijwizard");if(a){window.clearInterval(a);this.element.removeData("intId.wijwizard")}},_normalizeBlindOption:function(a){if(a.blind===undefined)a.blind=false;if(a.fade===undefined)a.fade=false;if(a.duration===undefined)a.duration=200;if(typeof a.duration=="string")try{a.duration=parseInt(a.duration)}catch(b){a.duration=200}},_createButtons:function(){var d=this,f=this.options;if(f.navButtons==="none"){this._removeButtons();return}if(!this.buttons){var e=f.navButtons;if(e==="auto")e=this.list?"common":"edge";this.buttons=a("<div/>");this.buttons.addClass("ui-wijwizard-buttons");var c=function(b,a){a.is(":not(.ui-state-disabled)")&&a.addClass("ui-state-"+b)},b=function(a,b){b.removeClass("ui-state-"+a)};if(e==="common"){this.backBtn=a("<a href='#'><span class='ui-button-text'>back</span></a>").addClass("ui-widget ui-button ui-button-text-only ui-state-default ui-corner-all").appendTo(this.buttons).bind({click:function(){d.back()},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}});this.nextBtn=a("<a href='#'><span class='ui-button-text'>next</span></a>").addClass("ui-widget ui-button ui-button-text-only ui-state-default ui-corner-all").appendTo(this.buttons).bind({click:function(){d.next()},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}})}else{this.backBtn=a("<a href='#'/>").addClass("ui-wijwizard-prev ui-state-default ui-corner-right").append("<span class='ui-icon ui-icon-triangle-1-w'></span>").appendTo(this.buttons).bind({click:function(){d.back()},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}});this.nextBtn=a("<a href='#'/>").addClass("ui-wijwizard-next ui-state-default ui-corner-left").append("<span class='ui-icon ui-icon-triangle-1-e'></span>").appendTo(this.buttons).bind({click:function(){d.next()},mouseover:function(){c("hover",a(this))},mouseout:function(){b("hover",a(this))},mousedown:function(){c("active",a(this))},mouseup:function(){b("active",a(this))}})}this.buttons.appendTo(this.element)}},_removeButtons:function(){if(this.buttons){this.buttons.remove();this.buttons=undefined}},_pageLize:function(d){var e=this,b=this.options;if(d){this.list=this.element.find("ol,ul").eq(0);if(this.list&&this.list.length==0)this.list=null;if(this.list)this.lis=a("li",this.list);this.panels=a("> div",this.element);var c=/^#.+/;this.panels.each(function(e,d){var b=a(d).attr("url");b&&!c.test(b)&&a.data(d,"load.wijwizard",b.replace(/#.*$/,""))});this.element.addClass("ui-wijwizard ui-widget ui-helper-clearfix");if(this.list){this.list.addClass("ui-widget ui-helper-reset ui-wijwizard-steps ui-helper-clearfix");this.lis.addClass("ui-widget-header ui-corner-all")}this.container=a("<div/>");this.container.addClass("ui-wijwizard-content ui-widget ui-widget-content ui-corner-all");this.container.append(this.panels);this.container.appendTo(this.element);this.panels.addClass("ui-wijwizard-panel ui-widget-content");if(b.activeIndex===undefined){if(typeof b.activeIndex!="number"&&b.cookie)b.activeIndex=parseInt(e._cookie(),10);if(typeof b.activeIndex!="number"&&this.panels.filter(".ui-wijwizard-actived").length)b.activeIndex=this.panels.index(this.panels.filter(".ui-wijwizard-actived"));b.activeIndex=b.activeIndex||(this.panels.length?0:-1)}else if(b.activeIndex===null)b.activeIndex=-1;b.activeIndex=b.activeIndex>=0&&this.panels[b.activeIndex]||b.activeIndex<0?b.activeIndex:0;this.panels.addClass("ui-wijwizard-hide");if(b.activeIndex>=0&&this.panels.length){this.panels.eq(b.activeIndex).removeClass("ui-wijwizard-hide").addClass("ui-wijwizard-actived");this.load(b.activeIndex)}this._createButtons()}else b.activeIndex=this.panels.index(this.panels.filter(".ui-wijwizard-actived"));this._refreshStep();this._initScroller();b.cookie&&this._cookie(b.activeIndex,b.cookie);b.cache===false&&this.panels.removeData("cache.wijwizard");if(b.showOption===undefined||b.showOption===null)b.showOption={};this._normalizeBlindOption(b.showOption);if(b.hideOption===undefined||b.hideOption===null)b.hideOption={};this._normalizeBlindOption(b.hideOption);this.panels.unbind(".wijwizard")},_initScroller:function(){if(!this.lis)return;var b=0;this.lis.each(function(){b+=a(this).outerWidth(true)});if(this.element.innerWidth()<b){if(this.scrollWrap==undefined){this.list.wrap("<div class='scrollWrap'></div>");this.scrollWrap=this.list.parent();a.effects.save(this.list,["width","height","overflow"])}this.list.width(b+8);this.scrollWrap.height(this.list.outerHeight(true));this.scrollWrap.wijsuperpanel({allowResize:false,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollBarVisibility:"hidden"}})}else this._removeScroller()},_removeScroller:function(){if(this.scrollWrap){this.scrollWrap.wijsuperpanel("destroy").replaceWith(this.scrollWrap.contents());this.scrollWrap=undefined;a.effects.restore(this.list,["width","height","overflow"])}},_refreshStep:function(){var a=this.options;if(this.lis){this.lis.removeClass("ui-priority-primary").addClass("ui-priority-secondary");if(a.activeIndex>=0&&a.activeIndex<=this.lis.length-1){this.lis&&this.lis.eq(a.activeIndex).removeClass("ui-priority-secondary").addClass("ui-priority-primary");this.scrollWrap&&this.scrollWrap.wijsuperpanel("scrollChildIntoView",this.lis.eq(a.activeIndex))}}if(this.buttons&&!a.loop){this.backBtn[a.activeIndex==0?"addClass":"removeClass"]("ui-state-disabled");this.nextBtn[a.activeIndex>=this.panels.length-1?"addClass":"removeClass"]("ui-state-disabled")}},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var b=this.cookie||(this.cookie=this.options.cookie.name);return a.cookie.apply(null,[b].concat(a.makeArray(arguments)))},_ui:function(a){return{panel:a,index:this.panels.index(a)}},_removeSpinner:function(){this.element.removeClass("ui-state-processing");var a=this.element.data("spinner.wijwizard");if(a){this.element.removeData("spinner.wijwizard");a.remove()}},_resetStyle:function(b){b.css({display:""});!a.support.opacity&&b[0].style.removeAttribute("filter")},destroy:function(){var b=this.options;this.abort();this.stop();this._removeScroller();this._removeButtons();this.element.unbind(".wijwizard").removeClass(["ui-wijwizard","ui-widget","ui-helper-clearfix"].join(" ")).removeData("wijwizard");this.list&&this.list.removeClass("ui-widget ui-helper-reset ui-wijwizard-steps ui-helper-clearfix");if(this.lis){this.lis.removeClass("ui-widget-header ui-corner-all ui-priority-primary ui-priority-secondary");this.lis.each(function(){a.data(this,"destroy.wijwizard")&&a(this).remove()})}this.panels.each(function(){var b=a(this).unbind(".wijwizard");a.each(["load","cache"],function(c,a){b.removeData(a+".wijwizard")});if(a.data(this,"destroy.wijwizard"))a(this).remove();else a(this).removeClass(["ui-state-default","ui-wijwizard-actived","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-wijwizard-panel","ui-widget-content","ui-wijwizard-hide"].join(" ")).css({position:"",left:"",top:""})});this.container.replaceWith(this.container.contents());b.cookie&&this._cookie(null,b.cookie);return this},add:function(b,e,h){if(b===undefined)b=this.panels.length;if(e==undefined)e="Step "+b;var f=this,g=this.options,c=a(g.panelTemplate).data("destroy.wijwizard",true);c.addClass("ui-wijwizard-panel ui-widget-content ui-corner-all ui-wijwizard-hide");if(b>=this.panels.length)if(this.panels.length>0)c.insertAfter(this.panels[this.panels.length-1]);else c.appendTo(this.list[0].parentNode);else c.insertBefore(this.panels[b]);if(this.list&&this.lis){var d=a(g.stepHeaderTemplate.replace(/#\{title\}/g,e).replace(/#\{desc\}/g,h));d.addClass("ui-widget-header ui-corner-all").data("destroy.wijwizard",true);if(b>=this.lis.length)d.appendTo(this.list);else d.insertBefore(this.lis[b])}this._pageLize();if(this.panels.length==1){g.activeIndex=0;d.addClass("ui-priority-primary");c.removeClass("ui-wijwizard-hide");this.element.queue("wijwizard",function(){f._trigger("show",null,f._ui(f.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.panels[b]));return this},remove:function(a){var b=this.panels.eq(a).remove();this.lis&&this.lis.eq(a).remove();b.hasClass("ui-wijwizard-actived")&&this.panels.length>1&&this.show(a+(a+1<this.panels.length?1:-1));this._pageLize();this._trigger("remove",null,this._ui(b[0]));return this},_showPanel:function(f){var e=this,b=this.options,c=a(f);c.addClass("ui-wijwizard-actived");if((b.showOption.blind||b.showOption.fade)&&b.showOption.duration>0){var d={duration:b.showOption.duration};if(b.showOption.blind)d.height="toggle";if(b.showOption.fade)d.opacity="toggle";c.hide().removeClass("ui-wijwizard-hide").animate(d,b.showOption.duration||"normal",function(){e._resetStyle(c);e._trigger("show",null,e._ui(c[0]))})}else{c.removeClass("ui-wijwizard-hide");this._trigger("show",null,this._ui(c[0]))}},_hidePanel:function(f){var e=this,b=this.options,c=a(f);c.removeClass("ui-wijwizard-actived");if((b.hideOption.blind||b.hideOption.fade)&&b.hideOption.duration>0){var d={duration:b.hideOption.duration};if(b.hideOption.blind)d.height="toggle";if(b.hideOption.fade)d.opacity="toggle";c.animate(d,b.hideOption.duration||"normal",function(){c.addClass("ui-wijwizard-hide");e._resetStyle(c);e.element.dequeue("wijwizard")})}else{c.addClass("ui-wijwizard-hide");this.element.dequeue("wijwizard")}},show:function(b){if(b<0||b>=this.panels.length)return this;if(this.element.queue("wijwizard").length>0)return this;var g=this,c=this.options,d=a.extend({},this._ui(this.panels[c.activeIndex]));d.nextIndex=b;d.nextPanel=this.panels[b];this._trigger("validating",d);if(d.cancel)return this;var e=this.panels.filter(":not(.ui-wijwizard-hide)"),f=this.panels.eq(b);c.activeIndex=b;this.abort();c.cookie&&this._cookie(c.activeIndex,c.cookie);this._refreshStep();if(f.length){e.length&&this.element.queue("wijwizard",function(){g._hidePanel(e)});this.element.queue("wijwizard",function(){g._showPanel(f)});this.load(b)}else throw"jQuery UI wijwizard: Mismatching fragment identifier.";return this},next:function(){var b=this.options,a=b.activeIndex+1;if(b.loop)a=a%this.panels.length;if(a<this.panels.length){this.show(a);return true}return false},back:function(){var b=this.options,a=b.activeIndex-1;if(b.loop)a=a<0?this.panels.length-1:a;if(a>=0){this.show(a);return true}return false},load:function(f){var b=this,d=this.options,e=this.panels.eq(f)[0],g=a.data(e,"load.wijwizard");this.abort();if(!g||this.element.queue("wijwizard").length!==0&&a.data(e,"cache.wijwizard")){this.element.dequeue("wijwizard");return}this.element.addClass("ui-state-processing");if(d.spinner){var c=this.element.data("spinner.winwizard");if(!c){c=a("<div/>");c.addClass("ui-wijwizard-spinner");c.html(d.spinner);c.appendTo(document.body);this.element.data("spinner.winwizard",c);c.wijpopup({showEffect:"blind",hideEffect:"blind"})}c.wijpopup("show",{of:this.element,my:"center center",at:"center center"})}this.xhr=a.ajax(a.extend({},d.ajaxOptions,{url:g,success:function(c,g){a(e).html(c);b._removeSpinner();d.cache&&a.data(e,"cache.wijwizard",true);b._trigger("load",null,b._ui(b.panels[f]));try{d.ajaxOptions.success(c,g)}catch(h){}},error:function(a,c){b._removeSpinner();b._trigger("load",null,b._ui(b.panels[f]));try{d.ajaxOptions.error(a,c,f,e)}catch(g){}}}));b.element.dequeue("wijwizard");return this},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("wijwizard",this.element.queue("wijwizard").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._removeSpinner();return this},url:function(a,b){this.panels.eq(a).removeData("cache.wijwizard").data("load.wijwizard",b);return this},count:function(){return this.panels.length}})})(jQuery);
